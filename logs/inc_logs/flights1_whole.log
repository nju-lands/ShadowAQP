main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-06-26 10:47:29,501 - main.py[line:438] - INFO: load query config config/query/flights-inc.json successfully
2022-06-26 10:47:29,501 - main.py[line:445] - INFO: load train config ./config/train/flights_a_inc_torch_cvae.json successfully
2022-06-26 10:47:29,501 - main.py[line:445] - INFO: load train config ./config/train/flights_b_torch_cvae.json successfully
2022-06-26 10:47:29,501 - dataset_utils.py[line:543] - INFO: load existing dataset:flights-flight-a-inc_a_unique_carrier_a_taxi_out#a_air_time#a_distance_a_unique_carrier_binary_gaussian5_0
2022-06-26 10:47:32,016 - dataset_utils.py[line:197] - INFO: encode incremental data categorical columns time elapsed:0.008358404040336609
2022-06-26 10:47:37,631 - dataset_utils.py[line:214] - INFO: encode incremental data numeric columnstime elapsed:5.614820420742035
2022-06-26 10:47:37,750 - dataset_utils.py[line:262] - INFO: load incremental data time elapsed:5.806909613311291
2022-06-26 10:47:37,751 - dataset_utils.py[line:555] - INFO: load dataset time elapsed:8.249848324805498
2022-06-26 10:47:37,751 - pytorch_cvae.py[line:295] - INFO: feature info:[('a_taxi_out', 'numerical', 6), ('a_air_time', 'numerical', 6), ('a_distance', 'numerical', 6), ('a_unique_carrier', 'categorical', 6)]
2022-06-26 10:47:37,752 - model_utils.py[line:75] - INFO: load model name:torch_cvae_flights-flight-a-inc_a_unique_carrier_ld50_id100_bs512_ep100_0_binary_gaussian5
2022-06-26 10:47:37,754 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.002050742506980896
2022-06-26 10:47:37,755 - pytorch_cvae.py[line:306] - INFO: load model time elapsed:8.253288645297289
2022-06-26 10:47:45,197 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.1 epoch----------------------------
2022-06-26 10:47:45,197 - pytorch_cvae.py[line:176] - INFO: loss:120.95065649598837, numeric_loss:59.20202799886465, categorical_loss:20.363372948020697, kld_loss:7677.645484209061, epoch_train_time:7.441507842391729
2022-06-26 10:47:52,104 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.2 epoch----------------------------
2022-06-26 10:47:52,104 - pytorch_cvae.py[line:176] - INFO: loss:65.74326745420694, numeric_loss:13.774176182225347, categorical_loss:3.5022036279551685, kld_loss:8139.828695297241, epoch_train_time:6.907105978578329
2022-06-26 10:47:59,201 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.3 epoch----------------------------
2022-06-26 10:47:59,201 - pytorch_cvae.py[line:176] - INFO: loss:66.87727173417807, numeric_loss:12.503711629658937, categorical_loss:3.147337621310726, kld_loss:7796.226402282715, epoch_train_time:7.096848092973232
2022-06-26 10:48:06,110 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.4 epoch----------------------------
2022-06-26 10:48:06,110 - pytorch_cvae.py[line:176] - INFO: loss:70.08794251084328, numeric_loss:12.346479001455009, categorical_loss:3.052895923377946, kld_loss:7549.96523475647, epoch_train_time:6.9083009995520115
2022-06-26 10:48:13,085 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.5 epoch----------------------------
2022-06-26 10:48:13,085 - pytorch_cvae.py[line:176] - INFO: loss:74.33875848352909, numeric_loss:12.481311675161123, categorical_loss:3.094961845432408, kld_loss:7366.1259479522705, epoch_train_time:6.974916230887175
2022-06-26 10:48:19,945 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.6 epoch----------------------------
2022-06-26 10:48:19,945 - pytorch_cvae.py[line:176] - INFO: loss:79.44059550017118, numeric_loss:12.914334764704108, categorical_loss:3.300848007085733, kld_loss:7203.698499679565, epoch_train_time:6.859727036207914
2022-06-26 10:48:26,899 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.7 epoch----------------------------
2022-06-26 10:48:26,899 - pytorch_cvae.py[line:176] - INFO: loss:84.62979853898287, numeric_loss:13.450788569636643, categorical_loss:3.31556091690436, kld_loss:7034.91685962677, epoch_train_time:6.95435306802392
2022-06-26 10:48:33,835 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.8 epoch----------------------------
2022-06-26 10:48:33,835 - pytorch_cvae.py[line:176] - INFO: loss:90.41305544227362, numeric_loss:14.117174565792084, categorical_loss:3.531688678485807, kld_loss:6869.643778800964, epoch_train_time:6.935136798769236
2022-06-26 10:48:40,779 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.9 epoch----------------------------
2022-06-26 10:48:40,779 - pytorch_cvae.py[line:176] - INFO: loss:97.14078588038683, numeric_loss:14.83288741670549, categorical_loss:3.8529746464337222, kld_loss:6752.498284339905, epoch_train_time:6.943743087351322
2022-06-26 10:48:47,683 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.10 epoch----------------------------
2022-06-26 10:48:47,683 - pytorch_cvae.py[line:176] - INFO: loss:103.69785612821579, numeric_loss:15.663203235715628, categorical_loss:4.115919490810484, kld_loss:6591.211414337158, epoch_train_time:6.903857287019491
2022-06-26 10:48:54,519 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.11 epoch----------------------------
2022-06-26 10:48:54,520 - pytorch_cvae.py[line:176] - INFO: loss:111.13883973658085, numeric_loss:16.662412406876683, categorical_loss:4.38672131288331, kld_loss:6463.649976730347, epoch_train_time:6.836516663432121
2022-06-26 10:49:01,551 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.12 epoch----------------------------
2022-06-26 10:49:01,552 - pytorch_cvae.py[line:176] - INFO: loss:119.2155247181654, numeric_loss:17.766938105225563, categorical_loss:4.67606548324693, kld_loss:6348.708169937134, epoch_train_time:7.031893227249384
2022-06-26 10:49:08,540 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.13 epoch----------------------------
2022-06-26 10:49:08,540 - pytorch_cvae.py[line:176] - INFO: loss:127.84951815009117, numeric_loss:18.91570445150137, categorical_loss:4.990867289132439, kld_loss:6241.5618352890015, epoch_train_time:6.987830303609371
2022-06-26 10:49:15,618 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.14 epoch----------------------------
2022-06-26 10:49:15,618 - pytorch_cvae.py[line:176] - INFO: loss:137.2667923271656, numeric_loss:20.33254747837782, categorical_loss:5.590047997771762, kld_loss:6125.831896781921, epoch_train_time:7.078538849949837
2022-06-26 10:49:22,518 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.15 epoch----------------------------
2022-06-26 10:49:22,518 - pytorch_cvae.py[line:176] - INFO: loss:146.51815508306026, numeric_loss:21.746553314849734, categorical_loss:5.873090593959205, kld_loss:5999.394740104675, epoch_train_time:6.89901876449585
2022-06-26 10:49:29,561 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.16 epoch----------------------------
2022-06-26 10:49:29,561 - pytorch_cvae.py[line:176] - INFO: loss:156.75984106957912, numeric_loss:23.338426392525434, categorical_loss:6.372046803124249, kld_loss:5885.337194919586, epoch_train_time:7.0433517917990685
2022-06-26 10:49:36,432 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.17 epoch----------------------------
2022-06-26 10:49:36,432 - pytorch_cvae.py[line:176] - INFO: loss:167.81281995773315, numeric_loss:25.023072684183717, categorical_loss:6.880723490612581, kld_loss:5785.611316680908, epoch_train_time:6.870229654014111
2022-06-26 10:49:43,340 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.18 epoch----------------------------
2022-06-26 10:49:43,340 - pytorch_cvae.py[line:176] - INFO: loss:179.23592968285084, numeric_loss:26.70433636382222, categorical_loss:7.583220844506286, kld_loss:5676.108703613281, epoch_train_time:6.907951984554529
2022-06-26 10:49:50,219 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.19 epoch----------------------------
2022-06-26 10:49:50,219 - pytorch_cvae.py[line:176] - INFO: loss:191.17830845713615, numeric_loss:28.62414213642478, categorical_loss:8.299951328430325, kld_loss:5562.180646419525, epoch_train_time:6.879011061042547
2022-06-26 10:49:57,166 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.20 epoch----------------------------
2022-06-26 10:49:57,166 - pytorch_cvae.py[line:176] - INFO: loss:204.16867190599442, numeric_loss:30.66261786222458, categorical_loss:9.001628546277061, kld_loss:5467.523241043091, epoch_train_time:6.946285154670477
2022-06-26 10:49:57,166 - pytorch_cvae.py[line:185] - INFO: training time elapsed:139.41118339821696
2022-06-26 10:49:57,167 - model_utils.py[line:67] - INFO: save model successfully
2022-06-26 10:49:59,288 - dataset_utils.py[line:562] - INFO: load existing dataset(light):flights-flight-b_b_unique_carrier__b_unique_carrier_binary_gaussian5_0
2022-06-26 10:49:59,309 - dataset_utils.py[line:571] - INFO: load dataset(light) time elapsed:0.020575109869241714
2022-06-26 10:49:59,309 - pytorch_cvae.py[line:275] - INFO: feature info:[('b_unique_carrier', 'categorical', 6)]
2022-06-26 10:49:59,309 - model_utils.py[line:75] - INFO: load model name:torch_cvae_flights-flight-b_b_unique_carrier_ld50_id100_bs512_ep100_0_binary_gaussian5
2022-06-26 10:49:59,311 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0016056038439273834
2022-06-26 10:49:59,311 - pytorch_cvae.py[line:285] - INFO: load model time elapsed:0.023042339831590652
2022-06-26 10:49:59,311 - main.py[line:382] - INFO: multi_sampling No.0 epoch
2022-06-26 10:49:59,394 - pytorch_cvae.py[line:398] - INFO: sampling time:0.08276035636663437
2022-06-26 10:49:59,461 - pytorch_cvae.py[line:418] - INFO: house sampling rate:0.05
2022-06-26 10:49:59,511 - pytorch_cvae.py[line:398] - INFO: sampling time:0.04963572323322296
2022-06-26 10:50:01,039 - main.py[line:366] - INFO: sample and aggregation time elapsed:1.727996189147234
2022-06-26 10:50:01,043 - main.py[line:399] - INFO: sample time:1.73197665438056
2022-06-26 10:50:01,061 - main.py[line:99] - INFO: aqp result:
                  avg(a_taxi_out)  avg(a_air_time)  avg(a_distance)  \
a_unique_carrier                                                      
9E               15.70            1207.77          778.16             
AA               16.17            1206.65          778.18             
AQ               15.61            1211.35          783.16             
AS               14.92            1207.46          759.61             
B6               15.46            1213.21          809.91             
CO               14.90            1213.43          808.39             
DH               15.39            1208.92          803.05             
DL               15.11            1208.66          790.74             
EV               15.67            1210.39          787.80             
F9               15.07            1212.20          814.84             
FL               14.79            1207.53          768.34             
HA               15.03            1211.93          811.09             
HP               15.79            1207.30          767.77             
MQ               15.16            1205.35          740.67             
NK               15.38            1206.12          779.53             
NW               14.96            1207.89          765.53             
OH (1)           15.46            1207.68          780.29             
OO               15.55            1201.71          745.93             
TW               15.30            1210.64          804.54             
TZ               15.30            1211.18          797.96             
UA               15.61            1209.07          770.79             
US               14.85            1207.25          773.38             
VX               15.31            1209.99          770.59             
WN               14.78            1209.11          775.93             
XE               14.88            1205.29          765.70             
YV               15.84            1207.09          766.63             

                  sum(a_taxi_out)  sum(a_air_time)  sum(a_distance)  
a_unique_carrier                                                     
9E               189416922.78     14576007691.68   9391286201.94     
AA               22028774369.87   1643507426727.47 1059908151956.80  
AQ               2332136.06       180971086.92     117000617.77      
AS               1109027928.25    89765451013.66   56471350167.78    
B6               715697466.00     56160273611.52   37491286256.24    
CO               3092147017.20    251886234043.17  167808191883.69   
DH               47083591.53      3698074467.68    2456532840.52     
DL               26246479711.57   2099587890534.97 1373603994799.56  
EV               3388846328.14    261829914305.58  170415216873.50   
F9               104483627.23     8406038366.17    5650545785.22     
FL               614941708.74     50208234193.66   31946798690.73    
HA               74404023.71      5997621475.59    4013954035.55     
HP               504421301.00     38575994808.11   24531809480.30    
MQ               4480089177.12    356319841047.69  218952839063.57   
NK               7284724.34       571106458.79     369111935.73      
NW               4876047492.15    393581067480.90  249441067715.39   
OH (1)           310543144.77     24256459670.33   15672377155.27    
OO               6335230481.11    489479327128.60  303831056843.96   
TW               339977565.93     26897428302.76   17874958054.80    
TZ               4480469.81       354763233.56     233728576.44      
UA               15314496466.91   1186524802945.89 756412180122.38   
US               11361277248.28   923870746801.38  591843286855.65   
VX               9729634.29       768784060.96     489604560.90      
WN               49284091239.93   4032839905482.80 2588037783419.72  
XE               1086523166.68    88010381099.56   55911940356.52    
YV               290739984.30     22161218928.78   14074678169.21    
2022-06-26 10:50:01,065 - main.py[line:100] - INFO: ground truth:
                  sum(a_taxi_out)  avg(a_taxi_out)  sum(a_air_time)  \
a_unique_carrier                                                      
9E               186150675.58     15.41            14535691258.24     
AA               21214068986.26   15.56            1642889128475.58   
AQ               2314826.80       15.49            179579366.04       
AS               1154387392.44    15.52            89659309014.36     
B6               720161306.65     15.54            55890876159.29     
CO               3238280786.11    15.59            250419701309.63    
DH               47009116.02      15.35            3678279375.65      
DL               26987393173.87   15.52            2095982798738.79   
EV               3368787348.62    15.56            260813225893.17    
F9               106873100.98     15.40            8361419167.75      
FL               648280682.33     15.58            50132743475.63     
HA               77215175.14      15.59            5958544408.33      
HP               499629045.57     15.62            38493702881.40     
MQ               4626540329.37    15.64            356285326970.77    
NK               7576515.00       15.99            569644060.02       
NW               5082110363.54    15.58            392783412683.41    
OH (1)           312620011.22     15.55            24232143153.54     
OO               6348008533.03    15.57            491246331562.20    
TW               342097502.57     15.39            26798355468.50     
TZ               4600843.10       15.70            352356791.59       
UA               15313702846.20   15.59            1183194629865.94   
US               11981571818.91   15.64            922595029692.72    
VX               9813531.01       15.43            766579476.28       
WN               51791567381.46   15.52            4021632774085.88   
XE               1139981555.30    15.60            88079206988.78     
YV               288239240.66     15.69            22185412324.36     

                  avg(a_air_time)  sum(a_distance)  avg(a_distance)  
a_unique_carrier                                                     
9E               1203.45          8764572397.34    725.65            
AA               1205.23          1009707233573.04 740.73            
AQ               1202.04          107083402.38     716.78            
AS               1205.06          55017341777.74   739.46            
B6               1206.41          34869096684.15   752.66            
CO               1205.39          154043678063.19  741.49            
DH               1201.46          2182382047.98    712.84            
DL               1205.63          1291564505404.67 742.92            
EV               1204.72          159383387512.30  736.21            
F9               1204.80          5103403661.65    735.35            
FL               1204.74          30728738929.48   738.45            
HA               1203.06          3578630334.24    722.55            
HP               1203.78          23258210731.24   727.33            
MQ               1204.28          216758600747.31  732.67            
NK               1202.05          337479764.18     712.14            
NW               1204.48          238957385182.80  732.77            
OH (1)           1205.49          14962439718.81   744.34            
OO               1205.08          301390386793.23  739.35            
TW               1205.20          16466134874.44   740.53            
TZ               1202.07          207799642.47     708.91            
UA               1204.72          723012818600.90  736.16            
US               1204.63          563903272305.26  736.29            
VX               1205.54          472488833.00     743.05            
WN               1204.79          2460319635486.43 737.05            
XE               1205.27          54139717693.22   740.85            
YV               1207.45          13947267504.53   759.08            
2022-06-26 10:50:01,075 - main.py[line:407] - INFO: relative error:
                  avg(a_air_time)  avg(a_distance)  avg(a_taxi_out)  \
a_unique_carrier                                                      
9E               0.00             0.07             0.02               
AA               0.00             0.05             0.04               
AQ               0.01             0.09             0.01               
AS               0.00             0.03             0.04               
B6               0.01             0.08             0.01               
CO               0.01             0.09             0.04               
DH               0.01             0.13             0.00               
DL               0.00             0.06             0.03               
EV               0.00             0.07             0.01               
F9               0.01             0.11             0.02               
FL               0.00             0.04             0.05               
HA               0.01             0.12             0.04               
HP               0.00             0.06             0.01               
MQ               0.00             0.01             0.03               
NK               0.00             0.09             0.04               
NW               0.00             0.04             0.04               
OH (1)           0.00             0.05             0.01               
OO               0.00             0.01             0.00               
TW               0.00             0.09             0.01               
TZ               0.01             0.13             0.03               
UA               0.00             0.05             0.00               
US               0.00             0.05             0.05               
VX               0.00             0.04             0.01               
WN               0.00             0.05             0.05               
XE               0.00             0.03             0.05               
YV               0.00             0.01             0.01               

                  sum(a_air_time)  sum(a_distance)  sum(a_taxi_out)  
a_unique_carrier                                                     
9E               0.00             0.07             0.02              
AA               0.00             0.05             0.04              
AQ               0.01             0.09             0.01              
AS               0.00             0.03             0.04              
B6               0.00             0.08             0.01              
CO               0.01             0.09             0.05              
DH               0.01             0.13             0.00              
DL               0.00             0.06             0.03              
EV               0.00             0.07             0.01              
F9               0.01             0.11             0.02              
FL               0.00             0.04             0.05              
HA               0.01             0.12             0.04              
HP               0.00             0.05             0.01              
MQ               0.00             0.01             0.03              
NK               0.00             0.09             0.04              
NW               0.00             0.04             0.04              
OH (1)           0.00             0.05             0.01              
OO               0.00             0.01             0.00              
TW               0.00             0.09             0.01              
TZ               0.01             0.12             0.03              
UA               0.00             0.05             0.00              
US               0.00             0.05             0.05              
VX               0.00             0.04             0.01              
WN               0.00             0.05             0.05              
XE               0.00             0.03             0.05              
YV               0.00             0.01             0.01              
2022-06-26 10:50:01,077 - main.py[line:408] - INFO: relative error normalized:
                  avg(a_air_time)  avg(a_distance)  avg(a_taxi_out)  \
a_unique_carrier                                                      
9E               0.00             0.07             0.02               
AA               0.00             0.05             0.04               
AQ               0.01             0.09             0.01               
AS               0.00             0.03             0.04               
B6               0.01             0.07             0.01               
CO               0.01             0.09             0.04               
DH               0.01             0.12             0.00               
DL               0.00             0.06             0.03               
EV               0.00             0.07             0.01               
F9               0.01             0.10             0.02               
FL               0.00             0.04             0.05               
HA               0.01             0.12             0.04               
HP               0.00             0.05             0.01               
MQ               0.00             0.01             0.03               
NK               0.00             0.09             0.04               
NW               0.00             0.04             0.04               
OH (1)           0.00             0.05             0.01               
OO               0.00             0.01             0.00               
TW               0.00             0.08             0.01               
TZ               0.01             0.12             0.03               
UA               0.00             0.05             0.00               
US               0.00             0.05             0.05               
VX               0.00             0.04             0.01               
WN               0.00             0.05             0.05               
XE               0.00             0.03             0.05               
YV               0.00             0.01             0.01               

                  sum(a_air_time)  sum(a_distance)  sum(a_taxi_out)  
a_unique_carrier                                                     
9E               0.00             0.07             0.02              
AA               0.00             0.05             0.04              
AQ               0.01             0.09             0.01              
AS               0.00             0.03             0.04              
B6               0.00             0.07             0.01              
CO               0.01             0.09             0.04              
DH               0.01             0.12             0.00              
DL               0.00             0.06             0.03              
EV               0.00             0.07             0.01              
F9               0.01             0.10             0.02              
FL               0.00             0.04             0.05              
HA               0.01             0.11             0.04              
HP               0.00             0.05             0.01              
MQ               0.00             0.01             0.03              
NK               0.00             0.09             0.04              
NW               0.00             0.04             0.04              
OH (1)           0.00             0.05             0.01              
OO               0.00             0.01             0.00              
TW               0.00             0.08             0.01              
TZ               0.01             0.12             0.03              
UA               0.00             0.05             0.00              
US               0.00             0.05             0.05              
VX               0.00             0.04             0.01              
WN               0.00             0.05             0.05              
XE               0.00             0.03             0.05              
YV               0.00             0.01             0.01              
2022-06-26 10:50:01,077 - main.py[line:411] - INFO: relative error average :0.030073083351258443
2022-06-26 10:50:01,077 - main.py[line:412] - INFO: relative error normalized average :0.029099481840868517
2022-06-26 10:50:01,078 - main.py[line:458] - INFO: total_time:151.57731596380472
label group counts before:{'WN': 50611, 'DL': 36527, 'AA': 32373, 'UA': 27510, 'US': 24373, 'OO': 17726, 'NW': 15831, 'MQ': 15150, 'EV': 12898, 'CO': 12610, 'AS': 7552, 'XE': 7486, 'B6': 5954, 'FL': 5647, 'HP': 4991, 'TW': 4133, 'OH (1)': 3933, 'YV': 3749, '9E': 3047, 'F9': 2295, 'HA': 1953, 'DH': 1540, 'VX': 698, 'NK': 606, 'TZ': 469, 'AQ': 338}
label group counts after:{'WN': 65955, 'DL': 47595, 'AA': 42107, 'UA': 35701, 'US': 31423, 'OO': 22997, 'NW': 20599, 'MQ': 19528, 'EV': 16785, 'CO': 16475, 'AS': 9852, 'XE': 9762, 'B6': 7781, 'FL': 7369, 'HP': 6407, 'TW': 5380, 'OH (1)': 5111, 'YV': 4901, '9E': 3964, 'F9': 3024, 'HA': 2536, 'DH': 1988, 'VX': 911, 'NK': 782, 'TZ': 625, 'AQ': 442}
feature_names: ['a_unique_carrier_0', 'a_unique_carrier_1', 'a_unique_carrier_2', 'a_unique_carrier_3', 'a_unique_carrier_4', 'a_unique_carrier_5']
categorical_columns: ['a_unique_carrier_0', 'a_unique_carrier_1', 'a_unique_carrier_2', 'a_unique_carrier_3', 'a_unique_carrier_4', 'a_unique_carrier_5']
categorical_columns: ['b_unique_carrier_0', 'b_unique_carrier_1', 'b_unique_carrier_2', 'b_unique_carrier_3', 'b_unique_carrier_4', 'b_unique_carrier_5']
