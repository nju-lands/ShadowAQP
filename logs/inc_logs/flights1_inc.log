main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-06-26 10:44:07,546 - main.py[line:438] - INFO: load query config config/query/flights-inc.json successfully
2022-06-26 10:44:07,547 - main.py[line:445] - INFO: load train config ./config/train/flights_a_inc_torch_cvae.json successfully
2022-06-26 10:44:07,547 - main.py[line:445] - INFO: load train config ./config/train/flights_b_torch_cvae.json successfully
2022-06-26 10:44:07,547 - dataset_utils.py[line:543] - INFO: load existing dataset:flights-flight-a-inc_a_unique_carrier_a_taxi_out#a_air_time#a_distance_a_unique_carrier_binary_gaussian5_0
2022-06-26 10:44:09,889 - dataset_utils.py[line:197] - INFO: encode incremental data categorical columns time elapsed:0.008168235421180725
2022-06-26 10:44:15,410 - dataset_utils.py[line:214] - INFO: encode incremental data numeric columnstime elapsed:5.521030444651842
2022-06-26 10:44:15,509 - dataset_utils.py[line:262] - INFO: load incremental data time elapsed:5.691099189221859
2022-06-26 10:44:15,509 - dataset_utils.py[line:555] - INFO: load dataset time elapsed:7.96275582537055
2022-06-26 10:44:15,510 - pytorch_cvae.py[line:295] - INFO: feature info:[('a_taxi_out', 'numerical', 6), ('a_air_time', 'numerical', 6), ('a_distance', 'numerical', 6), ('a_unique_carrier', 'categorical', 6)]
2022-06-26 10:44:15,511 - model_utils.py[line:75] - INFO: load model name:torch_cvae_flights-flight-a-inc_a_unique_carrier_ld50_id100_bs512_ep100_0_binary_gaussian5
2022-06-26 10:44:15,513 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.002021804451942444
2022-06-26 10:44:15,513 - pytorch_cvae.py[line:306] - INFO: load model time elapsed:7.966150674968958
2022-06-26 10:44:17,648 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.1 epoch----------------------------
2022-06-26 10:44:17,649 - pytorch_cvae.py[line:176] - INFO: loss:49.49032284319401, numeric_loss:26.439121454954147, categorical_loss:15.636477321386337, kld_loss:1375.5532536506653, epoch_train_time:2.135037310421467
2022-06-26 10:44:19,175 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.2 epoch----------------------------
2022-06-26 10:44:19,175 - pytorch_cvae.py[line:176] - INFO: loss:29.37776316702366, numeric_loss:17.220100317150354, categorical_loss:2.0028406493365765, kld_loss:1705.4636116027832, epoch_train_time:1.5265217423439026
2022-06-26 10:44:20,775 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.3 epoch----------------------------
2022-06-26 10:44:20,775 - pytorch_cvae.py[line:176] - INFO: loss:21.04392620176077, numeric_loss:6.637003026902676, categorical_loss:1.5223943677265197, kld_loss:1960.923487663269, epoch_train_time:1.5996914133429527
2022-06-26 10:44:22,322 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.4 epoch----------------------------
2022-06-26 10:44:22,322 - pytorch_cvae.py[line:176] - INFO: loss:19.891081385314465, numeric_loss:4.761689253151417, categorical_loss:1.3259437805972993, kld_loss:1905.6186666488647, epoch_train_time:1.547027375549078
2022-06-26 10:44:24,022 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.5 epoch----------------------------
2022-06-26 10:44:24,022 - pytorch_cvae.py[line:176] - INFO: loss:20.161527514457703, numeric_loss:4.3013987597078085, categorical_loss:1.2831933801062405, kld_loss:1827.2804927825928, epoch_train_time:1.6991514824330807
2022-06-26 10:44:25,710 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.6 epoch----------------------------
2022-06-26 10:44:25,711 - pytorch_cvae.py[line:176] - INFO: loss:20.859210342168808, numeric_loss:4.163775974884629, categorical_loss:1.2151380754075944, kld_loss:1763.7747621536255, epoch_train_time:1.6884126402437687
2022-06-26 10:44:27,295 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.7 epoch----------------------------
2022-06-26 10:44:27,295 - pytorch_cvae.py[line:176] - INFO: loss:21.939151003956795, numeric_loss:4.123126028105617, categorical_loss:1.223525814479217, kld_loss:1720.0253343582153, epoch_train_time:1.58450273796916
2022-06-26 10:44:28,948 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.8 epoch----------------------------
2022-06-26 10:44:28,948 - pytorch_cvae.py[line:176] - INFO: loss:23.169855996966362, numeric_loss:4.219261161983013, categorical_loss:1.2835958166979253, kld_loss:1667.9356527328491, epoch_train_time:1.652856521308422
2022-06-26 10:44:30,500 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.9 epoch----------------------------
2022-06-26 10:44:30,500 - pytorch_cvae.py[line:176] - INFO: loss:24.681182131171227, numeric_loss:4.292084390297532, categorical_loss:1.343780119670555, kld_loss:1639.202088356018, epoch_train_time:1.551290575414896
2022-06-26 10:44:32,137 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.10 epoch----------------------------
2022-06-26 10:44:32,138 - pytorch_cvae.py[line:176] - INFO: loss:26.122858867049217, numeric_loss:4.4713630098849535, categorical_loss:1.3862442402169108, kld_loss:1591.6893787384033, epoch_train_time:1.6375161707401276
2022-06-26 10:44:33,822 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.11 epoch----------------------------
2022-06-26 10:44:33,822 - pytorch_cvae.py[line:176] - INFO: loss:27.78964953124523, numeric_loss:4.675661822780967, categorical_loss:1.4710855432786047, kld_loss:1552.8094186782837, epoch_train_time:1.6843731291592121
2022-06-26 10:44:35,422 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.12 epoch----------------------------
2022-06-26 10:44:35,422 - pytorch_cvae.py[line:176] - INFO: loss:29.577826514840126, numeric_loss:4.873926296830177, categorical_loss:1.5525249333586544, kld_loss:1518.83327293396, epoch_train_time:1.600005827844143
2022-06-26 10:44:37,068 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.13 epoch----------------------------
2022-06-26 10:44:37,068 - pytorch_cvae.py[line:176] - INFO: loss:31.41129630804062, numeric_loss:5.099156077951193, categorical_loss:1.6088808728381991, kld_loss:1483.380313873291, epoch_train_time:1.6453915908932686
2022-06-26 10:44:38,645 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.14 epoch----------------------------
2022-06-26 10:44:38,646 - pytorch_cvae.py[line:176] - INFO: loss:33.57104243338108, numeric_loss:5.343038434162736, categorical_loss:1.7294164029881358, kld_loss:1457.874755859375, epoch_train_time:1.5773314125835896
2022-06-26 10:44:40,304 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.15 epoch----------------------------
2022-06-26 10:44:40,304 - pytorch_cvae.py[line:176] - INFO: loss:35.55810132622719, numeric_loss:5.666212659329176, categorical_loss:1.8022063206881285, kld_loss:1417.3524270057678, epoch_train_time:1.658121783286333
2022-06-26 10:44:41,942 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.16 epoch----------------------------
2022-06-26 10:44:41,942 - pytorch_cvae.py[line:176] - INFO: loss:37.9164113253355, numeric_loss:5.9788345862179995, categorical_loss:1.8713170127011836, kld_loss:1392.7662887573242, epoch_train_time:1.6375953443348408
2022-06-26 10:44:43,560 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.17 epoch----------------------------
2022-06-26 10:44:43,561 - pytorch_cvae.py[line:176] - INFO: loss:40.62382796406746, numeric_loss:6.330756273120642, categorical_loss:2.1303835182916373, kld_loss:1369.157148361206, epoch_train_time:1.6184808909893036
2022-06-26 10:44:45,217 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.18 epoch----------------------------
2022-06-26 10:44:45,217 - pytorch_cvae.py[line:176] - INFO: loss:43.08161045610905, numeric_loss:6.699422311037779, categorical_loss:2.194177704397589, kld_loss:1338.7860827445984, epoch_train_time:1.656416229903698
2022-06-26 10:44:46,752 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.19 epoch----------------------------
2022-06-26 10:44:46,753 - pytorch_cvae.py[line:176] - INFO: loss:46.08318540453911, numeric_loss:7.092734280973673, categorical_loss:2.45202702912502, kld_loss:1317.521954536438, epoch_train_time:1.5351845286786556
2022-06-26 10:44:48,375 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.20 epoch----------------------------
2022-06-26 10:44:48,376 - pytorch_cvae.py[line:176] - INFO: loss:48.97424656152725, numeric_loss:7.513396091759205, categorical_loss:2.689226042944938, kld_loss:1288.6264762878418, epoch_train_time:1.6227978728711605
2022-06-26 10:44:48,376 - pytorch_cvae.py[line:185] - INFO: training time elapsed:32.86281977593899
2022-06-26 10:44:48,377 - model_utils.py[line:67] - INFO: save model successfully
2022-06-26 10:44:53,642 - dataset_utils.py[line:562] - INFO: load existing dataset(light):flights-flight-b_b_unique_carrier__b_unique_carrier_binary_gaussian5_0
2022-06-26 10:44:53,686 - dataset_utils.py[line:571] - INFO: load dataset(light) time elapsed:0.04432051256299019
2022-06-26 10:44:53,686 - pytorch_cvae.py[line:275] - INFO: feature info:[('b_unique_carrier', 'categorical', 6)]
2022-06-26 10:44:53,687 - model_utils.py[line:75] - INFO: load model name:torch_cvae_flights-flight-b_b_unique_carrier_ld50_id100_bs512_ep100_0_binary_gaussian5
2022-06-26 10:44:53,689 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0019314028322696686
2022-06-26 10:44:53,689 - pytorch_cvae.py[line:285] - INFO: load model time elapsed:0.04734523221850395
2022-06-26 10:44:53,689 - main.py[line:382] - INFO: multi_sampling No.0 epoch
2022-06-26 10:44:53,783 - pytorch_cvae.py[line:398] - INFO: sampling time:0.0936865471303463
2022-06-26 10:44:53,850 - pytorch_cvae.py[line:418] - INFO: house sampling rate:0.05
2022-06-26 10:44:53,899 - pytorch_cvae.py[line:398] - INFO: sampling time:0.04955494776368141
2022-06-26 10:44:55,187 - main.py[line:366] - INFO: sample and aggregation time elapsed:1.497553687542677
2022-06-26 10:44:55,189 - main.py[line:399] - INFO: sample time:1.4999222941696644
2022-06-26 10:44:55,202 - main.py[line:99] - INFO: aqp result:
                  avg(a_taxi_out)  avg(a_air_time)  avg(a_distance)  \
a_unique_carrier                                                      
9E               17.09            1212.11          813.62             
AA               15.96            1212.14          785.35             
AQ               15.59            1212.90          783.96             
AS               17.54            1214.36          804.20             
B6               16.04            1202.88          727.31             
CO               16.24            1209.56          756.64             
DH               17.22            1210.68          740.66             
DL               16.41            1219.27          818.06             
EV               16.26            1214.02          795.17             
F9               16.57            1210.70          776.44             
FL               16.05            1214.97          807.72             
HA               16.39            1213.76          774.58             
HP               16.28            1213.99          837.80             
MQ               16.52            1208.96          731.55             
NK               16.17            1213.11          787.21             
NW               16.50            1215.80          824.57             
OH (1)           16.50            1210.28          769.73             
OO               15.89            1212.16          819.72             
TW               16.39            1214.13          781.48             
TZ               16.70            1218.48          838.69             
UA               16.12            1214.87          811.02             
US               16.48            1214.05          835.46             
VX               17.16            1213.59          795.66             
WN               16.14            1212.39          783.23             
XE               17.15            1214.61          798.91             
YV               15.70            1213.22          806.76             

                  sum(a_taxi_out)  sum(a_air_time)  sum(a_distance)  
a_unique_carrier                                                     
9E               206262537.13     14628338285.89   9819161046.25     
AA               21743245424.39   1650987289391.01 1069678395179.51  
AQ               2328879.52       181202929.00     117120454.26      
AS               1304100964.43    90278503235.52   59786131763.22    
B6               742330566.92     55682448837.39   33667899805.74    
CO               3372106326.89    251083566774.88  157066126649.30   
DH               52690285.38      3703444195.76    2265657270.27     
DL               28504745318.72   2118014461472.01 1421069271952.88  
EV               3518206782.39    262614534973.00  172010899897.54   
F9               114916718.92     8395625731.18    5384248293.47     
FL               667233514.48     50517270502.80   33584223783.93    
HA               81111823.90      6006673042.71    3833245244.77     
HP               520285974.02     38789550359.42   26769417448.56    
MQ               4882143668.99    357386781894.19  216256059419.17   
NK               7657741.01       574416401.71     372748907.10      
NW               5375546308.13    396157181027.25  268677889860.77   
OH (1)           331352632.95     24308774359.65   15460259390.12    
OO               6471193731.25    493737906316.56  333887259245.46   
TW               364165259.75     26975005501.51   17362588311.64    
TZ               4890126.29       356901822.69     245658946.98      
UA               15820133343.77   1192213556770.65 795897561469.96   
US               12611090406.30   929073956796.21  639350951999.27   
VX               10901539.14      771065880.59     505528952.73      
WN               53842928830.49   4043791337229.99 2612386282518.88  
XE               1251932575.49    88690898573.71   58336699903.10    
YV               288151191.25     22273735873.48   14811360042.64    
2022-06-26 10:44:55,206 - main.py[line:100] - INFO: ground truth:
                  sum(a_taxi_out)  avg(a_taxi_out)  sum(a_air_time)  \
a_unique_carrier                                                      
9E               186150675.58     15.41            14535691258.24     
AA               21214068986.26   15.56            1642889128475.58   
AQ               2314826.80       15.49            179579366.04       
AS               1154387392.44    15.52            89659309014.36     
B6               720161306.65     15.54            55890876159.29     
CO               3238280786.11    15.59            250419701309.63    
DH               47009116.02      15.35            3678279375.65      
DL               26987393173.87   15.52            2095982798738.79   
EV               3368787348.62    15.56            260813225893.17    
F9               106873100.98     15.40            8361419167.75      
FL               648280682.33     15.58            50132743475.63     
HA               77215175.14      15.59            5958544408.33      
HP               499629045.57     15.62            38493702881.40     
MQ               4626540329.37    15.64            356285326970.77    
NK               7576515.00       15.99            569644060.02       
NW               5082110363.54    15.58            392783412683.41    
OH (1)           312620011.22     15.55            24232143153.54     
OO               6348008533.03    15.57            491246331562.20    
TW               342097502.57     15.39            26798355468.50     
TZ               4600843.10       15.70            352356791.59       
UA               15313702846.20   15.59            1183194629865.94   
US               11981571818.91   15.64            922595029692.72    
VX               9813531.01       15.43            766579476.28       
WN               51791567381.46   15.52            4021632774085.88   
XE               1139981555.30    15.60            88079206988.78     
YV               288239240.66     15.69            22185412324.36     

                  avg(a_air_time)  sum(a_distance)  avg(a_distance)  
a_unique_carrier                                                     
9E               1203.45          8764572397.34    725.65            
AA               1205.23          1009707233573.04 740.73            
AQ               1202.04          107083402.38     716.78            
AS               1205.06          55017341777.74   739.46            
B6               1206.41          34869096684.15   752.66            
CO               1205.39          154043678063.19  741.49            
DH               1201.46          2182382047.98    712.84            
DL               1205.63          1291564505404.67 742.92            
EV               1204.72          159383387512.30  736.21            
F9               1204.80          5103403661.65    735.35            
FL               1204.74          30728738929.48   738.45            
HA               1203.06          3578630334.24    722.55            
HP               1203.78          23258210731.24   727.33            
MQ               1204.28          216758600747.31  732.67            
NK               1202.05          337479764.18     712.14            
NW               1204.48          238957385182.80  732.77            
OH (1)           1205.49          14962439718.81   744.34            
OO               1205.08          301390386793.23  739.35            
TW               1205.20          16466134874.44   740.53            
TZ               1202.07          207799642.47     708.91            
UA               1204.72          723012818600.90  736.16            
US               1204.63          563903272305.26  736.29            
VX               1205.54          472488833.00     743.05            
WN               1204.79          2460319635486.43 737.05            
XE               1205.27          54139717693.22   740.85            
YV               1207.45          13947267504.53   759.08            
2022-06-26 10:44:55,215 - main.py[line:407] - INFO: relative error:
                  avg(a_air_time)  avg(a_distance)  avg(a_taxi_out)  \
a_unique_carrier                                                      
9E               0.01             0.12             0.11               
AA               0.01             0.06             0.03               
AQ               0.01             0.09             0.01               
AS               0.01             0.09             0.13               
B6               0.00             0.03             0.03               
CO               0.00             0.02             0.04               
DH               0.01             0.04             0.12               
DL               0.01             0.10             0.06               
EV               0.01             0.08             0.05               
F9               0.00             0.06             0.08               
FL               0.01             0.09             0.03               
HA               0.01             0.07             0.05               
HP               0.01             0.15             0.04               
MQ               0.00             0.00             0.06               
NK               0.01             0.11             0.01               
NW               0.01             0.13             0.06               
OH (1)           0.00             0.03             0.06               
OO               0.01             0.11             0.02               
TW               0.01             0.06             0.07               
TZ               0.01             0.18             0.06               
UA               0.01             0.10             0.03               
US               0.01             0.13             0.05               
VX               0.01             0.07             0.11               
WN               0.01             0.06             0.04               
XE               0.01             0.08             0.10               
YV               0.00             0.06             0.00               

                  sum(a_air_time)  sum(a_distance)  sum(a_taxi_out)  
a_unique_carrier                                                     
9E               0.01             0.12             0.11              
AA               0.00             0.06             0.02              
AQ               0.01             0.09             0.01              
AS               0.01             0.09             0.13              
B6               0.00             0.03             0.03              
CO               0.00             0.02             0.04              
DH               0.01             0.04             0.12              
DL               0.01             0.10             0.06              
EV               0.01             0.08             0.04              
F9               0.00             0.06             0.08              
FL               0.01             0.09             0.03              
HA               0.01             0.07             0.05              
HP               0.01             0.15             0.04              
MQ               0.00             0.00             0.06              
NK               0.01             0.10             0.01              
NW               0.01             0.12             0.06              
OH (1)           0.00             0.03             0.06              
OO               0.01             0.11             0.02              
TW               0.01             0.05             0.06              
TZ               0.01             0.18             0.06              
UA               0.01             0.10             0.03              
US               0.01             0.13             0.05              
VX               0.01             0.07             0.11              
WN               0.01             0.06             0.04              
XE               0.01             0.08             0.10              
YV               0.00             0.06             0.00              
2022-06-26 10:44:55,217 - main.py[line:408] - INFO: relative error normalized:
                  avg(a_air_time)  avg(a_distance)  avg(a_taxi_out)  \
a_unique_carrier                                                      
9E               0.01             0.11             0.10               
AA               0.01             0.06             0.03               
AQ               0.01             0.09             0.01               
AS               0.01             0.08             0.12               
B6               0.00             0.03             0.03               
CO               0.00             0.02             0.04               
DH               0.01             0.04             0.11               
DL               0.01             0.10             0.06               
EV               0.01             0.08             0.04               
F9               0.00             0.05             0.07               
FL               0.01             0.09             0.03               
HA               0.01             0.07             0.05               
HP               0.01             0.14             0.04               
MQ               0.00             0.00             0.05               
NK               0.01             0.10             0.01               
NW               0.01             0.12             0.06               
OH (1)           0.00             0.03             0.06               
OO               0.01             0.10             0.02               
TW               0.01             0.05             0.06               
TZ               0.01             0.17             0.06               
UA               0.01             0.10             0.03               
US               0.01             0.13             0.05               
VX               0.01             0.07             0.11               
WN               0.01             0.06             0.04               
XE               0.01             0.08             0.09               
YV               0.00             0.06             0.00               

                  sum(a_air_time)  sum(a_distance)  sum(a_taxi_out)  
a_unique_carrier                                                     
9E               0.01             0.11             0.10              
AA               0.00             0.06             0.02              
AQ               0.01             0.09             0.01              
AS               0.01             0.08             0.12              
B6               0.00             0.03             0.03              
CO               0.00             0.02             0.04              
DH               0.01             0.04             0.11              
DL               0.01             0.10             0.05              
EV               0.01             0.08             0.04              
F9               0.00             0.05             0.07              
FL               0.01             0.09             0.03              
HA               0.01             0.07             0.05              
HP               0.01             0.14             0.04              
MQ               0.00             0.00             0.05              
NK               0.01             0.10             0.01              
NW               0.01             0.12             0.06              
OH (1)           0.00             0.03             0.06              
OO               0.01             0.10             0.02              
TW               0.01             0.05             0.06              
TZ               0.01             0.17             0.06              
UA               0.01             0.10             0.03              
US               0.01             0.13             0.05              
VX               0.01             0.07             0.10              
WN               0.01             0.06             0.04              
XE               0.01             0.07             0.09              
YV               0.00             0.06             0.00              
2022-06-26 10:44:55,217 - main.py[line:411] - INFO: relative error average :0.04793814890239313
2022-06-26 10:44:55,217 - main.py[line:412] - INFO: relative error normalized average :0.045910945368179516
2022-06-26 10:44:55,218 - main.py[line:458] - INFO: total_time:47.67177880182862
label group counts before:{'WN': 50611, 'DL': 36527, 'AA': 32373, 'UA': 27510, 'US': 24373, 'OO': 17726, 'NW': 15831, 'MQ': 15150, 'EV': 12898, 'CO': 12610, 'AS': 7552, 'XE': 7486, 'B6': 5954, 'FL': 5647, 'HP': 4991, 'TW': 4133, 'OH (1)': 3933, 'YV': 3749, '9E': 3047, 'F9': 2295, 'HA': 1953, 'DH': 1540, 'VX': 698, 'NK': 606, 'TZ': 469, 'AQ': 338}
label group counts after:{'WN': 65955, 'DL': 47595, 'AA': 42107, 'UA': 35701, 'US': 31423, 'OO': 22997, 'NW': 20599, 'MQ': 19528, 'EV': 16785, 'CO': 16475, 'AS': 9852, 'XE': 9762, 'B6': 7781, 'FL': 7369, 'HP': 6407, 'TW': 5380, 'OH (1)': 5111, 'YV': 4901, '9E': 3964, 'F9': 3024, 'HA': 2536, 'DH': 1988, 'VX': 911, 'NK': 782, 'TZ': 625, 'AQ': 442}
feature_names: ['a_unique_carrier_0', 'a_unique_carrier_1', 'a_unique_carrier_2', 'a_unique_carrier_3', 'a_unique_carrier_4', 'a_unique_carrier_5']
categorical_columns: ['a_unique_carrier_0', 'a_unique_carrier_1', 'a_unique_carrier_2', 'a_unique_carrier_3', 'a_unique_carrier_4', 'a_unique_carrier_5']
categorical_columns: ['b_unique_carrier_0', 'b_unique_carrier_1', 'b_unique_carrier_2', 'b_unique_carrier_3', 'b_unique_carrier_4', 'b_unique_carrier_5']
