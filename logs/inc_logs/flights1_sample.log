main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-06-26 10:45:13,420 - main.py[line:438] - INFO: load query config config/query/flights-inc.json successfully
2022-06-26 10:45:13,421 - main.py[line:445] - INFO: load train config ./config/train/flights_a_inc_torch_cvae.json successfully
2022-06-26 10:45:13,421 - main.py[line:445] - INFO: load train config ./config/train/flights_b_torch_cvae.json successfully
2022-06-26 10:45:13,421 - dataset_utils.py[line:543] - INFO: load existing dataset:flights-flight-a-inc_a_unique_carrier_a_taxi_out#a_air_time#a_distance_a_unique_carrier_binary_gaussian5_0
2022-06-26 10:45:15,774 - dataset_utils.py[line:197] - INFO: encode incremental data categorical columns time elapsed:0.008411690592765808
2022-06-26 10:45:21,754 - dataset_utils.py[line:214] - INFO: encode incremental data numeric columnstime elapsed:5.979057606309652
2022-06-26 10:45:21,851 - dataset_utils.py[line:262] - INFO: load incremental data time elapsed:6.148848596960306
2022-06-26 10:45:21,852 - dataset_utils.py[line:555] - INFO: load dataset time elapsed:8.431446563452482
2022-06-26 10:45:21,852 - pytorch_cvae.py[line:295] - INFO: feature info:[('a_taxi_out', 'numerical', 6), ('a_air_time', 'numerical', 6), ('a_distance', 'numerical', 6), ('a_unique_carrier', 'categorical', 6)]
2022-06-26 10:45:21,853 - model_utils.py[line:75] - INFO: load model name:torch_cvae_flights-flight-a-inc_a_unique_carrier_ld50_id100_bs512_ep100_0_binary_gaussian5
2022-06-26 10:45:21,855 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0020018629729747772
2022-06-26 10:45:21,856 - pytorch_cvae.py[line:306] - INFO: load model time elapsed:8.434813380241394
2022-06-26 10:45:23,662 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.1 epoch----------------------------
2022-06-26 10:45:23,662 - pytorch_cvae.py[line:176] - INFO: loss:45.00284259021282, numeric_loss:23.232091918587685, categorical_loss:15.418400718830526, kld_loss:1178.4653878211975, epoch_train_time:1.8055632524192333
2022-06-26 10:45:25,102 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.2 epoch----------------------------
2022-06-26 10:45:25,102 - pytorch_cvae.py[line:176] - INFO: loss:28.278558000922203, numeric_loss:18.16292304545641, categorical_loss:1.8184704068116844, kld_loss:1393.4771223068237, epoch_train_time:1.4399468041956425
2022-06-26 10:45:26,528 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.3 epoch----------------------------
2022-06-26 10:45:26,528 - pytorch_cvae.py[line:176] - INFO: loss:19.446362413465977, numeric_loss:7.0490707103163, categorical_loss:1.5207757116295397, kld_loss:1655.3198137283325, epoch_train_time:1.4262365102767944
2022-06-26 10:45:27,953 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.4 epoch----------------------------
2022-06-26 10:45:27,953 - pytorch_cvae.py[line:176] - INFO: loss:17.824609890580177, numeric_loss:4.6333337891846895, categorical_loss:1.2443814384751022, kld_loss:1649.3143529891968, epoch_train_time:1.4244850985705853
2022-06-26 10:45:29,343 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.5 epoch----------------------------
2022-06-26 10:45:29,343 - pytorch_cvae.py[line:176] - INFO: loss:17.76652793586254, numeric_loss:4.063177404925227, categorical_loss:1.131571474019438, kld_loss:1575.9256629943848, epoch_train_time:1.3898748718202114
2022-06-26 10:45:30,887 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.6 epoch----------------------------
2022-06-26 10:45:30,887 - pytorch_cvae.py[line:176] - INFO: loss:18.442088834941387, numeric_loss:3.8907396495342255, categorical_loss:1.0933999954722822, kld_loss:1533.3550996780396, epoch_train_time:1.543324802070856
2022-06-26 10:45:32,260 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.7 epoch----------------------------
2022-06-26 10:45:32,261 - pytorch_cvae.py[line:176] - INFO: loss:19.354886062443256, numeric_loss:3.799236711114645, categorical_loss:1.1428074187133461, kld_loss:1494.075912475586, epoch_train_time:1.3735855370759964
2022-06-26 10:45:33,691 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.8 epoch----------------------------
2022-06-26 10:45:33,691 - pytorch_cvae.py[line:176] - INFO: loss:20.434073954820633, numeric_loss:3.8431363496929407, categorical_loss:1.162241148063913, kld_loss:1456.618224143982, epoch_train_time:1.43006057664752
2022-06-26 10:45:35,110 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.9 epoch----------------------------
2022-06-26 10:45:35,110 - pytorch_cvae.py[line:176] - INFO: loss:21.734391912817955, numeric_loss:3.9589745551347733, categorical_loss:1.2133712547365576, kld_loss:1425.4706029891968, epoch_train_time:1.4191393740475178
2022-06-26 10:45:36,660 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.10 epoch----------------------------
2022-06-26 10:45:36,660 - pytorch_cvae.py[line:176] - INFO: loss:22.918440595269203, numeric_loss:4.057096080854535, categorical_loss:1.2598630622960627, kld_loss:1382.4694499969482, epoch_train_time:1.5498626045882702
2022-06-26 10:45:38,022 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.11 epoch----------------------------
2022-06-26 10:45:38,022 - pytorch_cvae.py[line:176] - INFO: loss:24.516711235046387, numeric_loss:4.23751868493855, categorical_loss:1.3318870526272804, kld_loss:1359.4089250564575, epoch_train_time:1.3614359609782696
2022-06-26 10:45:39,483 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.12 epoch----------------------------
2022-06-26 10:45:39,483 - pytorch_cvae.py[line:176] - INFO: loss:26.000328347086906, numeric_loss:4.485966550186276, categorical_loss:1.3760471518617123, kld_loss:1321.1630907058716, epoch_train_time:1.460762832313776
2022-06-26 10:45:41,049 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.13 epoch----------------------------
2022-06-26 10:45:41,050 - pytorch_cvae.py[line:176] - INFO: loss:27.784742653369904, numeric_loss:4.688955435529351, categorical_loss:1.495125699788332, kld_loss:1297.075650215149, epoch_train_time:1.5663454122841358
2022-06-26 10:45:42,536 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.14 epoch----------------------------
2022-06-26 10:45:42,536 - pytorch_cvae.py[line:176] - INFO: loss:29.570722594857216, numeric_loss:4.966287154704332, categorical_loss:1.5636875426862389, kld_loss:1267.63454246521, epoch_train_time:1.4861634708940983
2022-06-26 10:45:43,912 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.15 epoch----------------------------
2022-06-26 10:45:43,912 - pytorch_cvae.py[line:176] - INFO: loss:31.311377868056297, numeric_loss:5.22340533696115, categorical_loss:1.6063560941256583, kld_loss:1235.2962155342102, epoch_train_time:1.3756486140191555
2022-06-26 10:45:45,293 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.16 epoch----------------------------
2022-06-26 10:45:45,294 - pytorch_cvae.py[line:176] - INFO: loss:33.391109958291054, numeric_loss:5.547513857483864, categorical_loss:1.7254892019554973, kld_loss:1209.8750929832458, epoch_train_time:1.381595190614462
2022-06-26 10:45:46,751 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.17 epoch----------------------------
2022-06-26 10:45:46,751 - pytorch_cvae.py[line:176] - INFO: loss:35.720379650592804, numeric_loss:5.867197655141354, categorical_loss:1.8854198814369738, kld_loss:1190.5802602767944, epoch_train_time:1.4575977586209774
2022-06-26 10:45:48,223 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.18 epoch----------------------------
2022-06-26 10:45:48,223 - pytorch_cvae.py[line:176] - INFO: loss:37.79744218289852, numeric_loss:6.1750211380422115, categorical_loss:1.9263356011360884, kld_loss:1162.8844499588013, epoch_train_time:1.4718578420579433
2022-06-26 10:45:49,579 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.19 epoch----------------------------
2022-06-26 10:45:49,579 - pytorch_cvae.py[line:176] - INFO: loss:40.34835848212242, numeric_loss:6.534753441810608, categorical_loss:2.198144592344761, kld_loss:1140.0071110725403, epoch_train_time:1.3552003987133503
2022-06-26 10:45:50,938 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.20 epoch----------------------------
2022-06-26 10:45:50,938 - pytorch_cvae.py[line:176] - INFO: loss:42.82388713955879, numeric_loss:6.964689232409, categorical_loss:2.287215007469058, kld_loss:1115.8094730377197, epoch_train_time:1.3592539504170418
2022-06-26 10:45:50,938 - pytorch_cvae.py[line:185] - INFO: training time elapsed:29.08284630998969
2022-06-26 10:45:50,940 - model_utils.py[line:67] - INFO: save model successfully
2022-06-26 10:45:52,426 - dataset_utils.py[line:562] - INFO: load existing dataset(light):flights-flight-b_b_unique_carrier__b_unique_carrier_binary_gaussian5_0
2022-06-26 10:45:52,445 - dataset_utils.py[line:571] - INFO: load dataset(light) time elapsed:0.019042328000068665
2022-06-26 10:45:52,445 - pytorch_cvae.py[line:275] - INFO: feature info:[('b_unique_carrier', 'categorical', 6)]
2022-06-26 10:45:52,446 - model_utils.py[line:75] - INFO: load model name:torch_cvae_flights-flight-b_b_unique_carrier_ld50_id100_bs512_ep100_0_binary_gaussian5
2022-06-26 10:45:52,448 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0016620829701423645
2022-06-26 10:45:52,448 - pytorch_cvae.py[line:285] - INFO: load model time elapsed:0.021562345325946808
2022-06-26 10:45:52,448 - main.py[line:382] - INFO: multi_sampling No.0 epoch
2022-06-26 10:45:52,532 - pytorch_cvae.py[line:398] - INFO: sampling time:0.08384618535637856
2022-06-26 10:45:52,599 - pytorch_cvae.py[line:418] - INFO: house sampling rate:0.05
2022-06-26 10:45:52,648 - pytorch_cvae.py[line:398] - INFO: sampling time:0.048523977398872375
2022-06-26 10:45:53,978 - main.py[line:366] - INFO: sample and aggregation time elapsed:1.5296763479709625
2022-06-26 10:45:53,981 - main.py[line:399] - INFO: sample time:1.533421851694584
2022-06-26 10:45:53,999 - main.py[line:99] - INFO: aqp result:
                  avg(a_taxi_out)  avg(a_air_time)  avg(a_distance)  \
a_unique_carrier                                                      
9E               14.98            1211.73          803.10             
AA               14.92            1210.50          770.29             
AQ               16.10            1214.75          843.87             
AS               15.25            1219.00          800.24             
B6               14.46            1209.82          766.05             
CO               15.81            1217.55          826.26             
DH               15.25            1211.86          787.31             
DL               15.13            1211.61          772.75             
EV               14.95            1214.00          808.72             
F9               14.75            1214.96          798.84             
FL               16.13            1215.35          806.78             
HA               14.67            1214.11          799.08             
HP               15.14            1216.83          814.42             
MQ               14.93            1216.87          814.13             
NK               15.29            1215.64          822.49             
NW               14.87            1215.48          802.99             
OH (1)           14.80            1216.60          816.34             
OO               15.39            1212.56          787.17             
TW               14.86            1212.52          780.94             
TZ               14.97            1215.68          795.30             
UA               15.13            1214.76          803.67             
US               15.56            1214.28          784.69             
VX               14.92            1213.10          795.94             
WN               15.52            1215.92          804.15             
XE               15.03            1213.21          780.64             
YV               14.95            1217.01          796.78             

                  sum(a_taxi_out)  sum(a_air_time)  sum(a_distance)  
a_unique_carrier                                                     
9E               180782476.95     14623812875.92   9692232464.68     
AA               20318657318.63   1648751824843.50 1049161840950.88  
AQ               2405376.29       181478860.48     126070677.36      
AS               1133988288.13    90623095724.99   59491853236.58    
B6               669190735.93     56003406923.17   35460920431.47    
CO               3282740818.55    252741160079.53  171517776833.98   
DH               46637353.48      3707061203.19    2408384308.40     
DL               26279430505.44   2104713580789.44 1342354730677.47  
EV               3234963659.24    262612029170.49  174942308145.52   
F9               102255324.45     8425157856.44    5539536274.32     
FL               670808033.33     50533007783.67   33545286557.57    
HA               72576150.96      6008419233.84    3954488306.78     
HP               483604930.79     38880516988.49   26022570143.66    
MQ               4414675635.99    359724722239.35  240667365037.72   
NK               7239045.65       575616254.66     389454660.61      
NW               4845521645.57    396052269424.26  261645698033.32   
OH (1)           297177504.27     24435610076.50   16396303700.40    
OO               6269234057.25    493902327760.32  320631664611.16   
TW               330102225.29     26939075850.08   17350617649.24    
TZ               4383637.20       356083260.64     232949703.31      
UA               14845133369.20   1192105153010.58 788682097356.76   
US               11903885172.71   929255214803.94  600499563515.04   
VX               9476511.56       770754485.20     505708416.69      
WN               51755399079.68   4055564189064.85 2682156837205.93  
XE               1097516876.09    88589092377.52   57002533603.86    
YV               274542187.68     22343323529.01   14628250249.45    
2022-06-26 10:45:54,003 - main.py[line:100] - INFO: ground truth:
                  sum(a_taxi_out)  avg(a_taxi_out)  sum(a_air_time)  \
a_unique_carrier                                                      
9E               186150675.58     15.41            14535691258.24     
AA               21214068986.26   15.56            1642889128475.58   
AQ               2314826.80       15.49            179579366.04       
AS               1154387392.44    15.52            89659309014.36     
B6               720161306.65     15.54            55890876159.29     
CO               3238280786.11    15.59            250419701309.63    
DH               47009116.02      15.35            3678279375.65      
DL               26987393173.87   15.52            2095982798738.79   
EV               3368787348.62    15.56            260813225893.17    
F9               106873100.98     15.40            8361419167.75      
FL               648280682.33     15.58            50132743475.63     
HA               77215175.14      15.59            5958544408.33      
HP               499629045.57     15.62            38493702881.40     
MQ               4626540329.37    15.64            356285326970.77    
NK               7576515.00       15.99            569644060.02       
NW               5082110363.54    15.58            392783412683.41    
OH (1)           312620011.22     15.55            24232143153.54     
OO               6348008533.03    15.57            491246331562.20    
TW               342097502.57     15.39            26798355468.50     
TZ               4600843.10       15.70            352356791.59       
UA               15313702846.20   15.59            1183194629865.94   
US               11981571818.91   15.64            922595029692.72    
VX               9813531.01       15.43            766579476.28       
WN               51791567381.46   15.52            4021632774085.88   
XE               1139981555.30    15.60            88079206988.78     
YV               288239240.66     15.69            22185412324.36     

                  avg(a_air_time)  sum(a_distance)  avg(a_distance)  
a_unique_carrier                                                     
9E               1203.45          8764572397.34    725.65            
AA               1205.23          1009707233573.04 740.73            
AQ               1202.04          107083402.38     716.78            
AS               1205.06          55017341777.74   739.46            
B6               1206.41          34869096684.15   752.66            
CO               1205.39          154043678063.19  741.49            
DH               1201.46          2182382047.98    712.84            
DL               1205.63          1291564505404.67 742.92            
EV               1204.72          159383387512.30  736.21            
F9               1204.80          5103403661.65    735.35            
FL               1204.74          30728738929.48   738.45            
HA               1203.06          3578630334.24    722.55            
HP               1203.78          23258210731.24   727.33            
MQ               1204.28          216758600747.31  732.67            
NK               1202.05          337479764.18     712.14            
NW               1204.48          238957385182.80  732.77            
OH (1)           1205.49          14962439718.81   744.34            
OO               1205.08          301390386793.23  739.35            
TW               1205.20          16466134874.44   740.53            
TZ               1202.07          207799642.47     708.91            
UA               1204.72          723012818600.90  736.16            
US               1204.63          563903272305.26  736.29            
VX               1205.54          472488833.00     743.05            
WN               1204.79          2460319635486.43 737.05            
XE               1205.27          54139717693.22   740.85            
YV               1207.45          13947267504.53   759.08            
2022-06-26 10:45:54,012 - main.py[line:407] - INFO: relative error:
                  avg(a_air_time)  avg(a_distance)  avg(a_taxi_out)  \
a_unique_carrier                                                      
9E               0.01             0.11             0.03               
AA               0.00             0.04             0.04               
AQ               0.01             0.18             0.04               
AS               0.01             0.08             0.02               
B6               0.00             0.02             0.07               
CO               0.01             0.11             0.01               
DH               0.01             0.10             0.01               
DL               0.00             0.04             0.03               
EV               0.01             0.10             0.04               
F9               0.01             0.09             0.04               
FL               0.01             0.09             0.04               
HA               0.01             0.11             0.06               
HP               0.01             0.12             0.03               
MQ               0.01             0.11             0.05               
NK               0.01             0.15             0.04               
NW               0.01             0.10             0.05               
OH (1)           0.01             0.10             0.05               
OO               0.01             0.06             0.01               
TW               0.01             0.05             0.03               
TZ               0.01             0.12             0.05               
UA               0.01             0.09             0.03               
US               0.01             0.07             0.01               
VX               0.01             0.07             0.03               
WN               0.01             0.09             0.00               
XE               0.01             0.05             0.04               
YV               0.01             0.05             0.05               

                  sum(a_air_time)  sum(a_distance)  sum(a_taxi_out)  
a_unique_carrier                                                     
9E               0.01             0.11             0.03              
AA               0.00             0.04             0.04              
AQ               0.01             0.18             0.04              
AS               0.01             0.08             0.02              
B6               0.00             0.02             0.07              
CO               0.01             0.11             0.01              
DH               0.01             0.10             0.01              
DL               0.00             0.04             0.03              
EV               0.01             0.10             0.04              
F9               0.01             0.09             0.04              
FL               0.01             0.09             0.03              
HA               0.01             0.11             0.06              
HP               0.01             0.12             0.03              
MQ               0.01             0.11             0.05              
NK               0.01             0.15             0.04              
NW               0.01             0.09             0.05              
OH (1)           0.01             0.10             0.05              
OO               0.01             0.06             0.01              
TW               0.01             0.05             0.04              
TZ               0.01             0.12             0.05              
UA               0.01             0.09             0.03              
US               0.01             0.06             0.01              
VX               0.01             0.07             0.03              
WN               0.01             0.09             0.00              
XE               0.01             0.05             0.04              
YV               0.01             0.05             0.05              
2022-06-26 10:45:54,014 - main.py[line:408] - INFO: relative error normalized:
                  avg(a_air_time)  avg(a_distance)  avg(a_taxi_out)  \
a_unique_carrier                                                      
9E               0.01             0.10             0.03               
AA               0.00             0.04             0.04               
AQ               0.01             0.16             0.04               
AS               0.01             0.08             0.02               
B6               0.00             0.02             0.07               
CO               0.01             0.11             0.01               
DH               0.01             0.10             0.01               
DL               0.00             0.04             0.03               
EV               0.01             0.09             0.04               
F9               0.01             0.08             0.04               
FL               0.01             0.09             0.03               
HA               0.01             0.10             0.06               
HP               0.01             0.11             0.03               
MQ               0.01             0.11             0.04               
NK               0.01             0.14             0.04               
NW               0.01             0.09             0.04               
OH (1)           0.01             0.09             0.05               
OO               0.01             0.06             0.01               
TW               0.01             0.05             0.03               
TZ               0.01             0.11             0.05               
UA               0.01             0.09             0.03               
US               0.01             0.06             0.01               
VX               0.01             0.07             0.03               
WN               0.01             0.09             0.00               
XE               0.01             0.05             0.04               
YV               0.01             0.05             0.05               

                  sum(a_air_time)  sum(a_distance)  sum(a_taxi_out)  
a_unique_carrier                                                     
9E               0.01             0.10             0.03              
AA               0.00             0.04             0.04              
AQ               0.01             0.16             0.04              
AS               0.01             0.08             0.02              
B6               0.00             0.02             0.07              
CO               0.01             0.11             0.01              
DH               0.01             0.10             0.01              
DL               0.00             0.04             0.03              
EV               0.01             0.09             0.04              
F9               0.01             0.08             0.04              
FL               0.01             0.09             0.03              
HA               0.01             0.10             0.06              
HP               0.01             0.11             0.03              
MQ               0.01             0.10             0.04              
NK               0.01             0.14             0.04              
NW               0.01             0.09             0.05              
OH (1)           0.01             0.09             0.05              
OO               0.01             0.06             0.01              
TW               0.01             0.05             0.03              
TZ               0.01             0.11             0.05              
UA               0.01             0.09             0.03              
US               0.01             0.06             0.01              
VX               0.01             0.07             0.03              
WN               0.01             0.09             0.00              
XE               0.01             0.05             0.04              
YV               0.01             0.05             0.05              
2022-06-26 10:45:54,014 - main.py[line:411] - INFO: relative error average :0.04344867110707677
2022-06-26 10:45:54,014 - main.py[line:412] - INFO: relative error normalized average :0.04175226211557164
2022-06-26 10:45:54,015 - main.py[line:458] - INFO: total_time:40.59497540816665
label group counts before:{'WN': 50611, 'DL': 36527, 'AA': 32373, 'UA': 27510, 'US': 24373, 'OO': 17726, 'NW': 15831, 'MQ': 15150, 'EV': 12898, 'CO': 12610, 'AS': 7552, 'XE': 7486, 'B6': 5954, 'FL': 5647, 'HP': 4991, 'TW': 4133, 'OH (1)': 3933, 'YV': 3749, '9E': 3047, 'F9': 2295, 'HA': 1953, 'DH': 1540, 'VX': 698, 'NK': 606, 'TZ': 469, 'AQ': 338}
label group counts after:{'WN': 65955, 'DL': 47595, 'AA': 42107, 'UA': 35701, 'US': 31423, 'OO': 22997, 'NW': 20599, 'MQ': 19528, 'EV': 16785, 'CO': 16475, 'AS': 9852, 'XE': 9762, 'B6': 7781, 'FL': 7369, 'HP': 6407, 'TW': 5380, 'OH (1)': 5111, 'YV': 4901, '9E': 3964, 'F9': 3024, 'HA': 2536, 'DH': 1988, 'VX': 911, 'NK': 782, 'TZ': 625, 'AQ': 442}
feature_names: ['a_unique_carrier_0', 'a_unique_carrier_1', 'a_unique_carrier_2', 'a_unique_carrier_3', 'a_unique_carrier_4', 'a_unique_carrier_5']
categorical_columns: ['a_unique_carrier_0', 'a_unique_carrier_1', 'a_unique_carrier_2', 'a_unique_carrier_3', 'a_unique_carrier_4', 'a_unique_carrier_5']
categorical_columns: ['b_unique_carrier_0', 'b_unique_carrier_1', 'b_unique_carrier_2', 'b_unique_carrier_3', 'b_unique_carrier_4', 'b_unique_carrier_5']
