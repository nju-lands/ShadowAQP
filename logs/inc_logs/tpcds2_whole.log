main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-06-26 10:51:41,677 - main.py[line:438] - INFO: load query config config/query/sales_inc_join_store.json successfully
2022-06-26 10:51:41,678 - main.py[line:445] - INFO: load train config ./config/train/tpcds_ssales_store_inc_torch_cvae.json successfully
2022-06-26 10:51:41,678 - main.py[line:445] - INFO: load train config ./config/train/tpcds_store_torch_cvae.json successfully
2022-06-26 10:51:41,678 - dataset_utils.py[line:543] - INFO: load existing dataset:tpcds-06667g-ssales_store-inc_ss_store_sk_ss_wholesale_cost#ss_list_price#ss_sales_price#ss_ext_sales_price_ss_store_sk_binary_mm_0
2022-06-26 10:51:45,139 - dataset_utils.py[line:197] - INFO: encode incremental data categorical columns time elapsed:0.01960109919309616
2022-06-26 10:51:45,149 - dataset_utils.py[line:214] - INFO: encode incremental data numeric columnstime elapsed:0.010496087372303009
2022-06-26 10:51:45,402 - dataset_utils.py[line:262] - INFO: load incremental data time elapsed:0.9925135970115662
2022-06-26 10:51:45,402 - dataset_utils.py[line:555] - INFO: load dataset time elapsed:3.724547654390335
2022-06-26 10:51:45,402 - pytorch_cvae.py[line:295] - INFO: feature info:[('ss_wholesale_cost', 'numerical', 1), ('ss_list_price', 'numerical', 1), ('ss_sales_price', 'numerical', 1), ('ss_ext_sales_price', 'numerical', 1), ('ss_store_sk', 'categorical', 4)]
2022-06-26 10:51:45,404 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpcds-06667g-ssales_store-inc_ss_store_sk_ld100_id100_bs512_ep150_0_binary_mm
2022-06-26 10:51:45,406 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0019947513937950134
2022-06-26 10:51:45,406 - pytorch_cvae.py[line:306] - INFO: load model time elapsed:3.7280139103531837
2022-06-26 10:52:20,670 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.1 epoch----------------------------
2022-06-26 10:52:20,670 - pytorch_cvae.py[line:176] - INFO: loss:160.88775187917054, numeric_loss:90.66041258815676, categorical_loss:0.39031069008342456, kld_loss:12955.917336593673, epoch_train_time:35.26328018680215
2022-06-26 10:52:55,525 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.2 epoch----------------------------
2022-06-26 10:52:55,525 - pytorch_cvae.py[line:176] - INFO: loss:131.01173388026655, numeric_loss:58.99745240807533, categorical_loss:0.3507088457190548, kld_loss:12035.62335896492, epoch_train_time:34.85492908209562
2022-06-26 10:53:30,436 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.3 epoch----------------------------
2022-06-26 10:53:30,436 - pytorch_cvae.py[line:176] - INFO: loss:137.19429803080857, numeric_loss:60.25994450226426, categorical_loss:0.3483091121597681, kld_loss:11655.79095029831, epoch_train_time:34.910932030528784
2022-06-26 10:54:05,385 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.4 epoch----------------------------
2022-06-26 10:54:05,385 - pytorch_cvae.py[line:176] - INFO: loss:144.53465991839767, numeric_loss:62.37227479554713, categorical_loss:0.3486056147230556, kld_loss:11294.704140901566, epoch_train_time:34.948927242308855
2022-06-26 10:54:40,300 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.5 epoch----------------------------
2022-06-26 10:54:40,300 - pytorch_cvae.py[line:176] - INFO: loss:151.9657696299255, numeric_loss:63.16008505318314, categorical_loss:0.34810332999768434, kld_loss:11088.531823396683, epoch_train_time:34.91431812569499
2022-06-26 10:55:15,277 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.6 epoch----------------------------
2022-06-26 10:55:15,277 - pytorch_cvae.py[line:176] - INFO: loss:159.19179951772094, numeric_loss:65.71368629019707, categorical_loss:0.349048683870933, kld_loss:10610.823627948761, epoch_train_time:34.976999279111624
2022-06-26 10:55:50,226 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.7 epoch----------------------------
2022-06-26 10:55:50,226 - pytorch_cvae.py[line:176] - INFO: loss:167.33096277713776, numeric_loss:67.68327932525426, categorical_loss:0.34941916871321155, kld_loss:10293.538613796234, epoch_train_time:34.9491071254015
2022-06-26 10:56:25,058 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.8 epoch----------------------------
2022-06-26 10:56:25,058 - pytorch_cvae.py[line:176] - INFO: loss:176.62725730985403, numeric_loss:70.94481015298516, categorical_loss:0.3494933952097199, kld_loss:9944.450010061264, epoch_train_time:34.831361681222916
2022-06-26 10:57:00,048 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.9 epoch----------------------------
2022-06-26 10:57:00,048 - pytorch_cvae.py[line:176] - INFO: loss:186.59861377999187, numeric_loss:75.22906291019171, categorical_loss:0.350800929532852, kld_loss:9555.218219995499, epoch_train_time:34.99015552923083
2022-06-26 10:57:34,868 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.10 epoch----------------------------
2022-06-26 10:57:34,868 - pytorch_cvae.py[line:176] - INFO: loss:196.93870953470469, numeric_loss:79.78993105795234, categorical_loss:0.3515048641493195, kld_loss:9173.583681344986, epoch_train_time:34.819595381617546
2022-06-26 10:58:09,803 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.11 epoch----------------------------
2022-06-26 10:58:09,803 - pytorch_cvae.py[line:176] - INFO: loss:207.75160852074623, numeric_loss:84.86587551608682, categorical_loss:0.35239628110139165, kld_loss:8791.377319812775, epoch_train_time:34.93468999117613
2022-06-26 10:58:44,732 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.12 epoch----------------------------
2022-06-26 10:58:44,732 - pytorch_cvae.py[line:176] - INFO: loss:218.9311900921166, numeric_loss:90.42487642168999, categorical_loss:0.35298838195740245, kld_loss:8407.428599238396, epoch_train_time:34.92910859361291
2022-06-26 10:59:19,672 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.13 epoch----------------------------
2022-06-26 10:59:19,672 - pytorch_cvae.py[line:176] - INFO: loss:230.392972715199, numeric_loss:95.87275950238109, categorical_loss:0.354375236951455, kld_loss:8056.384816288948, epoch_train_time:34.93979446962476
2022-06-26 10:59:54,425 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.14 epoch----------------------------
2022-06-26 10:59:54,425 - pytorch_cvae.py[line:176] - INFO: loss:242.4133529663086, numeric_loss:101.38380025885999, categorical_loss:0.35474324344977504, kld_loss:7739.516379594803, epoch_train_time:34.752653919160366
2022-06-26 11:00:29,532 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.15 epoch----------------------------
2022-06-26 11:00:29,532 - pytorch_cvae.py[line:176] - INFO: loss:254.7401799298823, numeric_loss:107.27815288305283, categorical_loss:0.3558931382067385, kld_loss:7422.69820857048, epoch_train_time:35.107201777398586
2022-06-26 11:01:04,444 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.16 epoch----------------------------
2022-06-26 11:01:04,444 - pytorch_cvae.py[line:176] - INFO: loss:267.5951563306153, numeric_loss:113.65336419641972, categorical_loss:0.3563328795862617, kld_loss:7114.574671626091, epoch_train_time:34.9119479060173
2022-06-26 11:01:39,574 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.17 epoch----------------------------
2022-06-26 11:01:39,574 - pytorch_cvae.py[line:176] - INFO: loss:280.9708977751434, numeric_loss:120.51315069384873, categorical_loss:0.35713551023218315, kld_loss:6815.44083571434, epoch_train_time:35.12897362187505
2022-06-26 11:02:14,542 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.18 epoch----------------------------
2022-06-26 11:02:14,542 - pytorch_cvae.py[line:176] - INFO: loss:294.7810391560197, numeric_loss:127.97474635764956, categorical_loss:0.3579012102127308, kld_loss:6518.039146542549, epoch_train_time:34.96803616732359
2022-06-26 11:02:49,452 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.19 epoch----------------------------
2022-06-26 11:02:49,452 - pytorch_cvae.py[line:176] - INFO: loss:308.65924121439457, numeric_loss:136.02927486598492, categorical_loss:0.35894815770734567, kld_loss:6211.840121150017, epoch_train_time:34.90987200289965
2022-06-26 11:03:24,567 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.20 epoch----------------------------
2022-06-26 11:03:24,568 - pytorch_cvae.py[line:176] - INFO: loss:322.914355635643, numeric_loss:144.7765430789441, categorical_loss:0.36086603692820063, kld_loss:5908.653109550476, epoch_train_time:35.1154248341918
2022-06-26 11:03:24,568 - pytorch_cvae.py[line:185] - INFO: training time elapsed:699.1619465611875
2022-06-26 11:03:24,569 - model_utils.py[line:67] - INFO: save model successfully
2022-06-26 11:03:31,627 - dataset_utils.py[line:562] - INFO: load existing dataset(light):tpcds-06667g-store_s_store_sk#s_store_name__s_store_sk#s_store_name_binary_gaussian5_0
2022-06-26 11:03:31,629 - dataset_utils.py[line:571] - INFO: load dataset(light) time elapsed:0.0021141022443771362
2022-06-26 11:03:31,630 - pytorch_cvae.py[line:275] - INFO: feature info:[('s_store_sk', 'categorical', 5), ('s_store_name', 'categorical', 4)]
2022-06-26 11:03:31,630 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpcds-06667g-store_s_store_sk_s_store_name_ld100_id150_bs128_ep100_0_binary_gaussian5
2022-06-26 11:03:31,632 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0020967088639736176
2022-06-26 11:03:31,633 - pytorch_cvae.py[line:285] - INFO: load model time elapsed:0.005238022655248642
2022-06-26 11:03:31,633 - main.py[line:382] - INFO: multi_sampling No.0 epoch
2022-06-26 11:03:31,681 - pytorch_cvae.py[line:398] - INFO: sampling time:0.04763468727469444
2022-06-26 11:03:31,881 - dataset_utils.py[line:543] - INFO: load existing dataset:tpcds-06667g-store_s_store_sk#s_store_name__s_store_sk#s_store_name_binary_gaussian5_0
2022-06-26 11:03:31,888 - dataset_utils.py[line:555] - INFO: load dataset time elapsed:0.007138412445783615
2022-06-26 11:03:31,929 - main.py[line:366] - INFO: sample and aggregation time elapsed:0.2959173023700714
2022-06-26 11:03:31,933 - main.py[line:399] - INFO: sample time:0.2999395728111267
2022-06-26 11:03:31,946 - main.py[line:99] - INFO: aqp result:
              avg(ss_wholesale_cost)  avg(ss_list_price)  avg(ss_sales_price)  \
s_store_name                                                                    
able         49.54                   74.29               38.11                  
ation        49.17                   74.34               37.40                  
bar          51.15                   77.30               39.06                  
eing         50.80                   76.48               39.82                  
ese          50.47                   75.86               37.94                  
ought        50.82                   75.70               40.23                  

              avg(ss_ext_sales_price)  sum(ss_wholesale_cost)  \
s_store_name                                                    
able         1932.39                  18751267.64               
ation        1867.96                  18598976.95               
bar          1902.32                  19434268.08               
eing         1945.14                  19267176.81               
ese          1842.99                  19138267.01               
ought        2030.72                  19172554.99               

              sum(ss_list_price)  sum(ss_sales_price)  sum(ss_ext_sales_price)  
s_store_name                                                                    
able         28119282.72         14426204.09          731402475.13              
ation        28121933.69         14147081.35          706634429.85              
bar          29372519.05         14842329.84          722806949.46              
eing         29007545.23         15101615.69          737732741.81              
ese          28762848.57         14386467.13          698818525.85              
ought        28556847.64         15177514.47          766051731.47              
2022-06-26 11:03:31,950 - main.py[line:100] - INFO: ground truth:
              avg(ss_wholesale_cost)  avg(ss_list_price)  avg(ss_sales_price)  \
s_store_name                                                                    
able         50.64                   76.00               38.03                  
ation        50.51                   75.77               37.86                  
bar          50.45                   75.60               37.86                  
eing         50.48                   75.70               37.88                  
ese          50.43                   75.66               37.81                  
ought        50.51                   75.76               37.85                  

              avg(ss_ext_sales_price)  sum(ss_wholesale_cost)  \
s_store_name                                                    
able         1927.79                   19222153                 
ation        1913.49                   19163879                 
bar          1909.73                   19223866                 
eing         1914.67                   19197418                 
ese          1907.31                   19180565                 
ought        1914.74                   19110523                 

              sum(ss_list_price)  sum(ss_sales_price)  sum(ss_ext_sales_price)  
s_store_name                                                                    
able          28850558            14437728             731785975                
ation         28748144            14363226             726020132                
bar           28805923            14424380             727683698                
eing          28790601            14405583             728157588                
ese           28775371            14380114             725440120                
ought         28664128            14318058             724409110                
2022-06-26 11:03:31,959 - main.py[line:407] - INFO: relative error:
              avg(ss_wholesale_cost)  avg(ss_list_price)  avg(ss_sales_price)  \
s_store_name                                                                    
able         0.02                    0.02                0.00                   
ation        0.03                    0.02                0.01                   
bar          0.01                    0.02                0.03                   
eing         0.01                    0.01                0.05                   
ese          0.00                    0.00                0.00                   
ought        0.01                    0.00                0.06                   

              avg(ss_ext_sales_price)  sum(ss_wholesale_cost)  \
s_store_name                                                    
able         0.00                     0.02                      
ation        0.02                     0.03                      
bar          0.00                     0.01                      
eing         0.02                     0.00                      
ese          0.03                     0.00                      
ought        0.06                     0.00                      

              sum(ss_list_price)  sum(ss_sales_price)  sum(ss_ext_sales_price)  
s_store_name                                                                    
able         0.03                0.00                 0.00                      
ation        0.02                0.02                 0.03                      
bar          0.02                0.03                 0.01                      
eing         0.01                0.05                 0.01                      
ese          0.00                0.00                 0.04                      
ought        0.00                0.06                 0.06                      
2022-06-26 11:03:31,961 - main.py[line:408] - INFO: relative error normalized:
              avg(ss_wholesale_cost)  avg(ss_list_price)  avg(ss_sales_price)  \
s_store_name                                                                    
able         0.02                    0.02                0.00                   
ation        0.03                    0.02                0.01                   
bar          0.01                    0.02                0.03                   
eing         0.01                    0.01                0.05                   
ese          0.00                    0.00                0.00                   
ought        0.01                    0.00                0.06                   

              avg(ss_ext_sales_price)  sum(ss_wholesale_cost)  \
s_store_name                                                    
able         0.00                     0.02                      
ation        0.02                     0.03                      
bar          0.00                     0.01                      
eing         0.02                     0.00                      
ese          0.03                     0.00                      
ought        0.06                     0.00                      

              sum(ss_list_price)  sum(ss_sales_price)  sum(ss_ext_sales_price)  
s_store_name                                                                    
able         0.03                0.00                 0.00                      
ation        0.02                0.01                 0.03                      
bar          0.02                0.03                 0.01                      
eing         0.01                0.05                 0.01                      
ese          0.00                0.00                 0.04                      
ought        0.00                0.06                 0.06                      
2022-06-26 11:03:31,961 - main.py[line:411] - INFO: relative error average :0.018849365479255552
2022-06-26 11:03:31,961 - main.py[line:412] - INFO: relative error normalized average :0.018519557429080555
2022-06-26 11:03:31,964 - main.py[line:458] - INFO: total_time:710.2863549180329
label group counts before:{10: 292000, 4: 291886, 8: 291827, 2: 291315, 7: 290625, 1: 290226}
label group counts after:{10: 380034, 4: 379251, 8: 379344, 2: 378569, 7: 378366, 1: 377305}
feature_names: ['ss_store_sk_0', 'ss_store_sk_1', 'ss_store_sk_2', 'ss_store_sk_3']
categorical_columns: ['ss_store_sk_0', 'ss_store_sk_1', 'ss_store_sk_2', 'ss_store_sk_3']
