main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-06-26 11:22:42,434 - main.py[line:438] - INFO: load query config config/query/sales_inc_join_store.json successfully
2022-06-26 11:22:42,434 - main.py[line:445] - INFO: load train config ./config/train/tpcds_ssales_store_inc_torch_cvae.json successfully
2022-06-26 11:22:42,434 - main.py[line:445] - INFO: load train config ./config/train/tpcds_store_torch_cvae.json successfully
2022-06-26 11:22:42,434 - dataset_utils.py[line:543] - INFO: load existing dataset:tpcds-06667g-ssales_store-inc_ss_store_sk_ss_wholesale_cost#ss_list_price#ss_sales_price#ss_ext_sales_price_ss_store_sk_binary_mm_0
2022-06-26 11:22:48,993 - dataset_utils.py[line:197] - INFO: encode incremental data categorical columns time elapsed:0.01939786970615387
2022-06-26 11:22:49,003 - dataset_utils.py[line:214] - INFO: encode incremental data numeric columnstime elapsed:0.010300487279891968
2022-06-26 11:22:49,252 - dataset_utils.py[line:262] - INFO: load incremental data time elapsed:0.9759354405105114
2022-06-26 11:22:49,252 - dataset_utils.py[line:555] - INFO: load dataset time elapsed:6.818177532404661
2022-06-26 11:22:49,253 - pytorch_cvae.py[line:295] - INFO: feature info:[('ss_wholesale_cost', 'numerical', 1), ('ss_list_price', 'numerical', 1), ('ss_sales_price', 'numerical', 1), ('ss_ext_sales_price', 'numerical', 1), ('ss_store_sk', 'categorical', 4)]
2022-06-26 11:22:49,254 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpcds-06667g-ssales_store-inc_ss_store_sk_ld100_id100_bs512_ep150_0_binary_mm
2022-06-26 11:22:49,268 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.01431446522474289
2022-06-26 11:22:49,268 - pytorch_cvae.py[line:306] - INFO: load model time elapsed:6.8342189602553844
2022-06-26 11:22:56,782 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.1 epoch----------------------------
2022-06-26 11:22:56,782 - pytorch_cvae.py[line:176] - INFO: loss:57.96982795745134, numeric_loss:41.43915567174554, categorical_loss:0.09286098070151638, kld_loss:3049.484355001594, epoch_train_time:7.511540997773409
2022-06-26 11:23:03,806 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.2 epoch----------------------------
2022-06-26 11:23:03,806 - pytorch_cvae.py[line:176] - INFO: loss:30.87132052704692, numeric_loss:16.1020641438663, categorical_loss:0.0780048130400246, kld_loss:2467.3395988941193, epoch_train_time:7.02421161159873
2022-06-26 11:23:10,914 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.3 epoch----------------------------
2022-06-26 11:23:10,914 - pytorch_cvae.py[line:176] - INFO: loss:28.552762238308787, numeric_loss:13.113901508972049, categorical_loss:0.07531797228148207, kld_loss:2338.20982336998, epoch_train_time:7.1075097024440765
2022-06-26 11:23:17,940 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.4 epoch----------------------------
2022-06-26 11:23:17,941 - pytorch_cvae.py[line:176] - INFO: loss:29.413122171536088, numeric_loss:13.025423211976886, categorical_loss:0.07371797877567587, kld_loss:2252.2072660923004, epoch_train_time:7.026351161301136
2022-06-26 11:23:25,014 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.5 epoch----------------------------
2022-06-26 11:23:25,014 - pytorch_cvae.py[line:176] - INFO: loss:30.925681225955486, numeric_loss:13.513416139408946, categorical_loss:0.07280484883085592, kld_loss:2173.5746490955353, epoch_train_time:7.073064185678959
2022-06-26 11:23:31,978 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.6 epoch----------------------------
2022-06-26 11:23:31,978 - pytorch_cvae.py[line:176] - INFO: loss:32.56789669394493, numeric_loss:14.08229090180248, categorical_loss:0.0720642136366223, kld_loss:2097.979228258133, epoch_train_time:6.964343197643757
2022-06-26 11:23:39,068 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.7 epoch----------------------------
2022-06-26 11:23:39,068 - pytorch_cvae.py[line:176] - INFO: loss:34.23546436801553, numeric_loss:14.718222844414413, categorical_loss:0.0716249705728842, kld_loss:2015.7875530719757, epoch_train_time:7.089372545480728
2022-06-26 11:23:46,084 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.8 epoch----------------------------
2022-06-26 11:23:46,085 - pytorch_cvae.py[line:176] - INFO: loss:35.998818442225456, numeric_loss:15.391654741950333, categorical_loss:0.07127339809085242, kld_loss:1938.7867426872253, epoch_train_time:7.016301810741425
2022-06-26 11:23:53,066 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.9 epoch----------------------------
2022-06-26 11:23:53,066 - pytorch_cvae.py[line:176] - INFO: loss:37.89050650596619, numeric_loss:16.126849584281445, categorical_loss:0.07100465863913996, kld_loss:1867.0542236566544, epoch_train_time:6.981152214109898
2022-06-26 11:24:00,081 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.10 epoch----------------------------
2022-06-26 11:24:00,081 - pytorch_cvae.py[line:176] - INFO: loss:39.89995440095663, numeric_loss:16.915757354348898, categorical_loss:0.07079989976773504, kld_loss:1799.6821318864822, epoch_train_time:7.014674328267574
2022-06-26 11:24:07,143 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.11 epoch----------------------------
2022-06-26 11:24:07,143 - pytorch_cvae.py[line:176] - INFO: loss:41.97172858938575, numeric_loss:17.786950159817934, categorical_loss:0.0705921646222123, kld_loss:1730.116195678711, epoch_train_time:7.061815481632948
2022-06-26 11:24:14,101 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.12 epoch----------------------------
2022-06-26 11:24:14,101 - pytorch_cvae.py[line:176] - INFO: loss:44.20186127722263, numeric_loss:18.70080585964024, categorical_loss:0.07050214998889714, kld_loss:1668.3574999570847, epoch_train_time:6.958120707422495
2022-06-26 11:24:21,125 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.13 epoch----------------------------
2022-06-26 11:24:21,125 - pytorch_cvae.py[line:176] - INFO: loss:46.532967288047075, numeric_loss:19.70876992866397, categorical_loss:0.07047608299035346, kld_loss:1606.5063730478287, epoch_train_time:7.024020288139582
2022-06-26 11:24:28,194 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.14 epoch----------------------------
2022-06-26 11:24:28,194 - pytorch_cvae.py[line:176] - INFO: loss:48.91354023292661, numeric_loss:20.78567547351122, categorical_loss:0.07047616757336073, kld_loss:1543.6354265213013, epoch_train_time:7.068625424057245
2022-06-26 11:24:35,275 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.15 epoch----------------------------
2022-06-26 11:24:35,275 - pytorch_cvae.py[line:176] - INFO: loss:51.39666521921754, numeric_loss:21.918463423848152, categorical_loss:0.07050155362230726, kld_loss:1483.8571189641953, epoch_train_time:7.080374337732792
2022-06-26 11:24:42,284 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.16 epoch----------------------------
2022-06-26 11:24:42,284 - pytorch_cvae.py[line:176] - INFO: loss:53.96654983609915, numeric_loss:23.13902884349227, categorical_loss:0.0707105398105341, kld_loss:1424.7548251152039, epoch_train_time:7.008631870150566
2022-06-26 11:24:49,316 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.17 epoch----------------------------
2022-06-26 11:24:49,316 - pytorch_cvae.py[line:176] - INFO: loss:56.531711645424366, numeric_loss:24.46280753798783, categorical_loss:0.07103409866249422, kld_loss:1362.1408857107162, epoch_train_time:7.031995486468077
2022-06-26 11:24:56,476 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.18 epoch----------------------------
2022-06-26 11:24:56,476 - pytorch_cvae.py[line:176] - INFO: loss:59.23029925301671, numeric_loss:25.8898763731122, categorical_loss:0.07144681140925968, kld_loss:1302.7971357107162, epoch_train_time:7.159623235464096
2022-06-26 11:25:03,434 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.19 epoch----------------------------
2022-06-26 11:25:03,434 - pytorch_cvae.py[line:176] - INFO: loss:62.04211412370205, numeric_loss:27.412807071581483, categorical_loss:0.07177012381725945, kld_loss:1246.0940700769424, epoch_train_time:6.957683682441711
2022-06-26 11:25:10,442 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.20 epoch----------------------------
2022-06-26 11:25:10,442 - pytorch_cvae.py[line:176] - INFO: loss:64.90882006287575, numeric_loss:29.019849129021168, categorical_loss:0.07195115774811711, kld_loss:1190.426259279251, epoch_train_time:7.0079220943152905
2022-06-26 11:25:10,442 - pytorch_cvae.py[line:185] - INFO: training time elapsed:141.1732678413391
2022-06-26 11:25:10,443 - model_utils.py[line:67] - INFO: save model successfully
2022-06-26 11:25:27,087 - dataset_utils.py[line:562] - INFO: load existing dataset(light):tpcds-06667g-store_s_store_sk#s_store_name__s_store_sk#s_store_name_binary_gaussian5_0
2022-06-26 11:25:27,093 - dataset_utils.py[line:571] - INFO: load dataset(light) time elapsed:0.005835637450218201
2022-06-26 11:25:27,093 - pytorch_cvae.py[line:275] - INFO: feature info:[('s_store_sk', 'categorical', 5), ('s_store_name', 'categorical', 4)]
2022-06-26 11:25:27,095 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpcds-06667g-store_s_store_sk_s_store_name_ld100_id150_bs128_ep100_0_binary_gaussian5
2022-06-26 11:25:27,099 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.004240129142999649
2022-06-26 11:25:27,100 - pytorch_cvae.py[line:285] - INFO: load model time elapsed:0.012933671474456787
2022-06-26 11:25:27,100 - main.py[line:382] - INFO: multi_sampling No.0 epoch
2022-06-26 11:25:27,151 - pytorch_cvae.py[line:398] - INFO: sampling time:0.05097869038581848
2022-06-26 11:25:27,192 - dataset_utils.py[line:543] - INFO: load existing dataset:tpcds-06667g-store_s_store_sk#s_store_name__s_store_sk#s_store_name_binary_gaussian5_0
2022-06-26 11:25:27,194 - dataset_utils.py[line:555] - INFO: load dataset time elapsed:0.002034030854701996
2022-06-26 11:25:27,218 - main.py[line:366] - INFO: sample and aggregation time elapsed:0.11824813112616539
2022-06-26 11:25:27,222 - main.py[line:399] - INFO: sample time:0.12229710444808006
2022-06-26 11:25:27,236 - main.py[line:99] - INFO: aqp result:
              avg(ss_wholesale_cost)  avg(ss_list_price)  avg(ss_sales_price)  \
s_store_name                                                                    
able         50.36                   74.99               36.42                  
ation        51.77                   76.94               37.88                  
bar          49.62                   73.88               36.20                  
eing         51.69                   77.35               39.32                  
ese          51.79                   77.30               38.29                  
ought        51.84                   77.75               38.64                  

              avg(ss_ext_sales_price)  sum(ss_wholesale_cost)  \
s_store_name                                                    
able         1716.55                  19060526.16               
ation        1838.47                  19584906.26               
bar          1594.61                  18854539.34               
eing         1795.03                  19605417.56               
ese          1871.47                  19636210.93               
ought        1850.70                  19555850.31               

              sum(ss_list_price)  sum(ss_sales_price)  sum(ss_ext_sales_price)  
s_store_name                                                                    
able         28384370.23         13785275.73          649707354.31              
ation        29104066.50         14331162.60          695478510.85              
bar          28070028.34         13755980.04          605889434.18              
eing         29336445.22         14914136.20          680799582.72              
ese          29310850.80         14517128.80          709617298.69              
ought        29330542.49         14576878.40          698144192.98              
2022-06-26 11:25:27,240 - main.py[line:100] - INFO: ground truth:
              avg(ss_wholesale_cost)  avg(ss_list_price)  avg(ss_sales_price)  \
s_store_name                                                                    
able         50.64                   76.00               38.03                  
ation        50.51                   75.77               37.86                  
bar          50.45                   75.60               37.86                  
eing         50.48                   75.70               37.88                  
ese          50.43                   75.66               37.81                  
ought        50.51                   75.76               37.85                  

              avg(ss_ext_sales_price)  sum(ss_wholesale_cost)  \
s_store_name                                                    
able         1927.79                   19222153                 
ation        1913.49                   19163879                 
bar          1909.73                   19223866                 
eing         1914.67                   19197418                 
ese          1907.31                   19180565                 
ought        1914.74                   19110523                 

              sum(ss_list_price)  sum(ss_sales_price)  sum(ss_ext_sales_price)  
s_store_name                                                                    
able          28850558            14437728             731785975                
ation         28748144            14363226             726020132                
bar           28805923            14424380             727683698                
eing          28790601            14405583             728157588                
ese           28775371            14380114             725440120                
ought         28664128            14318058             724409110                
2022-06-26 11:25:27,248 - main.py[line:407] - INFO: relative error:
              avg(ss_wholesale_cost)  avg(ss_list_price)  avg(ss_sales_price)  \
s_store_name                                                                    
able         0.01                    0.01                0.04                   
ation        0.03                    0.02                0.00                   
bar          0.02                    0.02                0.04                   
eing         0.02                    0.02                0.04                   
ese          0.03                    0.02                0.01                   
ought        0.03                    0.03                0.02                   

              avg(ss_ext_sales_price)  sum(ss_wholesale_cost)  \
s_store_name                                                    
able         0.11                     0.01                      
ation        0.04                     0.02                      
bar          0.17                     0.02                      
eing         0.06                     0.02                      
ese          0.02                     0.02                      
ought        0.03                     0.02                      

              sum(ss_list_price)  sum(ss_sales_price)  sum(ss_ext_sales_price)  
s_store_name                                                                    
able         0.02                0.05                 0.11                      
ation        0.01                0.00                 0.04                      
bar          0.03                0.05                 0.17                      
eing         0.02                0.04                 0.07                      
ese          0.02                0.01                 0.02                      
ought        0.02                0.02                 0.04                      
2022-06-26 11:25:27,251 - main.py[line:408] - INFO: relative error normalized:
              avg(ss_wholesale_cost)  avg(ss_list_price)  avg(ss_sales_price)  \
s_store_name                                                                    
able         0.01                    0.01                0.04                   
ation        0.02                    0.02                0.00                   
bar          0.02                    0.02                0.04                   
eing         0.02                    0.02                0.04                   
ese          0.03                    0.02                0.01                   
ought        0.03                    0.03                0.02                   

              avg(ss_ext_sales_price)  sum(ss_wholesale_cost)  \
s_store_name                                                    
able         0.10                     0.01                      
ation        0.04                     0.02                      
bar          0.15                     0.02                      
eing         0.06                     0.02                      
ese          0.02                     0.02                      
ought        0.03                     0.02                      

              sum(ss_list_price)  sum(ss_sales_price)  sum(ss_ext_sales_price)  
s_store_name                                                                    
able         0.02                0.04                 0.11                      
ation        0.01                0.00                 0.04                      
bar          0.03                0.05                 0.15                      
eing         0.02                0.03                 0.06                      
ese          0.02                0.01                 0.02                      
ought        0.02                0.02                 0.04                      
2022-06-26 11:25:27,251 - main.py[line:411] - INFO: relative error average :0.034722758470185876
2022-06-26 11:25:27,251 - main.py[line:412] - INFO: relative error normalized average :0.03355475406554704
2022-06-26 11:25:27,253 - main.py[line:458] - INFO: total_time:164.81912426650524
label group counts before:{10: 292000, 4: 291886, 8: 291827, 2: 291315, 7: 290625, 1: 290226}
label group counts after:{10: 380034, 4: 379251, 8: 379344, 2: 378569, 7: 378366, 1: 377305}
feature_names: ['ss_store_sk_0', 'ss_store_sk_1', 'ss_store_sk_2', 'ss_store_sk_3']
categorical_columns: ['ss_store_sk_0', 'ss_store_sk_1', 'ss_store_sk_2', 'ss_store_sk_3']
