main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-06-26 10:22:05,078 - main.py[line:438] - INFO: load query config config/query/sales_inc_join_store.json successfully
2022-06-26 10:22:05,078 - main.py[line:445] - INFO: load train config ./config/train/tpcds_ssales_store_inc_torch_cvae.json successfully
2022-06-26 10:22:05,078 - main.py[line:445] - INFO: load train config ./config/train/tpcds_store_torch_cvae.json successfully
2022-06-26 10:22:05,078 - dataset_utils.py[line:543] - INFO: load existing dataset:tpcds-06667g-ssales_store-inc_ss_store_sk_ss_wholesale_cost#ss_list_price#ss_sales_price#ss_ext_sales_price_ss_store_sk_binary_mm_0
2022-06-26 10:22:09,374 - dataset_utils.py[line:197] - INFO: encode incremental data categorical columns time elapsed:0.019217975437641144
2022-06-26 10:22:09,384 - dataset_utils.py[line:214] - INFO: encode incremental data numeric columnstime elapsed:0.010333627462387085
2022-06-26 10:22:09,621 - dataset_utils.py[line:262] - INFO: load incremental data time elapsed:0.915824756026268
2022-06-26 10:22:09,622 - dataset_utils.py[line:555] - INFO: load dataset time elapsed:4.543557517230511
2022-06-26 10:22:09,622 - pytorch_cvae.py[line:295] - INFO: feature info:[('ss_wholesale_cost', 'numerical', 1), ('ss_list_price', 'numerical', 1), ('ss_sales_price', 'numerical', 1), ('ss_ext_sales_price', 'numerical', 1), ('ss_store_sk', 'categorical', 4)]
2022-06-26 10:22:09,623 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpcds-06667g-ssales_store-inc_ss_store_sk_ld100_id100_bs512_ep150_0_binary_mm
2022-06-26 10:22:09,625 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.001963496208190918
2022-06-26 10:22:09,625 - pytorch_cvae.py[line:306] - INFO: load model time elapsed:4.5469650365412235
2022-06-26 10:22:18,083 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.1 epoch----------------------------
2022-06-26 10:22:18,083 - pytorch_cvae.py[line:176] - INFO: loss:68.61684489995241, numeric_loss:49.736283054575324, categorical_loss:0.10696094566810643, kld_loss:3482.8116915475694, epoch_train_time:8.45684814825654
2022-06-26 10:22:26,202 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.2 epoch----------------------------
2022-06-26 10:22:26,202 - pytorch_cvae.py[line:176] - INFO: loss:34.134582409635186, numeric_loss:17.43676940444857, categorical_loss:0.09159850559080951, kld_loss:2788.950308561325, epoch_train_time:8.118872929364443
2022-06-26 10:22:34,191 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.3 epoch----------------------------
2022-06-26 10:22:34,191 - pytorch_cvae.py[line:176] - INFO: loss:32.39569362811744, numeric_loss:14.590221795253456, categorical_loss:0.08582287963508861, kld_loss:2696.790586709976, epoch_train_time:7.988698773086071
2022-06-26 10:22:42,312 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.4 epoch----------------------------
2022-06-26 10:22:42,312 - pytorch_cvae.py[line:176] - INFO: loss:33.95854118466377, numeric_loss:14.99584577884525, categorical_loss:0.08374838362215087, kld_loss:2606.310607433319, epoch_train_time:8.120596949011087
2022-06-26 10:22:50,346 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.5 epoch----------------------------
2022-06-26 10:22:50,346 - pytorch_cvae.py[line:176] - INFO: loss:35.6589887291193, numeric_loss:15.518365037627518, categorical_loss:0.08243308233068092, kld_loss:2514.379007577896, epoch_train_time:8.034079905599356
2022-06-26 10:22:58,369 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.6 epoch----------------------------
2022-06-26 10:22:58,369 - pytorch_cvae.py[line:176] - INFO: loss:37.52585743740201, numeric_loss:16.16539939120412, categorical_loss:0.08175156389916083, kld_loss:2424.4268164634705, epoch_train_time:8.023006536066532
2022-06-26 10:23:06,532 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.7 epoch----------------------------
2022-06-26 10:23:06,532 - pytorch_cvae.py[line:176] - INFO: loss:39.52614552527666, numeric_loss:16.86536567285657, categorical_loss:0.08128998595202575, kld_loss:2340.6537098884583, epoch_train_time:8.162855952978134
2022-06-26 10:23:14,520 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.8 epoch----------------------------
2022-06-26 10:23:14,520 - pytorch_cvae.py[line:176] - INFO: loss:41.63730029761791, numeric_loss:17.653947916813195, categorical_loss:0.08105503812112147, kld_loss:2256.608141183853, epoch_train_time:7.987385950982571
2022-06-26 10:23:22,612 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.9 epoch----------------------------
2022-06-26 10:23:22,612 - pytorch_cvae.py[line:176] - INFO: loss:43.84790302440524, numeric_loss:18.54148815944791, categorical_loss:0.08103226443199674, kld_loss:2171.111049771309, epoch_train_time:8.091734010726213
2022-06-26 10:23:30,582 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.10 epoch----------------------------
2022-06-26 10:23:30,582 - pytorch_cvae.py[line:176] - INFO: loss:46.07793639972806, numeric_loss:19.45322219096124, categorical_loss:0.08114456295152195, kld_loss:2084.806012272835, epoch_train_time:7.970633205026388
2022-06-26 10:23:38,565 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.11 epoch----------------------------
2022-06-26 10:23:38,565 - pytorch_cvae.py[line:176] - INFO: loss:48.43455087766051, numeric_loss:20.423518700525165, categorical_loss:0.0813596707303077, kld_loss:2003.8652027845383, epoch_train_time:7.982517816126347
2022-06-26 10:23:46,730 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.12 epoch----------------------------
2022-06-26 10:23:46,730 - pytorch_cvae.py[line:176] - INFO: loss:50.993824284523726, numeric_loss:21.462804593145847, categorical_loss:0.08145347281970317, kld_loss:1932.0226361751556, epoch_train_time:8.164388306438923
2022-06-26 10:23:54,769 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.13 epoch----------------------------
2022-06-26 10:23:54,769 - pytorch_cvae.py[line:176] - INFO: loss:53.62654357403517, numeric_loss:22.574429988861084, categorical_loss:0.08171070597018115, kld_loss:1859.709499001503, epoch_train_time:8.038984183222055
2022-06-26 10:24:02,783 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.14 epoch----------------------------
2022-06-26 10:24:02,783 - pytorch_cvae.py[line:176] - INFO: loss:56.42538367211819, numeric_loss:23.798594791442156, categorical_loss:0.0818119807736366, kld_loss:1790.5293997526169, epoch_train_time:8.013985563069582
2022-06-26 10:24:10,793 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.15 epoch----------------------------
2022-06-26 10:24:10,793 - pytorch_cvae.py[line:176] - INFO: loss:59.26587535068393, numeric_loss:25.116224082186818, categorical_loss:0.08202546955726575, kld_loss:1718.9881819486618, epoch_train_time:8.009540777653456
2022-06-26 10:24:18,836 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.16 epoch----------------------------
2022-06-26 10:24:18,836 - pytorch_cvae.py[line:176] - INFO: loss:62.16594471782446, numeric_loss:26.50135536119342, categorical_loss:0.08218553970800713, kld_loss:1648.2919117212296, epoch_train_time:8.043420046567917
2022-06-26 10:24:26,968 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.17 epoch----------------------------
2022-06-26 10:24:26,968 - pytorch_cvae.py[line:176] - INFO: loss:65.30764792114496, numeric_loss:28.0770519990474, categorical_loss:0.0824181609423249, kld_loss:1581.3881299495697, epoch_train_time:8.131280891597271
2022-06-26 10:24:35,071 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.18 epoch----------------------------
2022-06-26 10:24:35,071 - pytorch_cvae.py[line:176] - INFO: loss:68.40973617881536, numeric_loss:29.713021339848638, categorical_loss:0.08256989609071752, kld_loss:1512.1113857030869, epoch_train_time:8.102518372237682
2022-06-26 10:24:43,196 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.19 epoch----------------------------
2022-06-26 10:24:43,196 - pytorch_cvae.py[line:176] - INFO: loss:71.66985340416431, numeric_loss:31.525069896131754, categorical_loss:0.08294626313727349, kld_loss:1444.5710636377335, epoch_train_time:8.125442326068878
2022-06-26 10:24:51,330 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.20 epoch----------------------------
2022-06-26 10:24:51,330 - pytorch_cvae.py[line:176] - INFO: loss:74.99290046095848, numeric_loss:33.42798274382949, categorical_loss:0.08311919390689582, kld_loss:1378.7027101516724, epoch_train_time:8.133707530796528
2022-06-26 10:24:51,330 - pytorch_cvae.py[line:185] - INFO: training time elapsed:161.7050760164857
2022-06-26 10:24:51,332 - model_utils.py[line:67] - INFO: save model successfully
2022-06-26 10:24:55,490 - dataset_utils.py[line:562] - INFO: load existing dataset(light):tpcds-06667g-store_s_store_sk#s_store_name__s_store_sk#s_store_name_binary_gaussian5_0
2022-06-26 10:24:55,491 - dataset_utils.py[line:571] - INFO: load dataset(light) time elapsed:0.0019011162221431732
2022-06-26 10:24:55,492 - pytorch_cvae.py[line:275] - INFO: feature info:[('s_store_sk', 'categorical', 5), ('s_store_name', 'categorical', 4)]
2022-06-26 10:24:55,492 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpcds-06667g-store_s_store_sk_s_store_name_ld100_id150_bs128_ep100_0_binary_gaussian5
2022-06-26 10:24:55,494 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0018081292510032654
2022-06-26 10:24:55,494 - pytorch_cvae.py[line:285] - INFO: load model time elapsed:0.004635367542505264
2022-06-26 10:24:55,494 - main.py[line:382] - INFO: multi_sampling No.0 epoch
2022-06-26 10:24:55,540 - pytorch_cvae.py[line:398] - INFO: sampling time:0.045728109776973724
2022-06-26 10:24:55,693 - dataset_utils.py[line:543] - INFO: load existing dataset:tpcds-06667g-store_s_store_sk#s_store_name__s_store_sk#s_store_name_binary_gaussian5_0
2022-06-26 10:24:55,700 - dataset_utils.py[line:555] - INFO: load dataset time elapsed:0.006863761693239212
2022-06-26 10:24:55,737 - main.py[line:366] - INFO: sample and aggregation time elapsed:0.242390438914299
2022-06-26 10:24:55,740 - main.py[line:399] - INFO: sample time:0.24599190428853035
2022-06-26 10:24:56,685 - main.py[line:99] - INFO: aqp result:
              avg(ss_wholesale_cost)  avg(ss_list_price)  avg(ss_sales_price)  \
s_store_name                                                                    
able         49.91                   74.57               38.53                  
ation        50.12                   74.66               39.70                  
bar          51.58                   78.77               41.44                  
eing         50.44                   76.69               40.88                  
ese          50.76                   75.49               40.30                  
ought        50.52                   75.60               39.02                  

              avg(ss_ext_sales_price)  sum(ss_wholesale_cost)  \
s_store_name                                                    
able         1904.59                  18889831.75               
ation        1916.91                  18961005.70               
bar          1987.23                  19598093.59               
eing         1975.26                  19128496.18               
ese          1936.31                  19246003.81               
ought        1882.74                  19059286.49               

              sum(ss_list_price)  sum(ss_sales_price)  sum(ss_ext_sales_price)  
s_store_name                                                                    
able         28225144.35         14585133.65          720878547.92              
ation        28243166.38         15018519.58          725153602.39              
bar          29931193.05         15744347.11          755070195.27              
eing         29086465.17         15503933.48          749155855.61              
ese          28625216.69         15280044.41          734205986.61              
ought        28518536.87         14718320.63          710230419.18              
2022-06-26 10:24:56,690 - main.py[line:100] - INFO: ground truth:
              avg(ss_wholesale_cost)  avg(ss_list_price)  avg(ss_sales_price)  \
s_store_name                                                                    
able         50.64                   76.00               38.03                  
ation        50.51                   75.77               37.86                  
bar          50.45                   75.60               37.86                  
eing         50.48                   75.70               37.88                  
ese          50.43                   75.66               37.81                  
ought        50.51                   75.76               37.85                  

              avg(ss_ext_sales_price)  sum(ss_wholesale_cost)  \
s_store_name                                                    
able         1927.79                   19222153                 
ation        1913.49                   19163879                 
bar          1909.73                   19223866                 
eing         1914.67                   19197418                 
ese          1907.31                   19180565                 
ought        1914.74                   19110523                 

              sum(ss_list_price)  sum(ss_sales_price)  sum(ss_ext_sales_price)  
s_store_name                                                                    
able          28850558            14437728             731785975                
ation         28748144            14363226             726020132                
bar           28805923            14424380             727683698                
eing          28790601            14405583             728157588                
ese           28775371            14380114             725440120                
ought         28664128            14318058             724409110                
2022-06-26 10:24:56,700 - main.py[line:407] - INFO: relative error:
              avg(ss_wholesale_cost)  avg(ss_list_price)  avg(ss_sales_price)  \
s_store_name                                                                    
able         0.01                    0.02                0.01                   
ation        0.01                    0.01                0.05                   
bar          0.02                    0.04                0.09                   
eing         0.00                    0.01                0.08                   
ese          0.01                    0.00                0.07                   
ought        0.00                    0.00                0.03                   

              avg(ss_ext_sales_price)  sum(ss_wholesale_cost)  \
s_store_name                                                    
able         0.01                     0.02                      
ation        0.00                     0.01                      
bar          0.04                     0.02                      
eing         0.03                     0.00                      
ese          0.02                     0.00                      
ought        0.02                     0.00                      

              sum(ss_list_price)  sum(ss_sales_price)  sum(ss_ext_sales_price)  
s_store_name                                                                    
able         0.02                0.01                 0.01                      
ation        0.02                0.05                 0.00                      
bar          0.04                0.09                 0.04                      
eing         0.01                0.08                 0.03                      
ese          0.01                0.06                 0.01                      
ought        0.01                0.03                 0.02                      
2022-06-26 10:24:56,702 - main.py[line:408] - INFO: relative error normalized:
              avg(ss_wholesale_cost)  avg(ss_list_price)  avg(ss_sales_price)  \
s_store_name                                                                    
able         0.01                    0.02                0.01                   
ation        0.01                    0.01                0.05                   
bar          0.02                    0.04                0.09                   
eing         0.00                    0.01                0.08                   
ese          0.01                    0.00                0.06                   
ought        0.00                    0.00                0.03                   

              avg(ss_ext_sales_price)  sum(ss_wholesale_cost)  \
s_store_name                                                    
able         0.01                     0.02                      
ation        0.00                     0.01                      
bar          0.04                     0.02                      
eing         0.03                     0.00                      
ese          0.02                     0.00                      
ought        0.02                     0.00                      

              sum(ss_list_price)  sum(ss_sales_price)  sum(ss_ext_sales_price)  
s_store_name                                                                    
able         0.02                0.01                 0.01                      
ation        0.02                0.04                 0.00                      
bar          0.04                0.09                 0.04                      
eing         0.01                0.07                 0.03                      
ese          0.01                0.06                 0.01                      
ought        0.01                0.03                 0.02                      
2022-06-26 10:24:56,703 - main.py[line:411] - INFO: relative error average :0.024574793408901858
2022-06-26 10:24:56,703 - main.py[line:412] - INFO: relative error normalized average :0.023993253547249307
2022-06-26 10:24:56,705 - main.py[line:458] - INFO: total_time:171.6274498514831
label group counts before:{10: 292000, 4: 291886, 8: 291827, 2: 291315, 7: 290625, 1: 290226}
label group counts after:{10: 380034, 4: 379251, 8: 379344, 2: 378569, 7: 378366, 1: 377305}
feature_names: ['ss_store_sk_0', 'ss_store_sk_1', 'ss_store_sk_2', 'ss_store_sk_3']
categorical_columns: ['ss_store_sk_0', 'ss_store_sk_1', 'ss_store_sk_2', 'ss_store_sk_3']
