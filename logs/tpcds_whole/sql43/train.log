main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-06-22 08:51:48,923 - main.py[line:642] - INFO: load query config config/tpcds_whole/query/sql43.json successfully
2023-06-22 08:51:48,923 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/77_store_sales.json successfully
2023-06-22 08:51:48,923 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/3_date_dim.json successfully
2023-06-22 08:51:48,923 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/70_store.json successfully
2023-06-22 08:51:48,923 - pytorch_cvae.py[line:249] - INFO: epoch:5
2023-06-22 08:51:48,923 - pytorch_cvae.py[line:250] - INFO: batch size:512
2023-06-22 08:51:48,923 - pytorch_cvae.py[line:251] - INFO: latent dimension:100
2023-06-22 08:51:48,923 - pytorch_cvae.py[line:252] - INFO: intermediate dimension:100
2023-06-22 08:51:48,923 - pytorch_cvae.py[line:253] - INFO: gpu num:0
2023-06-22 08:51:48,923 - dataset_utils.py[line:566] - INFO: load existing dataset:77-store_sales_ss_sold_date_sk#ss_store_sk_ss_ext_sales_price#ss_net_profit#ss_sales_price#ss_quantity_ss_store_sk_binary_gaussian5_0
2023-06-22 08:51:53,720 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:4.7961885769618675
2023-06-22 08:51:53,720 - pytorch_cvae.py[line:258] - INFO: feature info:[('ss_ext_sales_price', 'numerical', 6), ('ss_net_profit', 'numerical', 6), ('ss_sales_price', 'numerical', 6), ('ss_quantity', 'numerical', 6), ('ss_sold_date_sk', 'categorical', 12), ('ss_store_sk', 'categorical', 4)]
2023-06-22 08:52:48,663 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-06-22 08:52:48,663 - pytorch_cvae.py[line:177] - INFO: loss:2637.231196552515, numeric_loss:192.47290788404644, categorical_loss:1130.9570126235485, kld_loss:243731.74318122864, epoch_train_time:54.94096051703673
2023-06-22 08:53:43,637 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.2 epoch----------------------------
2023-06-22 08:53:43,637 - pytorch_cvae.py[line:177] - INFO: loss:1214.28280210495, numeric_loss:90.3814639961347, categorical_loss:98.80355850048363, kld_loss:172161.25737190247, epoch_train_time:54.973629880929366
2023-06-22 08:54:37,974 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.3 epoch----------------------------
2023-06-22 08:54:37,974 - pytorch_cvae.py[line:177] - INFO: loss:1220.2798242866993, numeric_loss:88.51720053795725, categorical_loss:88.76047697570175, kld_loss:158736.68717956543, epoch_train_time:54.337237255997024
2023-06-22 08:55:33,155 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.4 epoch----------------------------
2023-06-22 08:55:33,155 - pytorch_cvae.py[line:177] - INFO: loss:1292.8294847160578, numeric_loss:90.47777179442346, categorical_loss:93.02664074068889, kld_loss:153146.55480575562, epoch_train_time:55.180402659927495
2023-06-22 08:56:28,537 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.5 epoch----------------------------
2023-06-22 08:56:28,538 - pytorch_cvae.py[line:177] - INFO: loss:1383.7636097073555, numeric_loss:95.26567040476948, categorical_loss:100.44931708648801, kld_loss:148926.91825294495, epoch_train_time:55.38221762399189
2023-06-22 08:56:28,538 - pytorch_cvae.py[line:186] - INFO: training time elapsed:274.81615092407446
2023-06-22 08:56:28,540 - model_utils.py[line:67] - INFO: save model successfully
2023-06-22 08:56:50,807 - pytorch_cvae.py[line:268] - INFO: train model time elapsed:301.88366355898324
2023-06-22 08:56:50,807 - dataset_utils.py[line:585] - INFO: load existing dataset(light):3-date_dim_d_date_sk#d_year__d_date_sk#d_year_binary_gaussian5_0
2023-06-22 08:56:50,901 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:0.09366693999618292
2023-06-22 08:56:50,901 - pytorch_cvae.py[line:280] - INFO: feature info:[('d_date_sk', 'categorical', 18), ('d_year', 'categorical', 9)]
2023-06-22 08:56:50,902 - model_utils.py[line:75] - INFO: load model name:torch_cvae_3-date_dim_d_date_sk_d_year_ld100_id150_bs128_ep100_0_binary_gaussian5
2023-06-22 08:56:50,923 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.021480505936779082
2023-06-22 08:56:50,924 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.11632184695918113
2023-06-22 08:56:50,924 - dataset_utils.py[line:585] - INFO: load existing dataset(light):70-store_s_store_sk#s_store_id#s_store_name#s_state#s_county__s_store_sk#s_store_id#s_store_name#s_state#s_county_binary_gaussian5_0
2023-06-22 08:56:50,926 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:0.0024079750292003155
2023-06-22 08:56:50,926 - pytorch_cvae.py[line:280] - INFO: feature info:[('s_store_sk', 'categorical', 5), ('s_store_id', 'categorical', 4), ('s_store_name', 'categorical', 4), ('s_state', 'categorical', 1), ('s_county', 'categorical', 1)]
2023-06-22 08:56:50,927 - model_utils.py[line:75] - INFO: load model name:torch_cvae_70-store_s_store_sk_s_store_id_s_store_name_s_state_s_county_ld100_id150_bs128_ep100_0_binary_gaussian5
2023-06-22 08:56:50,928 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.001629697042517364
2023-06-22 08:56:50,928 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.004892628057859838
2023-06-22 08:56:50,928 - main.py[line:572] - INFO: multi_sampling No.0 epoch
2023-06-22 08:56:51,116 - pytorch_cvae.py[line:407] - INFO: sampling time:0.18714811198879033
2023-06-22 08:56:51,116 - dataset_utils.py[line:566] - INFO: load existing dataset:3-date_dim_d_date_sk#d_year__d_date_sk#d_year_binary_gaussian5_0
2023-06-22 08:56:51,191 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.07467776897829026
2023-06-22 08:56:51,192 - dataset_utils.py[line:566] - INFO: load existing dataset:70-store_s_store_sk#s_store_id#s_store_name#s_state#s_county__s_store_sk#s_store_id#s_store_name#s_state#s_county_binary_gaussian5_0
2023-06-22 08:56:51,194 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.002619353006593883
2023-06-22 08:56:51,238 - main.py[line:555] - INFO: sample and aggregation time elapsed:0.3093418920179829
2023-06-22 08:56:51,244 - main.py[line:593] - INFO: sample time: 0.315336516010575
2023-06-22 08:56:51,258 - main.py[line:104] - INFO: aqp result:
                               avg(ss_sales_price)  sum(ss_sales_price)
s_store_name s_store_id                                                
able         AAAAAAAACAAAAAAA 39.16                15798852.33         
ation        AAAAAAAAHAAAAAAA 38.00                15475761.65         
bar          AAAAAAAAKAAAAAAA 38.81                15738482.91         
eing         AAAAAAAAIAAAAAAA 38.89                15710675.17         
ese          AAAAAAAAEAAAAAAA 38.36                15481642.37         
ought        AAAAAAAABAAAAAAA 38.70                15435178.10         
2023-06-22 08:56:51,261 - main.py[line:105] - INFO: ground truth:
                               avg(ss_sales_price)  sum(ss_sales_price)
s_store_name s_store_id                                                
able         AAAAAAAACAAAAAAA 37.98                 16577800           
ation        AAAAAAAAHAAAAAAA 37.85                 16525562           
bar          AAAAAAAAKAAAAAAA 37.85                 16569398           
eing         AAAAAAAAIAAAAAAA 37.88                 16577836           
ese          AAAAAAAAEAAAAAAA 37.91                 16551923           
ought        AAAAAAAABAAAAAAA 37.91                 16504651           
2023-06-22 08:56:51,268 - main.py[line:611] - INFO: relative error:
                               avg(ss_sales_price)  sum(ss_sales_price)
s_store_name s_store_id                                                
able         AAAAAAAACAAAAAAA 0.03                 0.05                
ation        AAAAAAAAHAAAAAAA 0.00                 0.06                
bar          AAAAAAAAKAAAAAAA 0.03                 0.05                
eing         AAAAAAAAIAAAAAAA 0.03                 0.05                
ese          AAAAAAAAEAAAAAAA 0.01                 0.06                
ought        AAAAAAAABAAAAAAA 0.02                 0.06                
2023-06-22 08:56:51,270 - main.py[line:612] - INFO: relative error normalized:
                               avg(ss_sales_price)
s_store_name s_store_id                           
able         AAAAAAAACAAAAAAA 0.03                
ation        AAAAAAAAHAAAAAAA 0.00                
bar          AAAAAAAAKAAAAAAA 0.03                
eing         AAAAAAAAIAAAAAAA 0.03                
ese          AAAAAAAAEAAAAAAA 0.01                
ought        AAAAAAAABAAAAAAA 0.02                
2023-06-22 08:56:51,270 - main.py[line:615] - INFO: relative error average: 0.03856857996380259
2023-06-22 08:56:51,270 - main.py[line:616] - INFO: relative error normalized average: 0.01982275920909299
2023-06-22 08:56:51,279 - main.py[line:662] - INFO: total_time:302.35614621499553