main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-06-22 09:59:45,834 - main.py[line:642] - INFO: load query config config/tpcds_whole/query/sql43.json successfully
2023-06-22 09:59:45,834 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/77_store_sales.json successfully
2023-06-22 09:59:45,834 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/3_date_dim.json successfully
2023-06-22 09:59:45,834 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/70_store.json successfully
2023-06-22 09:59:45,834 - dataset_utils.py[line:585] - INFO: load existing dataset(light):77-store_sales_ss_sold_date_sk#ss_store_sk_ss_ext_sales_price#ss_net_profit#ss_sales_price#ss_quantity_ss_store_sk_binary_gaussian5_0
2023-06-22 09:59:47,337 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:1.5035416800528765
2023-06-22 09:59:47,338 - pytorch_cvae.py[line:280] - INFO: feature info:[('ss_ext_sales_price', 'numerical', 6), ('ss_net_profit', 'numerical', 6), ('ss_sales_price', 'numerical', 6), ('ss_quantity', 'numerical', 6), ('ss_sold_date_sk', 'categorical', 12), ('ss_store_sk', 'categorical', 4)]
2023-06-22 09:59:47,340 - model_utils.py[line:75] - INFO: load model name:torch_cvae_77-store_sales_ss_store_sk_ld100_id100_bs512_ep5_0_binary_gaussian5
2023-06-22 09:59:49,404 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0637804090511054
2023-06-22 09:59:49,404 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:3.5704671379644424
2023-06-22 09:59:49,404 - dataset_utils.py[line:585] - INFO: load existing dataset(light):3-date_dim_d_date_sk#d_year__d_date_sk#d_year_binary_gaussian5_0
2023-06-22 09:59:49,462 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:0.05744888796471059
2023-06-22 09:59:49,462 - pytorch_cvae.py[line:280] - INFO: feature info:[('d_date_sk', 'categorical', 18), ('d_year', 'categorical', 9)]
2023-06-22 09:59:49,463 - model_utils.py[line:75] - INFO: load model name:torch_cvae_3-date_dim_d_date_sk_d_year_ld100_id150_bs128_ep100_0_binary_gaussian5
2023-06-22 09:59:49,464 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0016214220086112618
2023-06-22 09:59:49,464 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.06007951800711453
2023-06-22 09:59:49,465 - dataset_utils.py[line:585] - INFO: load existing dataset(light):70-store_s_store_sk#s_store_id#s_store_name#s_state#s_county__s_store_sk#s_store_id#s_store_name#s_state#s_county_binary_gaussian5_0
2023-06-22 09:59:49,467 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:0.0022235490614548326
2023-06-22 09:59:49,467 - pytorch_cvae.py[line:280] - INFO: feature info:[('s_store_sk', 'categorical', 5), ('s_store_id', 'categorical', 4), ('s_store_name', 'categorical', 4), ('s_state', 'categorical', 1), ('s_county', 'categorical', 1)]
2023-06-22 09:59:49,467 - model_utils.py[line:75] - INFO: load model name:torch_cvae_70-store_s_store_sk_s_store_id_s_store_name_s_state_s_county_ld100_id150_bs128_ep100_0_binary_gaussian5
2023-06-22 09:59:49,469 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013597389915958047
2023-06-22 09:59:49,469 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.0043179040076211095
2023-06-22 09:59:49,469 - main.py[line:572] - INFO: multi_sampling No.0 epoch
2023-06-22 09:59:49,474 - main.py[line:572] - INFO: multi_sampling No.1 epoch
2023-06-22 09:59:49,474 - main.py[line:572] - INFO: multi_sampling No.2 epoch
2023-06-22 09:59:50,147 - pytorch_cvae.py[line:407] - INFO: sampling time:0.6731841020518914
2023-06-22 09:59:50,148 - dataset_utils.py[line:566] - INFO: load existing dataset:3-date_dim_d_date_sk#d_year__d_date_sk#d_year_binary_gaussian5_0
2023-06-22 09:59:50,329 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.1818383289501071
2023-06-22 09:59:50,331 - dataset_utils.py[line:566] - INFO: load existing dataset:70-store_s_store_sk#s_store_id#s_store_name#s_state#s_county__s_store_sk#s_store_id#s_store_name#s_state#s_county_binary_gaussian5_0
2023-06-22 09:59:50,370 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.038981852936558425
2023-06-22 09:59:50,679 - pytorch_cvae.py[line:407] - INFO: sampling time:1.2029541329247877
2023-06-22 09:59:50,681 - dataset_utils.py[line:566] - INFO: load existing dataset:3-date_dim_d_date_sk#d_year__d_date_sk#d_year_binary_gaussian5_0
2023-06-22 09:59:50,804 - main.py[line:555] - INFO: sample and aggregation time elapsed:1.3301719020819291
2023-06-22 09:59:50,817 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.13547422201372683
2023-06-22 09:59:50,817 - dataset_utils.py[line:566] - INFO: load existing dataset:70-store_s_store_sk#s_store_id#s_store_name#s_state#s_county__s_store_sk#s_store_id#s_store_name#s_state#s_county_binary_gaussian5_0
2023-06-22 09:59:50,821 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.00353911891579628
2023-06-22 09:59:50,843 - pytorch_cvae.py[line:407] - INFO: sampling time:1.3739832270657644
2023-06-22 09:59:50,844 - dataset_utils.py[line:566] - INFO: load existing dataset:3-date_dim_d_date_sk#d_year__d_date_sk#d_year_binary_gaussian5_0
2023-06-22 09:59:50,896 - main.py[line:555] - INFO: sample and aggregation time elapsed:1.4196242580655962
2023-06-22 09:59:50,980 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.13645032001659274
2023-06-22 09:59:50,981 - dataset_utils.py[line:566] - INFO: load existing dataset:70-store_s_store_sk#s_store_id#s_store_name#s_state#s_county__s_store_sk#s_store_id#s_store_name#s_state#s_county_binary_gaussian5_0
2023-06-22 09:59:50,983 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.002631312934681773
2023-06-22 09:59:51,039 - main.py[line:555] - INFO: sample and aggregation time elapsed:1.5701117049902678
2023-06-22 09:59:51,047 - main.py[line:593] - INFO: sample time: 1.5783946570008993
2023-06-22 09:59:51,062 - main.py[line:104] - INFO: aqp result:
                               avg(ss_sales_price)  sum(ss_sales_price)
s_store_name s_store_id                                                
able         AAAAAAAACAAAAAAA 38.51                15491465.90         
ation        AAAAAAAAHAAAAAAA 37.85                15321569.11         
bar          AAAAAAAAKAAAAAAA 38.07                15470610.71         
eing         AAAAAAAAIAAAAAAA 39.00                15657491.01         
ese          AAAAAAAAEAAAAAAA 37.66                15155832.49         
ought        AAAAAAAABAAAAAAA 38.60                15321744.32         
2023-06-22 09:59:51,065 - main.py[line:105] - INFO: ground truth:
                               avg(ss_sales_price)  sum(ss_sales_price)
s_store_name s_store_id                                                
able         AAAAAAAACAAAAAAA 37.98                 16577800           
ation        AAAAAAAAHAAAAAAA 37.85                 16525562           
bar          AAAAAAAAKAAAAAAA 37.85                 16569398           
eing         AAAAAAAAIAAAAAAA 37.88                 16577836           
ese          AAAAAAAAEAAAAAAA 37.91                 16551923           
ought        AAAAAAAABAAAAAAA 37.91                 16504651           
2023-06-22 09:59:51,072 - main.py[line:611] - INFO: relative error:
                               avg(ss_sales_price)  sum(ss_sales_price)
s_store_name s_store_id                                                
able         AAAAAAAACAAAAAAA 0.01                 0.07                
ation        AAAAAAAAHAAAAAAA 0.00                 0.07                
bar          AAAAAAAAKAAAAAAA 0.01                 0.07                
eing         AAAAAAAAIAAAAAAA 0.03                 0.06                
ese          AAAAAAAAEAAAAAAA 0.01                 0.08                
ought        AAAAAAAABAAAAAAA 0.02                 0.07                
2023-06-22 09:59:51,073 - main.py[line:612] - INFO: relative error normalized:
                               avg(ss_sales_price)
s_store_name s_store_id                           
able         AAAAAAAACAAAAAAA 0.01                
ation        AAAAAAAAHAAAAAAA 0.00                
bar          AAAAAAAAKAAAAAAA 0.01                
eing         AAAAAAAAIAAAAAAA 0.03                
ese          AAAAAAAAEAAAAAAA 0.01                
ought        AAAAAAAABAAAAAAA 0.02                
2023-06-22 09:59:51,073 - main.py[line:615] - INFO: relative error average: 0.040881731006183274
2023-06-22 09:59:51,074 - main.py[line:616] - INFO: relative error normalized average: 0.012268691717077562
2023-06-22 09:59:51,081 - main.py[line:662] - INFO: total_time:5.2471428089775145