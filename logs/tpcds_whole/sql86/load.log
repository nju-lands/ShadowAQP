main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-06-11 06:02:33,497 - main.py[line:626] - INFO: load query config config/tpcds_whole/query/sql86.json successfully
2023-06-11 06:02:33,497 - main.py[line:633] - INFO: load train config ./config/tpcds_whole/train/51_web_sales.json successfully
2023-06-11 06:02:33,497 - main.py[line:633] - INFO: load train config ./config/tpcds_whole/train/3_date_dim.json successfully
2023-06-11 06:02:33,497 - main.py[line:633] - INFO: load train config ./config/tpcds_whole/train/86_item.json successfully
2023-06-11 06:02:33,498 - pytorch_cvae.py[line:249] - INFO: epoch:1
2023-06-11 06:02:33,498 - pytorch_cvae.py[line:250] - INFO: batch size:128
2023-06-11 06:02:33,498 - pytorch_cvae.py[line:251] - INFO: latent dimension:100
2023-06-11 06:02:33,498 - pytorch_cvae.py[line:252] - INFO: intermediate dimension:100
2023-06-11 06:02:33,498 - pytorch_cvae.py[line:253] - INFO: gpu num:0
2023-06-11 06:02:33,498 - dataset_utils.py[line:566] - INFO: load existing dataset:51-web_sales_ws_sold_date_sk#ws_item_sk_ws_net_paid#ws_sales_price_ws_item_sk_binary_gaussian5_0
2023-06-11 06:02:36,200 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:2.702668933197856
2023-06-11 06:02:36,200 - pytorch_cvae.py[line:258] - INFO: feature info:[('ws_net_paid', 'numerical', 6), ('ws_sales_price', 'numerical', 6), ('ws_sold_date_sk', 'categorical', 12), ('ws_item_sk', 'categorical', 16)]
2023-06-11 06:03:21,596 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-06-11 06:03:21,596 - pytorch_cvae.py[line:177] - INFO: loss:3234.6569562852383, numeric_loss:132.58334537316114, categorical_loss:1562.2917815502733, kld_loss:285654.8523104191, epoch_train_time:45.39296861505136
2023-06-11 06:03:21,596 - pytorch_cvae.py[line:186] - INFO: training time elapsed:45.39384743431583
2023-06-11 06:03:21,599 - model_utils.py[line:67] - INFO: save model successfully
2023-06-11 06:03:26,110 - pytorch_cvae.py[line:268] - INFO: train model time elapsed:52.611895913258195
2023-06-11 06:03:26,110 - dataset_utils.py[line:585] - INFO: load existing dataset(light):3-date_dim_d_date_sk#d_year__d_date_sk#d_year_binary_gaussian5_0
2023-06-11 06:03:26,196 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:0.08637458737939596
2023-06-11 06:03:26,196 - pytorch_cvae.py[line:280] - INFO: feature info:[('d_date_sk', 'categorical', 18), ('d_year', 'categorical', 9)]
2023-06-11 06:03:26,197 - model_utils.py[line:75] - INFO: load model name:torch_cvae_3-date_dim_d_date_sk_d_year_ld100_id150_bs128_ep100_0_binary_gaussian5
2023-06-11 06:03:26,199 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0021361280232667923
2023-06-11 06:03:26,200 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.08972810208797455
2023-06-11 06:03:26,200 - dataset_utils.py[line:585] - INFO: load existing dataset(light):86-item_i_item_sk#i_category#i_class__i_item_sk#i_category#i_class_binary_gaussian5_0
2023-06-11 06:03:26,215 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:0.015253269113600254
2023-06-11 06:03:26,215 - pytorch_cvae.py[line:280] - INFO: feature info:[('i_item_sk', 'categorical', 16), ('i_category', 'categorical', 5), ('i_class', 'categorical', 8)]
2023-06-11 06:03:26,216 - model_utils.py[line:75] - INFO: load model name:torch_cvae_86-item_i_item_sk_i_category_i_class_ld100_id150_bs128_ep100_0_binary_gaussian5
2023-06-11 06:03:26,218 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0018691751174628735
2023-06-11 06:03:26,218 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.018135993741452694
2023-06-11 06:03:26,218 - main.py[line:559] - INFO: multi_sampling No.0 epoch
2023-06-11 06:03:26,611 - pytorch_cvae.py[line:407] - INFO: sampling time:0.3925397046841681
2023-06-11 06:03:26,611 - dataset_utils.py[line:566] - INFO: load existing dataset:3-date_dim_d_date_sk#d_year__d_date_sk#d_year_binary_gaussian5_0
2023-06-11 06:03:26,684 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.07262104470282793
2023-06-11 06:03:26,684 - dataset_utils.py[line:566] - INFO: load existing dataset:86-item_i_item_sk#i_category#i_class__i_item_sk#i_category#i_class_binary_gaussian5_0
2023-06-11 06:03:26,704 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.01966275693848729
2023-06-11 06:03:26,749 - main.py[line:542] - INFO: sample and aggregation time elapsed:0.5305541851557791
2023-06-11 06:03:26,755 - main.py[line:577] - INFO: sample time: 0.5371040189638734
2023-06-11 06:03:26,771 - main.py[line:104] - INFO: aqp result:
                             avg(ws_net_paid)  sum(ws_net_paid)
i_category  i_class                                            
Books       arts            2240.70           7574209.47       
            business        2422.68           8725693.43       
            computers       2186.36           11265063.34      
            cooking         2194.98           7367513.57       
            entertainments  2065.23           7333395.58       
            fiction         2052.80           9424243.16       
            history         2090.07           7430384.86       
            home repair     2714.82           10280934.90      
            mystery         2458.91           7941428.28       
            parenting       2143.94           7786275.72       
            reference       2278.34           10994377.16      
            romance         2141.31           8656953.27       
            science         2333.75           8518133.99       
            self-help       2248.71           8363760.18       
            sports          2334.91           8515974.13       
            travel          2619.24           10382464.91      
Children    infants         2151.70           33189500.56      
            newborn         2246.60           37948911.56      
            school-uniforms 2473.47           37861971.70      
            toddlers        2251.24           36202012.16      
Electronics audio           2373.51           11245838.56      
            automotive      2355.07           9559168.32       
            camcorders      2136.72           7445192.85       
            cameras         2261.58           9356974.93       
            disk drives     2484.21           9639719.83       
            dvd/vcr players 2330.64           10342409.67      
            karoke          2056.44           9797793.48       
            memory          2490.73           11584383.32      
            monitors        2401.45           11522736.55      
            musical         2661.68           10437320.48      
            personal        2332.83           8717332.27       
            portable        2231.68           6908635.34       
            scanners        2384.18           7320485.29       
            stereo          2301.79           9257316.53       
            televisions     2339.35           11043060.56      
            wireless        2215.38           8503974.70       
Home        accent          2316.58           9407220.94       
            bathroom        2802.44           10742368.83      
            bedding         2026.61           9750689.07       
            blinds/shades   2126.70           8017799.79       
            curtains/drapes 2328.83           9806467.71       
            decor           2431.19           8237175.91       
            flatware        2240.85           8704581.79       
            furniture       2405.78           10086275.39      
            glassware       2279.09           9988563.67       
            kids            1960.18           6080779.71       
            lighting        2549.85           11635967.37      
            mattresses      2211.44           9177779.81       
            paint           2155.99           9899587.19       
            rugs            2223.23           8055126.36       
2023-06-11 06:03:26,775 - main.py[line:105] - INFO: ground truth:
                             avg(ws_net_paid)  sum(ws_net_paid)
i_category  i_class                                            
Books       arts            2306.51            7994364         
            business        2312.86            8990101         
            computers       2302.51            12030632        
            cooking         2341.48            8923372         
            entertainments  2365.67            9408251         
            fiction         2317.57            12164909        
            history         2313.12            12298858        
            home repair     2318.16            11762345        
            mystery         2369.18            8121557         
            parenting       2273.65            9710767         
            reference       2325.60            11655890        
            romance         2254.53            11175701        
            science         2297.81            9145288         
            self-help       2239.22            9268124         
            sports          2316.93            10210697        
            travel          2325.05            10316259        
Children    infants         2317.10            41645180        
            newborn         2286.04            39475411        
            school-uniforms 2314.82            40831145        
            toddlers        2276.79            40916187        
Electronics audio           2294.45            9583931         
            automotive      2328.63            8848780         
            camcorders      2202.14            9050805         
            cameras         2313.15            9539443         
            disk drives     2190.67            9910591         
            dvd/vcr players 2255.92            12635428        
            karoke          2314.16            12538092        
            memory          2311.64            10954849        
            monitors        2309.23            11294421        
            musical         2352.79            9844085         
            personal        2329.76            9610272         
            portable        2358.09            8890011         
            scanners        2291.59            9461971         
            stereo          2249.11            11488466        
            televisions     2203.80            10404125        
            wireless        2228.66            10133727        
Home        accent          2281.37            9627379         
            bathroom        2294.85            8936159         
            bedding         2225.40            12166245        
            blinds/shades   2317.32            8490677         
            curtains/drapes 2341.96            11665322        
            decor           2323.14            9348297         
            flatware        2350.98            10950867        
            furniture       2194.57            9658305         
            glassware       2250.98            12589747        
            kids            2251.41            8607158         
            lighting        2277.18            9921687         
            mattresses      2285.81            10395856        
            paint           2319.13            11173589        
            rugs            2290.48            8729034         
2023-06-11 06:03:26,784 - main.py[line:595] - INFO: relative error:
                             avg(ws_net_paid)  sum(ws_net_paid)
i_category  i_class                                            
Books       arts            0.03              0.05             
            business        0.05              0.03             
            computers       0.05              0.06             
            cooking         0.06              0.17             
            entertainments  0.13              0.22             
            fiction         0.11              0.23             
            history         0.10              0.40             
            home repair     0.17              0.13             
            mystery         0.04              0.02             
            parenting       0.06              0.20             
            reference       0.02              0.06             
            romance         0.05              0.23             
            science         0.02              0.07             
            self-help       0.00              0.10             
            sports          0.01              0.17             
            travel          0.13              0.01             
Children    infants         0.07              0.20             
            newborn         0.02              0.04             
            school-uniforms 0.07              0.07             
            toddlers        0.01              0.12             
Electronics audio           0.03              0.17             
            automotive      0.01              0.08             
            camcorders      0.03              0.18             
            cameras         0.02              0.02             
            disk drives     0.13              0.03             
            dvd/vcr players 0.03              0.18             
            karoke          0.11              0.22             
            memory          0.08              0.06             
            monitors        0.04              0.02             
            musical         0.13              0.06             
            personal        0.00              0.09             
            portable        0.05              0.22             
            scanners        0.04              0.23             
            stereo          0.02              0.19             
            televisions     0.06              0.06             
            wireless        0.01              0.16             
Home        accent          0.02              0.02             
            bathroom        0.22              0.20             
            bedding         0.09              0.20             
            blinds/shades   0.08              0.06             
            curtains/drapes 0.01              0.16             
            decor           0.05              0.12             
            flatware        0.05              0.21             
            furniture       0.10              0.04             
            glassware       0.01              0.21             
            kids            0.13              0.29             
            lighting        0.12              0.17             
            mattresses      0.03              0.12             
            paint           0.07              0.11             
            rugs            0.03              0.08             
2023-06-11 06:03:26,785 - main.py[line:596] - INFO: relative error normalized:
                             avg(ws_net_paid)
i_category  i_class                          
Books       arts            0.03             
            business        0.05             
            computers       0.05             
            cooking         0.06             
            entertainments  0.12             
            fiction         0.11             
            history         0.09             
            home repair     0.16             
            mystery         0.04             
            parenting       0.06             
            reference       0.02             
            romance         0.05             
            science         0.02             
            self-help       0.00             
            sports          0.01             
            travel          0.12             
Children    infants         0.07             
            newborn         0.02             
            school-uniforms 0.07             
            toddlers        0.01             
Electronics audio           0.03             
            automotive      0.01             
            camcorders      0.03             
            cameras         0.02             
            disk drives     0.13             
            dvd/vcr players 0.03             
            karoke          0.11             
            memory          0.07             
            monitors        0.04             
            musical         0.12             
            personal        0.00             
            portable        0.05             
            scanners        0.04             
            stereo          0.02             
            televisions     0.06             
            wireless        0.01             
Home        accent          0.02             
            bathroom        0.20             
            bedding         0.09             
            blinds/shades   0.08             
            curtains/drapes 0.01             
            decor           0.05             
            flatware        0.05             
            furniture       0.09             
            glassware       0.01             
            kids            0.12             
            lighting        0.11             
            mattresses      0.03             
            paint           0.07             
            rugs            0.03             
2023-06-11 06:03:26,786 - main.py[line:599] - INFO: relative error average: 0.0912283450301803
2023-06-11 06:03:26,786 - main.py[line:600] - INFO: relative error normalized average: 0.05613610345924273
2023-06-11 06:03:26,792 - main.py[line:646] - INFO: total_time:53.295290877111256