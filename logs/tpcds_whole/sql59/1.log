main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-06-07 07:41:27,803 - main.py[line:618] - INFO: load query config config/tpcds_whole/query/sql59.json successfully
2023-06-07 07:41:27,803 - main.py[line:625] - INFO: load train config ./config/tpcds_whole/train/59_store_sales.json successfully
2023-06-07 07:41:27,803 - main.py[line:625] - INFO: load train config ./config/tpcds_whole/train/59_date_dim.json successfully
2023-06-07 07:41:27,803 - pytorch_cvae.py[line:249] - INFO: epoch:1
2023-06-07 07:41:27,803 - pytorch_cvae.py[line:250] - INFO: batch size:128
2023-06-07 07:41:27,803 - pytorch_cvae.py[line:251] - INFO: latent dimension:100
2023-06-07 07:41:27,803 - pytorch_cvae.py[line:252] - INFO: intermediate dimension:100
2023-06-07 07:41:27,803 - pytorch_cvae.py[line:253] - INFO: gpu num:0
2023-06-07 07:41:27,812 - dataset_utils.py[line:310] - INFO: loading data:/home/lihan/train_dataset/tpcds_whole_1G/store_sales.csv
2023-06-07 07:42:58,578 - dataset_utils.py[line:335] - INFO: data total rows:2628791
2023-06-07 07:42:58,578 - dataset_utils.py[line:367] - INFO: sample the training data sample rows:2628791
2023-06-07 07:42:58,578 - dataset_utils.py[line:371] - INFO: load data time elapsed:90.76644399715587
2023-06-07 07:42:59,997 - dataset_utils.py[line:43] - INFO: encode categorical columns time elapsed:1.417725462000817
/root/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/mixture/base.py:273: ConvergenceWarning: Initialization 1 did not converge. Try different init parameters, or increase max_iter, tol or check for degenerate data.
  % (init + 1), ConvergenceWarning)
2023-06-07 07:45:24,219 - dataset_utils.py[line:56] - INFO: encode numeric columnstime elapsed:144.2213576710783
2023-06-07 07:45:24,724 - dataset_utils.py[line:107] - INFO: data shape:(2628791, 22)
2023-06-07 07:45:24,724 - dataset_utils.py[line:136] - INFO: feature info:[('ss_sales_price', 'numerical', 6), ('ss_sold_date_sk', 'categorical', 12), ('ss_store_sk', 'categorical', 4)]
2023-06-07 07:45:24,724 - dataset_utils.py[line:137] - INFO: output info list:[(1, 'no'), (5, 'softmax'), (12, 'sigmoid'), (4, 'sigmoid')]
2023-06-07 07:45:26,934 - dataset_utils.py[line:140] - INFO: load data successfully
2023-06-07 07:45:26,935 - pytorch_cvae.py[line:258] - INFO: feature info:[('ss_sales_price', 'numerical', 6), ('ss_sold_date_sk', 'categorical', 12), ('ss_store_sk', 'categorical', 4)]
2023-06-07 07:48:01,834 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-06-07 07:48:01,834 - pytorch_cvae.py[line:177] - INFO: loss:3416.5970651358366, numeric_loss:131.75016028434038, categorical_loss:892.6928034747252, kld_loss:443783.9266371727, epoch_train_time:154.89654691657051
2023-06-07 07:48:01,834 - pytorch_cvae.py[line:186] - INFO: training time elapsed:154.8973973770626
2023-06-07 07:48:01,837 - model_utils.py[line:67] - INFO: save model successfully
2023-06-07 07:48:07,223 - pytorch_cvae.py[line:268] - INFO: train model time elapsed:399.4199696648866
2023-06-07 07:48:07,519 - pytorch_cvae.py[line:249] - INFO: epoch:1
2023-06-07 07:48:07,520 - pytorch_cvae.py[line:250] - INFO: batch size:128
2023-06-07 07:48:07,520 - pytorch_cvae.py[line:251] - INFO: latent dimension:100
2023-06-07 07:48:07,520 - pytorch_cvae.py[line:252] - INFO: intermediate dimension:150
2023-06-07 07:48:07,520 - pytorch_cvae.py[line:253] - INFO: gpu num:0
2023-06-07 07:48:07,520 - dataset_utils.py[line:310] - INFO: loading data:/home/lihan/train_dataset/tpcds_whole_1G/date_dim_new.csv
2023-06-07 07:48:10,166 - dataset_utils.py[line:335] - INFO: data total rows:73049
2023-06-07 07:48:10,166 - dataset_utils.py[line:371] - INFO: load data time elapsed:2.646395592018962
2023-06-07 07:48:11,289 - dataset_utils.py[line:43] - INFO: encode categorical columns time elapsed:1.120327333919704
2023-06-07 07:48:11,289 - dataset_utils.py[line:56] - INFO: encode numeric columnstime elapsed:1.0961666703224182e-06
2023-06-07 07:48:11,289 - dataset_utils.py[line:107] - INFO: data shape:(73049, 33)
2023-06-07 07:48:11,289 - dataset_utils.py[line:136] - INFO: feature info:[('d_date_sk', 'categorical', 18), ('d_week_seq', 'categorical', 15)]
2023-06-07 07:48:11,289 - dataset_utils.py[line:137] - INFO: output info list:[(18, 'sigmoid'), (15, 'sigmoid')]
2023-06-07 07:48:11,294 - dataset_utils.py[line:140] - INFO: load data successfully
2023-06-07 07:48:11,294 - pytorch_cvae.py[line:258] - INFO: feature info:[('d_date_sk', 'categorical', 18), ('d_week_seq', 'categorical', 15)]
2023-06-07 07:48:14,952 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-06-07 07:48:14,953 - pytorch_cvae.py[line:177] - INFO: loss:600.8416331410408, numeric_loss:0.0, categorical_loss:568.7977950870991, kld_loss:5944.6590876579285, epoch_train_time:3.656748545356095
2023-06-07 07:48:14,953 - pytorch_cvae.py[line:186] - INFO: training time elapsed:3.6572046759538352
2023-06-07 07:48:14,955 - model_utils.py[line:67] - INFO: save model successfully
2023-06-07 07:48:15,214 - pytorch_cvae.py[line:268] - INFO: train model time elapsed:7.694654961116612
2023-06-07 07:48:15,214 - main.py[line:551] - INFO: multi_sampling No.0 epoch
2023-06-07 07:48:26,315 - pytorch_cvae.py[line:407] - INFO: sampling time:11.070924929808825
2023-06-07 07:48:26,315 - dataset_utils.py[line:565] - INFO: load existing dataset:59-date_dim_d_date_sk#d_week_seq__d_date_sk#d_week_seq_binary_gaussian5_0
2023-06-07 07:48:26,392 - dataset_utils.py[line:577] - INFO: load dataset time elapsed:0.076748076826334
2023-06-07 07:48:26,456 - main.py[line:534] - INFO: sample and aggregation time elapsed:11.241217198316008
2023-06-07 07:48:26,464 - main.py[line:569] - INFO: sample time: 11.249724674969912
2023-06-07 07:48:26,479 - main.py[line:103] - INFO: aqp result:
                        avg(ss_sales_price)  sum(ss_sales_price)
d_week_seq ss_store_sk                                          
5114       1.00        34.80                12562.51            
           2.00        25.96                11147.60            
           4.00        30.25                10648.94            
           7.00        23.29                6876.86             
           8.00        37.33                16506.54            
           10.00       25.94                8746.78             
5115       1.00        30.65                15119.38            
           2.00        33.07                28451.01            
           4.00        32.18                28208.56            
           7.00        22.91                20542.99            
           8.00        34.87                26050.06            
           10.00       32.67                20234.44            
5116       1.00        40.28                14242.27            
           2.00        35.50                31292.36            
           4.00        27.31                22546.19            
           7.00        24.38                22010.20            
           8.00        38.66                31467.18            
           10.00       33.97                23700.86            
5117       1.00        36.24                20395.76            
           2.00        35.69                35042.85            
           4.00        28.00                23196.92            
           7.00        30.57                33965.10            
           8.00        27.18                21739.91            
           10.00       31.33                26873.79            
5118       1.00        30.79                22079.62            
           2.00        36.14                33449.39            
           4.00        30.31                20159.56            
           7.00        32.24                35171.48            
           8.00        32.02                26722.31            
           10.00       37.68                17590.66            
5119       1.00        25.24                16649.63            
           2.00        33.77                40532.11            
           4.00        38.58                29910.87            
           7.00        27.76                22127.76            
           8.00        32.34                32994.21            
           10.00       24.79                13470.64            
5120       1.00        24.50                14686.85            
           2.00        33.13                44119.26            
           4.00        28.62                29375.50            
           7.00        27.75                21190.89            
           8.00        30.90                32982.16            
           10.00       29.55                26386.45            
5121       1.00        33.70                20608.62            
           2.00        30.07                32505.06            
           4.00        26.75                24286.22            
           7.00        34.39                28821.25            
           8.00        30.06                37360.42            
           10.00       30.85                17095.56            
5122       1.00        24.85                21003.73            
           2.00        33.68                25135.70            
2023-06-07 07:48:26,482 - main.py[line:104] - INFO: ground truth:
                        avg(ss_sales_price)  sum(ss_sales_price)
d_week_seq ss_store_sk                                          
5114       1           34.93                 19528              
           2           37.56                 20243              
           4           36.55                 21818              
           7           37.73                 25658              
           8           38.29                 23168              
           10          37.37                 22611              
5115       1           37.30                 37118              
           2           37.10                 38327              
           4           36.77                 37840              
           7           38.82                 38081              
           8           36.40                 32064              
           10          38.78                 37659              
5116       1           36.84                 34229              
           2           39.94                 32712              
           4           38.42                 41801              
           7           36.57                 30352              
           8           37.28                 35898              
           10          37.06                 39842              
5117       1           39.54                 44087              
           2           38.99                 35288              
           4           36.45                 39842              
           7           37.23                 35819              
           8           35.92                 34085              
           10          37.89                 32620              
5118       1           38.36                 36749              
           2           38.57                 36798              
           4           40.31                 31360              
           7           37.42                 38996              
           8           38.92                 39894              
           10          38.76                 37133              
5119       1           37.97                 40357              
           2           38.45                 39951              
           4           38.53                 37916              
           7           36.00                 31247              
           8           39.47                 35047              
           10          37.57                 36217              
5120       1           37.44                 32494              
           2           36.85                 37841              
           4           38.75                 41156              
           7           38.10                 34369              
           8           37.33                 37222              
           10          38.56                 42375              
5121       1           38.48                 33632              
           2           36.94                 33802              
           4           38.15                 38191              
           7           39.71                 39394              
           8           37.64                 38954              
           10          36.02                 29355              
5122       1           39.15                 33164              
           2           35.62                 25646              
2023-06-07 07:48:26,491 - main.py[line:587] - INFO: relative error:
                        avg(ss_sales_price)  sum(ss_sales_price)
d_week_seq ss_store_sk                                          
5114       1           0.00                 0.36                
           2           0.31                 0.45                
           4           0.17                 0.51                
           7           0.38                 0.73                
           8           0.03                 0.29                
           10          0.31                 0.61                
5115       1           0.18                 0.59                
           2           0.11                 0.26                
           4           0.13                 0.25                
           7           0.41                 0.46                
           8           0.04                 0.19                
           10          0.16                 0.46                
5116       1           0.09                 0.58                
           2           0.11                 0.04                
           4           0.29                 0.46                
           7           0.33                 0.27                
           8           0.04                 0.12                
           10          0.08                 0.41                
5117       1           0.08                 0.54                
           2           0.08                 0.01                
           4           0.23                 0.42                
           7           0.18                 0.05                
           8           0.24                 0.36                
           10          0.17                 0.18                
5118       1           0.20                 0.40                
           2           0.06                 0.09                
           4           0.25                 0.36                
           7           0.14                 0.10                
           8           0.18                 0.33                
           10          0.03                 0.53                
5119       1           0.34                 0.59                
           2           0.12                 0.01                
           4           0.00                 0.21                
           7           0.23                 0.29                
           8           0.18                 0.06                
           10          0.34                 0.63                
5120       1           0.35                 0.55                
           2           0.10                 0.17                
           4           0.26                 0.29                
           7           0.27                 0.38                
           8           0.17                 0.11                
           10          0.23                 0.38                
5121       1           0.12                 0.39                
           2           0.19                 0.04                
           4           0.30                 0.36                
           7           0.13                 0.27                
           8           0.20                 0.04                
           10          0.14                 0.42                
5122       1           0.37                 0.37                
           2           0.05                 0.02                
2023-06-07 07:48:26,493 - main.py[line:588] - INFO: relative error normalized:
                        avg(ss_sales_price)  sum(ss_sales_price)
d_week_seq ss_store_sk                                          
5114       1           0.00                 0.30                
           2           0.27                 0.36                
           4           0.16                 0.40                
           7           0.32                 0.52                
           8           0.02                 0.25                
           10          0.26                 0.46                
5115       1           0.16                 0.45                
           2           0.10                 0.23                
           4           0.12                 0.22                
           7           0.34                 0.37                
           8           0.04                 0.17                
           10          0.15                 0.37                
5116       1           0.09                 0.44                
           2           0.11                 0.04                
           4           0.25                 0.37                
           7           0.28                 0.24                
           8           0.04                 0.12                
           10          0.08                 0.33                
5117       1           0.08                 0.42                
           2           0.08                 0.01                
           4           0.21                 0.34                
           7           0.16                 0.05                
           8           0.22                 0.30                
           10          0.16                 0.16                
5118       1           0.18                 0.33                
           2           0.06                 0.09                
           4           0.22                 0.30                
           7           0.13                 0.09                
           8           0.16                 0.28                
           10          0.03                 0.41                
5119       1           0.28                 0.44                
           2           0.11                 0.01                
           4           0.00                 0.19                
           7           0.20                 0.25                
           8           0.17                 0.06                
           10          0.29                 0.47                
5120       1           0.29                 0.42                
           2           0.10                 0.15                
           4           0.23                 0.25                
           7           0.24                 0.32                
           8           0.16                 0.11                
           10          0.21                 0.31                
5121       1           0.12                 0.32                
           2           0.17                 0.04                
           4           0.26                 0.31                
           7           0.13                 0.24                
           8           0.18                 0.04                
           10          0.13                 0.34                
5122       1           0.31                 0.31                
           2           0.05                 0.02                
2023-06-07 07:48:26,493 - main.py[line:591] - INFO: relative error average: 0.24431257910289245
2023-06-07 07:48:26,493 - main.py[line:592] - INFO: relative error normalized average: 0.206174734864324
2023-06-07 07:48:26,542 - main.py[line:638] - INFO: total_time:418.73913487419486
feature_names: ['ss_sold_date_sk_0', 'ss_sold_date_sk_1', 'ss_sold_date_sk_2', 'ss_sold_date_sk_3', 'ss_sold_date_sk_4', 'ss_sold_date_sk_5', 'ss_sold_date_sk_6', 'ss_sold_date_sk_7', 'ss_sold_date_sk_8', 'ss_sold_date_sk_9', 'ss_sold_date_sk_10', 'ss_sold_date_sk_11', 'ss_store_sk_0', 'ss_store_sk_1', 'ss_store_sk_2', 'ss_store_sk_3']
feature_names: ['ss_sold_date_sk-ss_store_sk_0', 'ss_sold_date_sk-ss_store_sk_1', 'ss_sold_date_sk-ss_store_sk_2', 'ss_sold_date_sk-ss_store_sk_3', 'ss_sold_date_sk-ss_store_sk_4', 'ss_sold_date_sk-ss_store_sk_5', 'ss_sold_date_sk-ss_store_sk_6', 'ss_sold_date_sk-ss_store_sk_7', 'ss_sold_date_sk-ss_store_sk_8', 'ss_sold_date_sk-ss_store_sk_9', 'ss_sold_date_sk-ss_store_sk_10', 'ss_sold_date_sk-ss_store_sk_11', 'ss_sold_date_sk-ss_store_sk_12', 'ss_sold_date_sk-ss_store_sk_13', 'ss_sold_date_sk-ss_store_sk_14']
feature_names: ['d_date_sk_0', 'd_date_sk_1', 'd_date_sk_2', 'd_date_sk_3', 'd_date_sk_4', 'd_date_sk_5', 'd_date_sk_6', 'd_date_sk_7', 'd_date_sk_8', 'd_date_sk_9', 'd_date_sk_10', 'd_date_sk_11', 'd_date_sk_12', 'd_date_sk_13', 'd_date_sk_14', 'd_date_sk_15', 'd_date_sk_16', 'd_date_sk_17', 'd_week_seq_0', 'd_week_seq_1', 'd_week_seq_2', 'd_week_seq_3', 'd_week_seq_4', 'd_week_seq_5', 'd_week_seq_6', 'd_week_seq_7', 'd_week_seq_8', 'd_week_seq_9', 'd_week_seq_10', 'd_week_seq_11', 'd_week_seq_12', 'd_week_seq_13', 'd_week_seq_14']
feature_names: ['d_date_sk-d_week_seq_0', 'd_date_sk-d_week_seq_1', 'd_date_sk-d_week_seq_2', 'd_date_sk-d_week_seq_3', 'd_date_sk-d_week_seq_4', 'd_date_sk-d_week_seq_5', 'd_date_sk-d_week_seq_6', 'd_date_sk-d_week_seq_7', 'd_date_sk-d_week_seq_8', 'd_date_sk-d_week_seq_9', 'd_date_sk-d_week_seq_10', 'd_date_sk-d_week_seq_11', 'd_date_sk-d_week_seq_12', 'd_date_sk-d_week_seq_13', 'd_date_sk-d_week_seq_14', 'd_date_sk-d_week_seq_15', 'd_date_sk-d_week_seq_16', 'd_date_sk-d_week_seq_17']
