main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-06-07 12:52:21,220 - main.py[line:618] - INFO: load query config config/tpcds_whole/query/sql59.json successfully
2023-06-07 12:52:21,220 - main.py[line:625] - INFO: load train config ./config/tpcds_whole/train/59_store_sales.json successfully
2023-06-07 12:52:21,220 - main.py[line:625] - INFO: load train config ./config/tpcds_whole/train/59_date_dim.json successfully
2023-06-07 12:52:21,220 - dataset_utils.py[line:584] - INFO: load existing dataset(light):59-store_sales_ss_sold_date_sk#ss_store_sk_ss_sales_price_ss_sold_date_sk#ss_store_sk_binary_gaussian5_0
2023-06-07 12:52:22,252 - dataset_utils.py[line:593] - INFO: load dataset(light) time elapsed:1.031216312199831
2023-06-07 12:52:22,252 - pytorch_cvae.py[line:280] - INFO: feature info:[('ss_sales_price', 'numerical', 6), ('ss_sold_date_sk', 'categorical', 12), ('ss_store_sk', 'categorical', 4)]
2023-06-07 12:52:22,253 - model_utils.py[line:75] - INFO: load model name:torch_cvae_59-store_sales_ss_sold_date_sk_ss_store_sk_ld100_id100_bs128_ep100_0_binary_gaussian5
2023-06-07 12:52:24,295 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0420808168128133
2023-06-07 12:52:24,295 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:3.0747930612415075
2023-06-07 12:52:24,295 - dataset_utils.py[line:584] - INFO: load existing dataset(light):59-date_dim_d_date_sk#d_week_seq__d_date_sk#d_week_seq_binary_gaussian5_0
2023-06-07 12:52:24,356 - dataset_utils.py[line:593] - INFO: load dataset(light) time elapsed:0.06048623565584421
2023-06-07 12:52:24,356 - pytorch_cvae.py[line:280] - INFO: feature info:[('d_date_sk', 'categorical', 18), ('d_week_seq', 'categorical', 15)]
2023-06-07 12:52:24,357 - model_utils.py[line:75] - INFO: load model name:torch_cvae_59-date_dim_d_date_sk_d_week_seq_ld100_id150_bs128_ep100_0_binary_gaussian5
2023-06-07 12:52:24,358 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0017315167933702469
2023-06-07 12:52:24,358 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.06319510564208031
2023-06-07 12:52:24,358 - main.py[line:551] - INFO: multi_sampling No.0 epoch
2023-06-07 12:52:24,364 - main.py[line:551] - INFO: multi_sampling No.1 epoch
2023-06-07 12:52:24,384 - main.py[line:551] - INFO: multi_sampling No.2 epoch
2023-06-07 12:53:45,775 - pytorch_cvae.py[line:407] - INFO: sampling time:81.29988415911794
2023-06-07 12:53:45,775 - dataset_utils.py[line:565] - INFO: load existing dataset:59-date_dim_d_date_sk#d_week_seq__d_date_sk#d_week_seq_binary_gaussian5_0
2023-06-07 12:53:45,863 - dataset_utils.py[line:577] - INFO: load dataset time elapsed:0.08786126505583525
2023-06-07 12:53:46,778 - main.py[line:534] - INFO: sample and aggregation time elapsed:82.38365422608331
2023-06-07 12:53:50,568 - pytorch_cvae.py[line:407] - INFO: sampling time:86.10044437739998
2023-06-07 12:53:50,569 - dataset_utils.py[line:565] - INFO: load existing dataset:59-date_dim_d_date_sk#d_week_seq__d_date_sk#d_week_seq_binary_gaussian5_0
2023-06-07 12:53:50,569 - pytorch_cvae.py[line:407] - INFO: sampling time:86.11508960882202
2023-06-07 12:53:50,570 - dataset_utils.py[line:565] - INFO: load existing dataset:59-date_dim_d_date_sk#d_week_seq__d_date_sk#d_week_seq_binary_gaussian5_0
2023-06-07 12:53:50,668 - dataset_utils.py[line:577] - INFO: load dataset time elapsed:0.09814046090468764
2023-06-07 12:53:50,739 - main.py[line:534] - INFO: sample and aggregation time elapsed:86.37018195912242
2023-06-07 12:53:50,812 - dataset_utils.py[line:577] - INFO: load dataset time elapsed:0.2429726650007069
2023-06-07 12:53:50,857 - main.py[line:534] - INFO: sample and aggregation time elapsed:86.49866071902215
2023-06-07 12:53:50,870 - main.py[line:569] - INFO: sample time: 86.51134639792144
2023-06-07 12:53:50,886 - main.py[line:103] - INFO: aqp result:
                        avg(ss_sales_price)  sum(ss_sales_price)
d_week_seq ss_store_sk                                          
5114       1.00        36.25                19996.61            
           2.00        38.13                20169.76            
           4.00        38.93                24877.39            
           7.00        34.37                25444.48            
           8.00        35.74                19135.94            
           10.00       38.19                24045.87            
5115       1.00        36.80                34918.35            
           2.00        38.58                37577.39            
           4.00        34.55                30655.23            
           7.00        38.87                33579.65            
           8.00        36.49                30141.58            
           10.00       40.35                34133.70            
5116       1.00        36.43                32567.90            
           2.00        39.45                34596.37            
           4.00        35.69                43225.59            
           7.00        38.25                33638.66            
           8.00        35.23                38068.96            
           10.00       35.19                35950.82            
5117       1.00        39.76                44740.25            
           2.00        39.18                42698.26            
           4.00        36.26                44449.81            
           7.00        36.99                40597.06            
           8.00        37.60                37396.15            
           10.00       40.93                37046.55            
5118       1.00        39.65                36300.17            
           2.00        35.65                37010.88            
           4.00        37.54                22624.12            
           7.00        38.17                34234.07            
           8.00        33.91                36466.53            
           10.00       40.76                38059.40            
5119       1.00        40.90                43803.31            
           2.00        42.69                34924.91            
           4.00        35.68                32210.59            
           7.00        39.77                36036.93            
           8.00        42.79                37146.54            
           10.00       37.72                35710.91            
5120       1.00        36.50                30122.71            
           2.00        36.15                44794.29            
           4.00        34.31                39096.92            
           7.00        39.30                28092.73            
           8.00        37.68                36697.74            
           10.00       36.55                36888.85            
5121       1.00        37.19                38205.21            
           2.00        38.21                40892.75            
           4.00        41.08                44100.23            
           7.00        43.11                54761.12            
           8.00        36.51                45296.73            
           10.00       35.38                35372.52            
5122       1.00        38.46                25377.91            
           2.00        37.13                23195.45            
2023-06-07 12:53:50,888 - main.py[line:104] - INFO: ground truth:
                        avg(ss_sales_price)  sum(ss_sales_price)
d_week_seq ss_store_sk                                          
5114       1           34.93                 19528              
           2           37.56                 20243              
           4           36.55                 21818              
           7           37.73                 25658              
           8           38.29                 23168              
           10          37.37                 22611              
5115       1           37.30                 37118              
           2           37.10                 38327              
           4           36.77                 37840              
           7           38.82                 38081              
           8           36.40                 32064              
           10          38.78                 37659              
5116       1           36.84                 34229              
           2           39.94                 32712              
           4           38.42                 41801              
           7           36.57                 30352              
           8           37.28                 35898              
           10          37.06                 39842              
5117       1           39.54                 44087              
           2           38.99                 35288              
           4           36.45                 39842              
           7           37.23                 35819              
           8           35.92                 34085              
           10          37.89                 32620              
5118       1           38.36                 36749              
           2           38.57                 36798              
           4           40.31                 31360              
           7           37.42                 38996              
           8           38.92                 39894              
           10          38.76                 37133              
5119       1           37.97                 40357              
           2           38.45                 39951              
           4           38.53                 37916              
           7           36.00                 31247              
           8           39.47                 35047              
           10          37.57                 36217              
5120       1           37.44                 32494              
           2           36.85                 37841              
           4           38.75                 41156              
           7           38.10                 34369              
           8           37.33                 37222              
           10          38.56                 42375              
5121       1           38.48                 33632              
           2           36.94                 33802              
           4           38.15                 38191              
           7           39.71                 39394              
           8           37.64                 38954              
           10          36.02                 29355              
5122       1           39.15                 33164              
           2           35.62                 25646              
2023-06-07 12:53:50,897 - main.py[line:587] - INFO: relative error:
                        avg(ss_sales_price)  sum(ss_sales_price)
d_week_seq ss_store_sk                                          
5114       1           0.04                 0.02                
           2           0.02                 0.00                
           4           0.07                 0.14                
           7           0.09                 0.01                
           8           0.07                 0.17                
           10          0.02                 0.06                
5115       1           0.01                 0.06                
           2           0.04                 0.02                
           4           0.06                 0.19                
           7           0.00                 0.12                
           8           0.00                 0.06                
           10          0.04                 0.09                
5116       1           0.01                 0.05                
           2           0.01                 0.06                
           4           0.07                 0.03                
           7           0.05                 0.11                
           8           0.05                 0.06                
           10          0.05                 0.10                
5117       1           0.01                 0.01                
           2           0.00                 0.21                
           4           0.01                 0.12                
           7           0.01                 0.13                
           8           0.05                 0.10                
           10          0.08                 0.14                
5118       1           0.03                 0.01                
           2           0.08                 0.01                
           4           0.07                 0.28                
           7           0.02                 0.12                
           8           0.13                 0.09                
           10          0.05                 0.02                
5119       1           0.08                 0.09                
           2           0.11                 0.13                
           4           0.07                 0.15                
           7           0.10                 0.15                
           8           0.08                 0.06                
           10          0.00                 0.01                
5120       1           0.02                 0.07                
           2           0.02                 0.18                
           4           0.11                 0.05                
           7           0.03                 0.18                
           8           0.01                 0.01                
           10          0.05                 0.13                
5121       1           0.03                 0.14                
           2           0.03                 0.21                
           4           0.08                 0.15                
           7           0.09                 0.39                
           8           0.03                 0.16                
           10          0.02                 0.20                
5122       1           0.02                 0.23                
           2           0.04                 0.10                
2023-06-07 12:53:50,898 - main.py[line:588] - INFO: relative error normalized:
                        avg(ss_sales_price)
d_week_seq ss_store_sk                     
5114       1           0.04                
           2           0.02                
           4           0.06                
           7           0.09                
           8           0.06                
           10          0.02                
5115       1           0.01                
           2           0.04                
           4           0.06                
           7           0.00                
           8           0.00                
           10          0.04                
5116       1           0.01                
           2           0.01                
           4           0.07                
           7           0.04                
           8           0.05                
           10          0.05                
5117       1           0.01                
           2           0.00                
           4           0.01                
           7           0.01                
           8           0.05                
           10          0.08                
5118       1           0.03                
           2           0.07                
           4           0.07                
           7           0.02                
           8           0.12                
           10          0.05                
5119       1           0.07                
           2           0.10                
           4           0.07                
           7           0.10                
           8           0.08                
           10          0.00                
5120       1           0.02                
           2           0.02                
           4           0.11                
           7           0.03                
           8           0.01                
           10          0.05                
5121       1           0.03                
           2           0.03                
           4           0.07                
           7           0.08                
           8           0.03                
           10          0.02                
5122       1           0.02                
           2           0.04                
2023-06-07 12:53:50,898 - main.py[line:591] - INFO: relative error average: 0.0933960665361732
2023-06-07 12:53:50,898 - main.py[line:592] - INFO: relative error normalized average: 0.05077529430916825
2023-06-07 12:53:50,936 - main.py[line:638] - INFO: total_time:89.71640250179917