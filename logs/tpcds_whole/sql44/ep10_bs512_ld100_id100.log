main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-07-03 13:51:28,662 - main.py[line:642] - INFO: load query config config/tpcds_whole/query/sql44.json successfully
2023-07-03 13:51:28,662 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/44_store_sales.json successfully
2023-07-03 13:51:28,662 - pytorch_cvae.py[line:249] - INFO: epoch:10
2023-07-03 13:51:28,662 - pytorch_cvae.py[line:250] - INFO: batch size:512
2023-07-03 13:51:28,663 - pytorch_cvae.py[line:251] - INFO: latent dimension:100
2023-07-03 13:51:28,663 - pytorch_cvae.py[line:252] - INFO: intermediate dimension:100
2023-07-03 13:51:28,663 - pytorch_cvae.py[line:253] - INFO: gpu num:0
2023-07-03 13:51:28,663 - dataset_utils.py[line:566] - INFO: load existing dataset:44-store_sales_ss_item_sk_ss_net_profit_ss_item_sk_binary_mm_0
2023-07-03 13:51:32,806 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:4.1432548449374735
2023-07-03 13:51:32,806 - pytorch_cvae.py[line:258] - INFO: feature info:[('ss_net_profit', 'numerical', 1), ('ss_item_sk', 'categorical', 16)]
2023-07-03 13:52:09,254 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-07-03 13:52:09,254 - pytorch_cvae.py[line:177] - INFO: loss:226.78983930731192, numeric_loss:26.34811374824494, categorical_loss:128.3202162037487, kld_loss:13379.72613659501, epoch_train_time:36.44561404292472
2023-07-03 13:52:45,134 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.2 epoch----------------------------
2023-07-03 13:52:45,134 - pytorch_cvae.py[line:177] - INFO: loss:31.42259520664811, numeric_loss:15.346532712923363, categorical_loss:2.0031408757786267, kld_loss:2363.4934411346912, epoch_train_time:35.880147888092324
2023-07-03 13:53:20,991 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.3 epoch----------------------------
2023-07-03 13:53:20,991 - pytorch_cvae.py[line:177] - INFO: loss:32.682907099835575, numeric_loss:16.528105477336794, categorical_loss:1.9208391460997518, kld_loss:2166.29664388299, epoch_train_time:35.856783031951636
2023-07-03 13:53:57,053 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.4 epoch----------------------------
2023-07-03 13:53:57,053 - pytorch_cvae.py[line:177] - INFO: loss:33.84394753398374, numeric_loss:17.876366059994325, categorical_loss:1.8270689563069027, kld_loss:1952.1516612172127, epoch_train_time:36.061095762997866
2023-07-03 13:54:33,195 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.5 epoch----------------------------
2023-07-03 13:54:33,195 - pytorch_cvae.py[line:177] - INFO: loss:34.94689075089991, numeric_loss:19.49494633055292, categorical_loss:1.7472840617410839, kld_loss:1717.9371232241392, epoch_train_time:36.14249035180546
2023-07-03 13:55:09,202 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.6 epoch----------------------------
2023-07-03 13:55:09,202 - pytorch_cvae.py[line:177] - INFO: loss:36.185809650458395, numeric_loss:21.172512514982373, categorical_loss:1.7380150548997335, kld_loss:1512.5425897240639, epoch_train_time:36.00683611817658
2023-07-03 13:55:45,208 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.7 epoch----------------------------
2023-07-03 13:55:45,208 - pytorch_cvae.py[line:177] - INFO: loss:37.3021469572559, numeric_loss:22.88144664745778, categorical_loss:1.7358770586142782, kld_loss:1314.9446112811565, epoch_train_time:36.005467056063935
2023-07-03 13:56:21,493 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.8 epoch----------------------------
2023-07-03 13:56:21,493 - pytorch_cvae.py[line:177] - INFO: loss:38.39790724730119, numeric_loss:24.768528341315687, categorical_loss:1.737713805574458, kld_loss:1122.6882445663214, epoch_train_time:36.28483366500586
2023-07-03 13:56:57,563 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.9 epoch----------------------------
2023-07-03 13:56:57,563 - pytorch_cvae.py[line:177] - INFO: loss:39.46356689138338, numeric_loss:26.845749124418944, categorical_loss:1.7394505873962771, kld_loss:936.284838244319, epoch_train_time:36.070290403906256
2023-07-03 13:57:33,453 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.10 epoch----------------------------
2023-07-03 13:57:33,453 - pytorch_cvae.py[line:177] - INFO: loss:40.40866915695369, numeric_loss:29.04663665732369, categorical_loss:1.7411188129335642, kld_loss:755.6533996015787, epoch_train_time:35.889717139070854
2023-07-03 13:57:33,453 - pytorch_cvae.py[line:186] - INFO: training time elapsed:360.64557421486825
2023-07-03 13:57:33,455 - model_utils.py[line:67] - INFO: save model successfully
2023-07-03 13:57:48,859 - pytorch_cvae.py[line:268] - INFO: train model time elapsed:380.19677854678594
2023-07-03 13:57:48,860 - main.py[line:572] - INFO: multi_sampling No.0 epoch
2023-07-03 13:57:58,363 - pytorch_cvae.py[line:407] - INFO: sampling time:9.46539592789486
2023-07-03 13:57:58,377 - main.py[line:555] - INFO: sample and aggregation time elapsed:9.517160472925752
2023-07-03 13:57:58,383 - main.py[line:593] - INFO: sample time: 9.523198207141832
2023-07-03 13:57:58,405 - main.py[line:104] - INFO: aqp result:
            avg(ss_net_profit)  sum(ss_net_profit)
ss_item_sk                                        
1          -796.59             -211633.81         
2          -1353.08            -235984.43         
3          -1687.32            -192120.10         
4          -1512.75            -165407.68         
5          -453.43             -50398.87          
6          -1201.47            -61648.46          
7          -429.06             -112438.95         
8          -1009.03            -190569.78         
9          -742.22             -84509.79          
10         -946.86             -100639.43         
11         -1414.41            -145707.92         
12         -454.77             -23835.24          
13         -539.91             -146854.71         
14         -1642.52            -270138.13         
15         -940.91             -92678.37          
16         -1837.80            -186002.88         
17         -1327.16            -155908.45         
18         -1698.48            -85951.21          
19         -957.96             -257970.21         
20         -916.76             -180811.30         
21         -699.58             -60782.52          
22         -628.31             -74840.51          
23         -722.22             -75053.13          
24         -553.05             -30890.37          
25         -626.65             -176678.97         
26         -1045.17            -197396.16         
27         -726.62             -79881.65          
28         -1331.25            -121978.28         
29         -531.23             -50885.43          
30         -782.96             -45282.01          
31         -928.02             -222231.78         
32         -990.16             -134214.18         
33         -838.56             -99621.49          
34         -1140.13            -113868.71         
35         -1345.92            -161760.74         
36         -704.06             -38173.84          
37         -1137.74            -301275.68         
38         -741.72             -118932.28         
39         -537.26             -53165.48          
40         -1062.86            -103229.57         
41         -1356.30            -145497.71         
42         -896.53             -50109.17          
43         -522.39             -149170.83         
44         -710.71             -113675.60         
45         -1092.11            -115466.23         
46         -640.18             -65949.86          
47         -476.05             -47750.81          
48         -478.90             -28823.56          
49         -771.38             -225849.50         
50         -1056.77            -173328.25         
2023-07-03 13:57:58,407 - main.py[line:105] - INFO: ground truth:
            avg(ss_net_profit)  sum(ss_net_profit)
ss_item_sk                                        
1          -847.17             -249068            
2          -847.61             -163589            
3          -1110.58            -139933            
4          -797.40             -96486             
5          -607.18             -74683             
6          -702.46             -39338             
7          -749.98             -217494            
8          -729.12             -152386            
9          -778.37             -98074             
10         -640.03             -74244             
11         -1069.25            -121894            
12         -835.36             -48451             
13         -758.00             -228159            
14         -746.45             -135853            
15         -614.39             -66968             
16         -828.84             -92830             
17         -788.66             -102526            
18         -887.29             -49688             
19         -799.55             -238265            
20         -572.60             -121963            
21         -1189.02            -116524            
22         -694.01             -90221             
23         -722.27             -83061             
24         -840.10             -52926             
25         -864.83             -269826            
26         -771.07             -161153            
27         -1087.69            -134873            
28         -631.77             -63177             
29         -727.02             -77064             
30         -960.98             -61503             
31         -825.05             -218637            
32         -873.72             -131058            
33         -920.69             -123373            
34         -576.47             -62835             
35         -780.40             -103793            
36         -843.15             -50589             
37         -649.09             -187586            
38         -654.48             -114534            
39         -787.69             -85070             
40         -626.48             -66407             
41         -839.74             -101608            
42         -614.08             -37459             
43         -817.81             -258427            
44         -833.75             -147574            
45         -1036.85            -121312            
46         -1052.21            -119952            
47         -814.65             -90426             
48         -575.40             -37401             
49         -811.23             -262837            
50         -896.54             -165859            
2023-07-03 13:57:58,417 - main.py[line:611] - INFO: relative error:
            avg(ss_net_profit)  sum(ss_net_profit)
ss_item_sk                                        
1          0.06                0.15               
2          0.60                0.44               
3          0.52                0.37               
4          0.90                0.71               
5          0.25                0.33               
6          0.71                0.57               
7          0.43                0.48               
8          0.38                0.25               
9          0.05                0.14               
10         0.48                0.36               
11         0.32                0.20               
12         0.46                0.51               
13         0.29                0.36               
14         1.20                0.99               
15         0.53                0.38               
16         1.22                1.00               
17         0.68                0.52               
18         0.91                0.73               
19         0.20                0.08               
20         0.60                0.48               
21         0.41                0.48               
22         0.09                0.17               
23         0.00                0.10               
24         0.34                0.42               
25         0.28                0.35               
26         0.36                0.22               
27         0.33                0.41               
28         1.11                0.93               
29         0.27                0.34               
30         0.19                0.26               
31         0.12                0.02               
32         0.13                0.02               
33         0.09                0.19               
34         0.98                0.81               
35         0.72                0.56               
36         0.16                0.25               
37         0.75                0.61               
38         0.13                0.04               
39         0.32                0.38               
40         0.70                0.55               
41         0.62                0.43               
42         0.46                0.34               
43         0.36                0.42               
44         0.15                0.23               
45         0.05                0.05               
46         0.39                0.45               
47         0.42                0.47               
48         0.17                0.23               
49         0.05                0.14               
50         0.18                0.05               
2023-07-03 13:57:58,419 - main.py[line:612] - INFO: relative error normalized:
            avg(ss_net_profit)  sum(ss_net_profit)
ss_item_sk                                        
1          0.06                0.14               
2          0.45                0.36               
3          0.41                0.31               
4          0.59                0.51               
5          0.22                0.28               
6          0.51                0.43               
7          0.35                0.38               
8          0.32                0.22               
9          0.05                0.13               
10         0.38                0.30               
11         0.28                0.18               
12         0.37                0.40               
13         0.25                0.30               
14         0.70                0.63               
15         0.41                0.32               
16         0.70                0.63               
17         0.49                0.41               
18         0.60                0.52               
19         0.18                0.08               
20         0.45                0.38               
21         0.34                0.38               
22         0.09                0.16               
23         0.00                0.09               
24         0.29                0.34               
25         0.24                0.29               
26         0.30                0.20               
27         0.28                0.33               
28         0.67                0.61               
29         0.24                0.29               
30         0.17                0.23               
31         0.12                0.02               
32         0.12                0.02               
33         0.09                0.18               
34         0.62                0.56               
35         0.52                0.43               
36         0.15                0.22               
37         0.53                0.45               
38         0.12                0.04               
39         0.27                0.31               
40         0.50                0.43               
41         0.46                0.35               
42         0.37                0.29               
43         0.30                0.34               
44         0.14                0.21               
45         0.05                0.05               
46         0.32                0.36               
47         0.34                0.38               
48         0.15                0.20               
49         0.05                0.13               
50         0.16                0.04               
2023-07-03 13:57:58,419 - main.py[line:615] - INFO: relative error average: 0.3718464909790214
2023-07-03 13:57:58,419 - main.py[line:616] - INFO: relative error normalized average: 0.2781881518961164
2023-07-03 13:57:58,422 - main.py[line:662] - INFO: total_time:389.7601738318335