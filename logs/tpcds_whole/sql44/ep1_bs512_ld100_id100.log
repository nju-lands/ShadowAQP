main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-07-03 13:50:17,155 - main.py[line:642] - INFO: load query config config/tpcds_whole/query/sql44.json successfully
2023-07-03 13:50:17,155 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/44_store_sales.json successfully
2023-07-03 13:50:17,155 - pytorch_cvae.py[line:249] - INFO: epoch:1
2023-07-03 13:50:17,155 - pytorch_cvae.py[line:250] - INFO: batch size:512
2023-07-03 13:50:17,155 - pytorch_cvae.py[line:251] - INFO: latent dimension:100
2023-07-03 13:50:17,155 - pytorch_cvae.py[line:252] - INFO: intermediate dimension:100
2023-07-03 13:50:17,155 - pytorch_cvae.py[line:253] - INFO: gpu num:0
2023-07-03 13:50:17,155 - dataset_utils.py[line:566] - INFO: load existing dataset:44-store_sales_ss_item_sk_ss_net_profit_ss_item_sk_binary_mm_0
2023-07-03 13:50:21,215 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:4.059852593112737
2023-07-03 13:50:21,215 - pytorch_cvae.py[line:258] - INFO: feature info:[('ss_net_profit', 'numerical', 1), ('ss_item_sk', 'categorical', 16)]
2023-07-03 13:50:58,377 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-07-03 13:50:58,377 - pytorch_cvae.py[line:177] - INFO: loss:218.7982519394718, numeric_loss:32.58446089923382, categorical_loss:120.61467452708166, kld_loss:12169.714883714914, epoch_train_time:37.159599816892296
2023-07-03 13:50:58,377 - pytorch_cvae.py[line:186] - INFO: training time elapsed:37.16027345904149
2023-07-03 13:50:59,065 - model_utils.py[line:67] - INFO: save model successfully
2023-07-03 13:51:13,932 - pytorch_cvae.py[line:268] - INFO: train model time elapsed:56.77657040185295
2023-07-03 13:51:13,932 - main.py[line:572] - INFO: multi_sampling No.0 epoch
2023-07-03 13:51:23,450 - pytorch_cvae.py[line:407] - INFO: sampling time:9.480887755053118
2023-07-03 13:51:23,464 - main.py[line:555] - INFO: sample and aggregation time elapsed:9.531719391932711
2023-07-03 13:51:23,470 - main.py[line:593] - INFO: sample time: 9.538159481016919
2023-07-03 13:51:23,493 - main.py[line:104] - INFO: aqp result:
            avg(ss_net_profit)  sum(ss_net_profit)
ss_item_sk                                        
1          -1678.30            -445881.92         
2          -1184.60            -206601.75         
3          -1170.97            -133328.10         
4          -1112.98            -121696.46         
5          -1357.57            -150893.69         
6          -1157.57            -59396.08          
7          -945.84             -247867.80         
8          -839.36             -158526.11         
9          -1172.92            -133550.12         
10         -1135.75            -120715.80         
11         -561.64             -57858.85          
12         -683.19             -35807.48          
13         -660.43             -179638.54         
14         -308.08             -50669.37          
15         -784.10             -77232.37          
16         -873.78             -88434.56          
17         -928.58             -109084.86         
18         -1288.14            -65185.97          
19         -821.08             -221107.98         
20         -1472.26            -290372.12         
21         -1283.39            -111506.69         
22         -480.56             -57242.26          
23         -789.10             -82004.13          
24         -1352.59            -75547.67          
25         -949.74             -267771.88         
26         -1282.30            -242180.45         
27         -1181.89            -129931.08         
28         -1390.72            -127427.41         
29         -837.32             -80204.88          
30         -227.09             -13133.45          
31         -826.22             -197854.63         
32         -703.66             -95380.55          
33         -2164.28            -257118.45         
34         -956.91             -95569.21          
35         -933.08             -112143.45         
36         -1233.10            -66858.17          
37         -1210.80            -320620.39         
38         -639.33             -102513.94         
39         -655.53             -64869.60          
40         -378.04             -36716.89          
41         -1142.62            -122574.74         
42         -693.53             -38763.08          
43         -99.93              -28535.29          
44         -561.53             -89814.96          
45         -1308.25            -138318.62         
46         -605.28             -62353.99          
47         -851.65             -85425.80          
48         -1142.48            -68762.78          
49         -750.07             -219610.21         
50         -1127.77            -184972.45         
2023-07-03 13:51:23,495 - main.py[line:105] - INFO: ground truth:
            avg(ss_net_profit)  sum(ss_net_profit)
ss_item_sk                                        
1          -847.17             -249068            
2          -847.61             -163589            
3          -1110.58            -139933            
4          -797.40             -96486             
5          -607.18             -74683             
6          -702.46             -39338             
7          -749.98             -217494            
8          -729.12             -152386            
9          -778.37             -98074             
10         -640.03             -74244             
11         -1069.25            -121894            
12         -835.36             -48451             
13         -758.00             -228159            
14         -746.45             -135853            
15         -614.39             -66968             
16         -828.84             -92830             
17         -788.66             -102526            
18         -887.29             -49688             
19         -799.55             -238265            
20         -572.60             -121963            
21         -1189.02            -116524            
22         -694.01             -90221             
23         -722.27             -83061             
24         -840.10             -52926             
25         -864.83             -269826            
26         -771.07             -161153            
27         -1087.69            -134873            
28         -631.77             -63177             
29         -727.02             -77064             
30         -960.98             -61503             
31         -825.05             -218637            
32         -873.72             -131058            
33         -920.69             -123373            
34         -576.47             -62835             
35         -780.40             -103793            
36         -843.15             -50589             
37         -649.09             -187586            
38         -654.48             -114534            
39         -787.69             -85070             
40         -626.48             -66407             
41         -839.74             -101608            
42         -614.08             -37459             
43         -817.81             -258427            
44         -833.75             -147574            
45         -1036.85            -121312            
46         -1052.21            -119952            
47         -814.65             -90426             
48         -575.40             -37401             
49         -811.23             -262837            
50         -896.54             -165859            
2023-07-03 13:51:23,506 - main.py[line:611] - INFO: relative error:
            avg(ss_net_profit)  sum(ss_net_profit)
ss_item_sk                                        
1          0.98                0.79               
2          0.40                0.26               
3          0.05                0.05               
4          0.40                0.26               
5          1.24                1.02               
6          0.65                0.51               
7          0.26                0.14               
8          0.15                0.04               
9          0.51                0.36               
10         0.77                0.63               
11         0.47                0.53               
12         0.18                0.26               
13         0.13                0.21               
14         0.59                0.63               
15         0.28                0.15               
16         0.05                0.05               
17         0.18                0.06               
18         0.45                0.31               
19         0.03                0.07               
20         1.57                1.38               
21         0.08                0.04               
22         0.31                0.37               
23         0.09                0.01               
24         0.61                0.43               
25         0.10                0.01               
26         0.66                0.50               
27         0.09                0.04               
28         1.20                1.02               
29         0.15                0.04               
30         0.76                0.79               
31         0.00                0.10               
32         0.19                0.27               
33         1.35                1.08               
34         0.66                0.52               
35         0.20                0.08               
36         0.46                0.32               
37         0.87                0.71               
38         0.02                0.10               
39         0.17                0.24               
40         0.40                0.45               
41         0.36                0.21               
42         0.13                0.03               
43         0.88                0.89               
44         0.33                0.39               
45         0.26                0.14               
46         0.42                0.48               
47         0.05                0.06               
48         0.99                0.84               
49         0.08                0.16               
50         0.26                0.12               
2023-07-03 13:51:23,508 - main.py[line:612] - INFO: relative error normalized:
            avg(ss_net_profit)  sum(ss_net_profit)
ss_item_sk                                        
1          0.63                0.55               
2          0.33                0.23               
3          0.05                0.05               
4          0.33                0.23               
5          0.71                0.64               
6          0.48                0.40               
7          0.23                0.13               
8          0.14                0.04               
9          0.40                0.30               
10         0.54                0.47               
11         0.38                0.41               
12         0.17                0.23               
13         0.12                0.19               
14         0.44                0.47               
15         0.24                0.14               
16         0.05                0.05               
17         0.16                0.06               
18         0.36                0.27               
19         0.03                0.07               
20         0.79                0.75               
21         0.08                0.04               
22         0.26                0.31               
23         0.09                0.01               
24         0.46                0.35               
25         0.09                0.01               
26         0.48                0.40               
27         0.08                0.04               
28         0.70                0.64               
29         0.14                0.04               
30         0.53                0.54               
31         0.00                0.09               
32         0.18                0.24               
33         0.74                0.66               
34         0.48                0.41               
35         0.18                0.08               
36         0.37                0.28               
37         0.58                0.51               
38         0.02                0.10               
39         0.15                0.21               
40         0.33                0.36               
41         0.30                0.19               
42         0.12                0.03               
43         0.58                0.59               
44         0.28                0.32               
45         0.23                0.13               
46         0.35                0.38               
47         0.04                0.05               
48         0.63                0.57               
49         0.07                0.15               
50         0.23                0.11               
2023-07-03 13:51:23,508 - main.py[line:615] - INFO: relative error average: 0.40294873420642935
2023-07-03 13:51:23,508 - main.py[line:616] - INFO: relative error normalized average: 0.29503846019565255
2023-07-03 13:51:23,511 - main.py[line:662] - INFO: total_time:66.35622029099613