main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-07-03 13:38:11,487 - main.py[line:642] - INFO: load query config config/tpcds_whole/query/sql44.json successfully
2023-07-03 13:38:11,487 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/44_store_sales.json successfully
2023-07-03 13:38:11,487 - pytorch_cvae.py[line:249] - INFO: epoch:10
2023-07-03 13:38:11,488 - pytorch_cvae.py[line:250] - INFO: batch size:256
2023-07-03 13:38:11,488 - pytorch_cvae.py[line:251] - INFO: latent dimension:100
2023-07-03 13:38:11,488 - pytorch_cvae.py[line:252] - INFO: intermediate dimension:100
2023-07-03 13:38:11,488 - pytorch_cvae.py[line:253] - INFO: gpu num:0
2023-07-03 13:38:11,488 - dataset_utils.py[line:566] - INFO: load existing dataset:44-store_sales_ss_item_sk_ss_net_profit_ss_item_sk_binary_mm_0
2023-07-03 13:38:15,638 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:4.150048084091395
2023-07-03 13:38:15,638 - pytorch_cvae.py[line:258] - INFO: feature info:[('ss_net_profit', 'numerical', 1), ('ss_item_sk', 'categorical', 16)]
2023-07-03 13:39:22,531 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-07-03 13:39:22,531 - pytorch_cvae.py[line:177] - INFO: loss:300.2536010844633, numeric_loss:51.75089313951321, categorical_loss:157.84843178704614, kld_loss:16817.85916057229, epoch_train_time:66.89102043304592
2023-07-03 13:40:28,344 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.2 epoch----------------------------
2023-07-03 13:40:28,344 - pytorch_cvae.py[line:177] - INFO: loss:63.12815517978743, numeric_loss:31.383609601762146, categorical_loss:3.8366074874356855, kld_loss:4687.031624406576, epoch_train_time:65.81275654397905
2023-07-03 13:41:33,804 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.3 epoch----------------------------
2023-07-03 13:41:33,805 - pytorch_cvae.py[line:177] - INFO: loss:65.00344571750611, numeric_loss:33.57234965870157, categorical_loss:3.551666619227035, kld_loss:4243.028919070959, epoch_train_time:65.45981620089151
2023-07-03 13:42:38,841 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.4 epoch----------------------------
2023-07-03 13:42:38,841 - pytorch_cvae.py[line:177] - INFO: loss:66.75335781788453, numeric_loss:34.85115388222039, categorical_loss:3.509379648603499, kld_loss:3919.73762729764, epoch_train_time:65.03617625986226
2023-07-03 13:43:43,191 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.5 epoch----------------------------
2023-07-03 13:43:43,191 - pytorch_cvae.py[line:177] - INFO: loss:69.25703866686672, numeric_loss:37.65636471984908, categorical_loss:3.49931426794501, kld_loss:3522.6242536753416, epoch_train_time:64.34964935993776
2023-07-03 13:44:46,537 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.6 epoch----------------------------
2023-07-03 13:44:46,537 - pytorch_cvae.py[line:177] - INFO: loss:71.94478519819677, numeric_loss:40.97629394917749, categorical_loss:3.497081441426417, kld_loss:3130.0033533126116, epoch_train_time:63.34610920678824
2023-07-03 13:45:51,410 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.7 epoch----------------------------
2023-07-03 13:45:51,410 - pytorch_cvae.py[line:177] - INFO: loss:74.60708610806614, numeric_loss:44.83407946489751, categorical_loss:3.4998782197362743, kld_loss:2723.546716541052, epoch_train_time:64.87293742503971
2023-07-03 13:46:56,602 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.8 epoch----------------------------
2023-07-03 13:46:56,602 - pytorch_cvae.py[line:177] - INFO: loss:77.03224929654971, numeric_loss:49.08860045182519, categorical_loss:3.501076598506188, kld_loss:2307.6153236329556, epoch_train_time:65.1912067818921
2023-07-03 13:48:02,781 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.9 epoch----------------------------
2023-07-03 13:48:02,781 - pytorch_cvae.py[line:177] - INFO: loss:79.29942710138857, numeric_loss:53.87495961948298, categorical_loss:3.5033459976839367, kld_loss:1886.7182282209396, epoch_train_time:66.1788718032185
2023-07-03 13:49:09,629 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.10 epoch----------------------------
2023-07-03 13:49:09,629 - pytorch_cvae.py[line:177] - INFO: loss:81.22917751362547, numeric_loss:58.80486301216297, categorical_loss:3.507020065007964, kld_loss:1485.8170724138618, epoch_train_time:66.84752320800908
2023-07-03 13:49:09,629 - pytorch_cvae.py[line:186] - INFO: training time elapsed:653.9891254440881
2023-07-03 13:49:09,631 - model_utils.py[line:67] - INFO: save model successfully
2023-07-03 13:49:25,097 - pytorch_cvae.py[line:268] - INFO: train model time elapsed:673.6094775628299
2023-07-03 13:49:25,097 - main.py[line:572] - INFO: multi_sampling No.0 epoch
2023-07-03 13:49:34,248 - pytorch_cvae.py[line:407] - INFO: sampling time:9.113466212060302
2023-07-03 13:49:34,262 - main.py[line:555] - INFO: sample and aggregation time elapsed:9.16438468778506
2023-07-03 13:49:34,268 - main.py[line:593] - INFO: sample time: 9.17068262794055
2023-07-03 13:49:34,292 - main.py[line:104] - INFO: aqp result:
            avg(ss_net_profit)  sum(ss_net_profit)
ss_item_sk                                        
1          -1093.68            -290564.92         
2          -1178.96            -205616.96         
3          -347.90             -39612.21          
4          -628.65             -68738.28          
5          -460.85             -51223.10          
6          -1298.56            -66630.43          
7          -704.47             -184614.40         
8          -563.21             -106369.47         
9          -308.92             -35173.92          
10         -350.04             -37205.05          
11         -745.93             -76843.77          
12         -1160.90            -60845.08          
13         -985.29             -267999.83         
14         -967.98             -159198.98         
15         -1078.94            -106273.64         
16         -249.14             -25215.02          
17         -1862.96            -218851.98         
18         -758.45             -38381.42          
19         -1050.70            -282941.56         
20         -1483.05            -292500.14         
21         -431.35             -37477.77          
22         -765.24             -91150.92          
23         -673.51             -69992.02          
24         -914.35             -51070.48          
25         -948.55             -267433.87         
26         -484.85             -91571.15          
27         -471.09             -51788.85          
28         -804.86             -73746.94          
29         -1417.91            -135817.84         
30         -527.02             -30479.87          
31         -955.27             -228758.37         
32         -879.06             -119155.09         
33         -677.04             -80433.36          
34         -1412.80            -141101.40         
35         -1587.72            -190822.70         
36         -1553.34            -84221.39          
37         -605.00             -160205.91         
38         -1546.03            -247901.01         
39         -446.33             -44167.24          
40         -528.57             -51336.95          
41         -422.79             -45354.64          
42         -1187.32            -66362.26          
43         -709.92             -202720.93         
44         -398.71             -63772.49          
45         -1110.55            -117416.35         
46         -499.60             -51467.15          
47         -715.25             -71744.09          
48         -1146.14            -68983.46          
49         -717.71             -210133.91         
50         -617.69             -101311.90         
2023-07-03 13:49:34,294 - main.py[line:105] - INFO: ground truth:
            avg(ss_net_profit)  sum(ss_net_profit)
ss_item_sk                                        
1          -847.17             -249068            
2          -847.61             -163589            
3          -1110.58            -139933            
4          -797.40             -96486             
5          -607.18             -74683             
6          -702.46             -39338             
7          -749.98             -217494            
8          -729.12             -152386            
9          -778.37             -98074             
10         -640.03             -74244             
11         -1069.25            -121894            
12         -835.36             -48451             
13         -758.00             -228159            
14         -746.45             -135853            
15         -614.39             -66968             
16         -828.84             -92830             
17         -788.66             -102526            
18         -887.29             -49688             
19         -799.55             -238265            
20         -572.60             -121963            
21         -1189.02            -116524            
22         -694.01             -90221             
23         -722.27             -83061             
24         -840.10             -52926             
25         -864.83             -269826            
26         -771.07             -161153            
27         -1087.69            -134873            
28         -631.77             -63177             
29         -727.02             -77064             
30         -960.98             -61503             
31         -825.05             -218637            
32         -873.72             -131058            
33         -920.69             -123373            
34         -576.47             -62835             
35         -780.40             -103793            
36         -843.15             -50589             
37         -649.09             -187586            
38         -654.48             -114534            
39         -787.69             -85070             
40         -626.48             -66407             
41         -839.74             -101608            
42         -614.08             -37459             
43         -817.81             -258427            
44         -833.75             -147574            
45         -1036.85            -121312            
46         -1052.21            -119952            
47         -814.65             -90426             
48         -575.40             -37401             
49         -811.23             -262837            
50         -896.54             -165859            
2023-07-03 13:49:34,305 - main.py[line:611] - INFO: relative error:
            avg(ss_net_profit)  sum(ss_net_profit)
ss_item_sk                                        
1          0.29                0.17               
2          0.39                0.26               
3          0.69                0.72               
4          0.21                0.29               
5          0.24                0.31               
6          0.85                0.69               
7          0.06                0.15               
8          0.23                0.30               
9          0.60                0.64               
10         0.45                0.50               
11         0.30                0.37               
12         0.39                0.26               
13         0.30                0.17               
14         0.30                0.17               
15         0.76                0.59               
16         0.70                0.73               
17         1.36                1.13               
18         0.15                0.23               
19         0.31                0.19               
20         1.59                1.40               
21         0.64                0.68               
22         0.10                0.01               
23         0.07                0.16               
24         0.09                0.04               
25         0.10                0.01               
26         0.37                0.43               
27         0.57                0.62               
28         0.27                0.17               
29         0.95                0.76               
30         0.45                0.50               
31         0.16                0.05               
32         0.01                0.09               
33         0.26                0.35               
34         1.45                1.25               
35         1.03                0.84               
36         0.84                0.66               
37         0.07                0.15               
38         1.36                1.16               
39         0.43                0.48               
40         0.16                0.23               
41         0.50                0.55               
42         0.93                0.77               
43         0.13                0.22               
44         0.52                0.57               
45         0.07                0.03               
46         0.53                0.57               
47         0.12                0.21               
48         0.99                0.84               
49         0.12                0.20               
50         0.31                0.39               
2023-07-03 13:49:34,306 - main.py[line:612] - INFO: relative error normalized:
            avg(ss_net_profit)  sum(ss_net_profit)
ss_item_sk                                        
1          0.25                0.15               
2          0.32                0.23               
3          0.50                0.51               
4          0.19                0.25               
5          0.21                0.27               
6          0.57                0.50               
7          0.06                0.14               
8          0.20                0.26               
9          0.45                0.47               
10         0.36                0.39               
11         0.26                0.31               
12         0.32                0.23               
13         0.26                0.16               
14         0.26                0.16               
15         0.53                0.44               
16         0.50                0.52               
17         0.74                0.68               
18         0.14                0.20               
19         0.27                0.17               
20         0.80                0.75               
21         0.47                0.49               
22         0.10                0.01               
23         0.07                0.15               
24         0.08                0.03               
25         0.09                0.01               
26         0.31                0.35               
27         0.43                0.46               
28         0.24                0.15               
29         0.61                0.53               
30         0.36                0.40               
31         0.15                0.05               
32         0.01                0.09               
33         0.23                0.29               
34         0.77                0.71               
35         0.64                0.57               
36         0.57                0.49               
37         0.07                0.14               
38         0.74                0.69               
39         0.35                0.38               
40         0.14                0.20               
41         0.39                0.43               
42         0.61                0.54               
43         0.12                0.19               
44         0.41                0.43               
45         0.07                0.03               
46         0.41                0.44               
47         0.11                0.19               
48         0.63                0.57               
49         0.11                0.18               
50         0.27                0.32               
2023-07-03 13:49:34,307 - main.py[line:615] - INFO: relative error average: 0.3737730587467918
2023-07-03 13:49:34,307 - main.py[line:616] - INFO: relative error normalized average: 0.2873099397667578
2023-07-03 13:49:34,310 - main.py[line:662] - INFO: total_time:682.8227916930337