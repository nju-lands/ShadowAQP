main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-07-06 14:32:31,533 - main.py[line:642] - INFO: load query config config/tpcds_whole/query/sql31.json successfully
2023-07-06 14:32:31,533 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/31_store_sales.json successfully
2023-07-06 14:32:31,545 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/3_date_dim.json successfully
2023-07-06 14:32:31,554 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/94_customer_address.json successfully
2023-07-06 14:32:31,554 - dataset_utils.py[line:585] - INFO: load existing dataset(light):31-store_sales_ss_addr_sk#ss_sold_date_sk_ss_ext_sales_price_ss_sold_date_sk_binary_mm_0
2023-07-06 14:32:32,959 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:1.4053976631257683
2023-07-06 14:32:32,960 - pytorch_cvae.py[line:280] - INFO: feature info:[('ss_ext_sales_price', 'numerical', 1), ('ss_addr_sk', 'categorical', 17), ('ss_sold_date_sk', 'categorical', 12)]
2023-07-06 14:32:32,962 - model_utils.py[line:75] - INFO: load model name:torch_cvae_31-store_sales_ss_sold_date_sk_ld100_id100_bs256_ep20_0_binary_mm
2023-07-06 14:32:38,847 - model_utils.py[line:86] - INFO: load torch model time elapsed:5.884285358013585
2023-07-06 14:32:38,847 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:7.292987189022824
2023-07-06 14:32:38,847 - dataset_utils.py[line:585] - INFO: load existing dataset(light):3-date_dim_d_date_sk#d_year#d_qoy__d_date_sk#d_year#d_qoy_binary_gaussian5_0
2023-07-06 14:32:38,926 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:0.07864083396270871
2023-07-06 14:32:38,926 - pytorch_cvae.py[line:280] - INFO: feature info:[('d_date_sk', 'categorical', 18), ('d_year', 'categorical', 9), ('d_qoy', 'categorical', 3)]
2023-07-06 14:32:38,927 - model_utils.py[line:75] - INFO: load model name:torch_cvae_3-date_dim_d_date_sk_d_year_d_qoy_ld100_id150_bs128_ep100_0_binary_gaussian5
2023-07-06 14:32:38,928 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0016638559754937887
2023-07-06 14:32:38,928 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.08126850402913988
2023-07-06 14:32:38,928 - dataset_utils.py[line:585] - INFO: load existing dataset(light):94-customer_address_ca_address_sk#ca_county__ca_address_sk#ca_county_binary_gaussian5_0
2023-07-06 14:32:38,971 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:0.04247293504886329
2023-07-06 14:32:38,971 - pytorch_cvae.py[line:280] - INFO: feature info:[('ca_address_sk', 'categorical', 17), ('ca_county', 'categorical', 12)]
2023-07-06 14:32:38,972 - model_utils.py[line:75] - INFO: load model name:torch_cvae_94-customer_address_ca_address_sk_ca_county_ld100_id150_bs128_ep100_0_binary_gaussian5
2023-07-06 14:32:38,973 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.001623457996174693
2023-07-06 14:32:38,973 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.04512030188925564
2023-07-06 14:32:38,973 - main.py[line:572] - INFO: multi_sampling No.0 epoch
2023-07-06 14:32:38,979 - main.py[line:572] - INFO: multi_sampling No.1 epoch
2023-07-06 14:32:38,991 - main.py[line:572] - INFO: multi_sampling No.2 epoch
2023-07-06 14:32:50,428 - pytorch_cvae.py[line:407] - INFO: sampling time:11.437267275992781
2023-07-06 14:32:50,448 - dataset_utils.py[line:566] - INFO: load existing dataset:3-date_dim_d_date_sk#d_year#d_qoy__d_date_sk#d_year#d_qoy_binary_gaussian5_0
2023-07-06 14:32:53,524 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:3.075274699833244
2023-07-06 14:32:53,525 - dataset_utils.py[line:566] - INFO: load existing dataset:94-customer_address_ca_address_sk#ca_county__ca_address_sk#ca_county_binary_gaussian5_0
2023-07-06 14:32:53,598 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.07298196293413639
2023-07-06 14:32:53,788 - main.py[line:555] - INFO: sample and aggregation time elapsed:14.804156654980034
2023-07-06 14:32:54,061 - pytorch_cvae.py[line:407] - INFO: sampling time:15.0812491949182
2023-07-06 14:32:54,063 - dataset_utils.py[line:566] - INFO: load existing dataset:3-date_dim_d_date_sk#d_year#d_qoy__d_date_sk#d_year#d_qoy_binary_gaussian5_0
2023-07-06 14:32:54,072 - pytorch_cvae.py[line:407] - INFO: sampling time:15.073046620935202
2023-07-06 14:32:54,074 - dataset_utils.py[line:566] - INFO: load existing dataset:3-date_dim_d_date_sk#d_year#d_qoy__d_date_sk#d_year#d_qoy_binary_gaussian5_0
2023-07-06 14:32:54,154 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.09062587283551693
2023-07-06 14:32:54,155 - dataset_utils.py[line:566] - INFO: load existing dataset:94-customer_address_ca_address_sk#ca_county__ca_address_sk#ca_county_binary_gaussian5_0
2023-07-06 14:32:54,215 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.05993721284903586
2023-07-06 14:32:54,416 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.34117115498520434
2023-07-06 14:32:54,417 - dataset_utils.py[line:566] - INFO: load existing dataset:94-customer_address_ca_address_sk#ca_county__ca_address_sk#ca_county_binary_gaussian5_0
2023-07-06 14:32:54,480 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.06314942403696477
2023-07-06 14:32:54,575 - main.py[line:555] - INFO: sample and aggregation time elapsed:15.601766689913347
2023-07-06 14:32:54,651 - main.py[line:555] - INFO: sample and aggregation time elapsed:15.658160926075652
2023-07-06 14:32:54,673 - main.py[line:593] - INFO: sample time: 15.699418962933123
2023-07-06 14:32:54,814 - main.py[line:104] - INFO: aqp result:
                               avg(ss_ext_sales_price)  \
ca_county        d_qoy d_year                            
Abbeville County 1     1998   2188.77                    
                       1999   2238.06                    
                       2000   1913.93                    
                       2001   1687.57                    
                       2002   1426.03                    
                 2     1998   1711.25                    
                       1999   1811.38                    
                       2000   1176.84                    
                       2001   1815.16                    
                       2002   2081.26                    
                 3     1998   1432.59                    
                       1999   1512.36                    
                       2000   1108.86                    
                       2001   1911.10                    
                       2002   1741.75                    
                 4     1998   1304.31                    
                       1999   1808.59                    
                       2000   2058.95                    
                       2001   1593.18                    
                       2002   1785.11                    
Acadia Parish    1     1998   2074.54                    
                       1999   2027.86                    
                       2000   1687.29                    
                       2001   1692.22                    
                       2002   1800.42                    
                 2     1998   1537.28                    
                       1999   1581.76                    
                       2000   1283.42                    
                       2001   2361.32                    
                       2002   1670.29                    
                 3     1998   1940.19                    
                       1999   1842.08                    
                       2000   1620.12                    
                       2001   1981.16                    
                       2002   1838.86                    
                 4     1998   1851.11                    
                       1999   1529.20                    
                       2000   1833.10                    
                       2001   1257.52                    
                       2002   1917.97                    
Accomack County  1     1998   1672.61                    
                       1999   1714.96                    
                       2000   2030.47                    
                       2001   2094.86                    
                       2002   2076.90                    
                 2     1998   1511.72                    
                       1999   1675.30                    
                       2000   1822.08                    
                       2001   2144.44                    
                       2002   2307.19                    

                               sum(ss_ext_sales_price)  
ca_county        d_qoy d_year                           
Abbeville County 1     1998   39985.57                  
                       1999   57851.84                  
                       2000   52074.58                  
                       2001   41912.84                  
                       2002   24327.60                  
                 2     1998   16433.67                  
                       1999   42161.70                  
                       2000   8010.92                   
                       2001   39582.08                  
                       2002   25620.33                  
                 3     1998   35834.72                  
                       1999   61800.69                  
                       2000   31264.64                  
                       2001   71334.66                  
                       2002   38497.13                  
                 4     1998   87248.12                  
                       1999   95461.41                  
                       2000   64912.61                  
                       2001   80528.18                  
                       2002   60015.62                  
Acadia Parish    1     1998   41870.90                  
                       1999   47156.66                  
                       2000   57026.00                  
                       2001   34508.47                  
                       2002   30827.98                  
                 2     1998   22114.94                  
                       1999   17065.99                  
                       2000   41678.82                  
                       2001   70532.62                  
                       2002   30678.66                  
                 3     1998   38903.35                  
                       1999   78395.73                  
                       2000   118231.65                 
                       2001   88038.75                  
                       2002   45001.25                  
                 4     1998   145267.13                 
                       1999   116755.41                 
                       2000   49233.44                  
                       2001   58610.83                  
                       2002   85386.14                  
Accomack County  1     1998   76138.44                  
                       1999   40571.75                  
                       2000   59662.70                  
                       2001   34027.52                  
                       2002   53860.49                  
                 2     1998   33528.87                  
                       1999   41361.53                  
                       2000   44193.24                  
                       2001   54660.78                  
                       2002   44827.87                  
2023-07-06 14:32:54,816 - main.py[line:105] - INFO: ground truth:
                               avg(ss_ext_sales_price)  \
ca_county        d_qoy d_year                            
Abbeville County 1     1998   2575.54                    
                       1999   3222.64                    
                       2000   2414.06                    
                       2002   1227.44                    
                 2     1998   1262.44                    
                       1999   2543.76                    
                       2001   2016.83                    
                       2002   2582.07                    
                 3     1998   2273.00                    
                       1999   2391.61                    
                       2000   1486.80                    
                       2001   1674.54                    
                       2002   1744.80                    
                 4     1998   1690.76                    
                       1999   1763.30                    
                       2000   2231.39                    
                       2001   2233.14                    
                       2002   1943.08                    
Acadia Parish    1     1999   2344.91                    
                       2000   2145.00                    
                       2001   1505.00                    
                       2002   1891.84                    
                 2     1998   1653.43                    
                       1999   2938.58                    
                       2000   1687.40                    
                       2001   2117.83                    
                       2002   2070.82                    
                 3     1998   2095.42                    
                       1999   1271.28                    
                       2000   1683.24                    
                       2001   1886.29                    
                       2002   3579.21                    
                 4     1998   2005.19                    
                       1999   2327.17                    
                       2000   1681.00                    
                       2001   1569.02                    
                       2002   1970.78                    
Accomack County  1     1998   2344.26                    
                       1999   1848.02                    
                       2000   2067.95                    
                       2001   2010.00                    
                       2002   3704.40                    
                 2     1998   2092.60                    
                       1999   1861.78                    
                       2000   1794.12                    
                       2001   2603.73                    
                       2002   2020.77                    
                 3     1998   1733.90                    
                       1999   2459.50                    
                       2000   1716.79                    

                               sum(ss_ext_sales_price)  
ca_county        d_qoy d_year                           
Abbeville County 1     1998    95295                    
                       1999    35449                    
                       2000    43453                    
                       2002    11047                    
                 2     1998    40398                    
                       1999    43244                    
                       2001    24202                    
                       2002    118775                   
                 3     1998    45460                    
                       1999    133930                   
                       2000    60959                    
                       2001    21769                    
                       2002    71537                    
                 4     1998    155550                   
                       1999    77585                    
                       2000    51322                    
                       2001    209915                   
                       2002    75780                    
Acadia Parish    1     1999    25794                    
                       2000    55770                    
                       2001    15050                    
                       2002    69998                    
                 2     1998    11574                    
                       1999    70526                    
                       2000    75933                    
                       2001    76242                    
                       2002    70408                    
                 3     1998    69149                    
                       1999    72463                    
                       2000    28615                    
                       2001    149017                   
                       2002    85901                    
                 4     1998    116301                   
                       1999    13963                    
                       2000    60516                    
                       2001    70606                    
                       2002    126130                   
Accomack County  1     1998    82049                    
                       1999    81313                    
                       2000    134417                   
                       2001    72360                    
                       2002    37044                    
                 2     1998    98352                    
                       1999    111707                   
                       2000    86118                    
                       2001    85923                    
                       2002    86893                    
                 3     1998    136978                   
                       1999    88542                    
                       2000    49787                    
2023-07-06 14:32:54,955 - main.py[line:611] - INFO: relative error:
                               avg(ss_ext_sales_price)  \
ca_county        d_qoy d_year                            
Abbeville County 1     1998   0.15                       
                       1999   0.31                       
                       2000   0.21                       
                       2001   1.00                       
                       2002   0.16                       
                 2     1998   0.36                       
                       1999   0.29                       
                       2000   1.00                       
                       2001   0.10                       
                       2002   0.19                       
                 3     1998   0.37                       
                       1999   0.37                       
                       2000   0.25                       
                       2001   0.14                       
                       2002   0.00                       
                 4     1998   0.23                       
                       1999   0.03                       
                       2000   0.08                       
                       2001   0.29                       
                       2002   0.08                       
Acadia Parish    1     1998   1.00                       
                       1999   0.14                       
                       2000   0.21                       
                       2001   0.12                       
                       2002   0.05                       
                 2     1998   0.07                       
                       1999   0.46                       
                       2000   0.24                       
                       2001   0.11                       
                       2002   0.19                       
                 3     1998   0.07                       
                       1999   0.45                       
                       2000   0.04                       
                       2001   0.05                       
                       2002   0.49                       
                 4     1998   0.08                       
                       1999   0.34                       
                       2000   0.09                       
                       2001   0.20                       
                       2002   0.03                       
Accomack County  1     1998   0.29                       
                       1999   0.07                       
                       2000   0.02                       
                       2001   0.04                       
                       2002   0.44                       
                 2     1998   0.28                       
                       1999   0.10                       
                       2000   0.02                       
                       2001   0.18                       
                       2002   0.14                       

                               sum(ss_ext_sales_price)  
ca_county        d_qoy d_year                           
Abbeville County 1     1998   0.58                      
                       1999   0.63                      
                       2000   0.20                      
                       2001   1.00                      
                       2002   1.20                      
                 2     1998   0.59                      
                       1999   0.03                      
                       2000   1.00                      
                       2001   0.64                      
                       2002   0.78                      
                 3     1998   0.21                      
                       1999   0.54                      
                       2000   0.49                      
                       2001   2.28                      
                       2002   0.46                      
                 4     1998   0.44                      
                       1999   0.23                      
                       2000   0.26                      
                       2001   0.62                      
                       2002   0.21                      
Acadia Parish    1     1998   1.00                      
                       1999   0.83                      
                       2000   0.02                      
                       2001   1.29                      
                       2002   0.56                      
                 2     1998   0.91                      
                       1999   0.76                      
                       2000   0.45                      
                       2001   0.07                      
                       2002   0.56                      
                 3     1998   0.44                      
                       1999   0.08                      
                       2000   3.13                      
                       2001   0.41                      
                       2002   0.48                      
                 4     1998   0.25                      
                       1999   7.36                      
                       2000   0.19                      
                       2001   0.17                      
                       2002   0.32                      
Accomack County  1     1998   0.07                      
                       1999   0.50                      
                       2000   0.56                      
                       2001   0.53                      
                       2002   0.45                      
                 2     1998   0.66                      
                       1999   0.63                      
                       2000   0.49                      
                       2001   0.36                      
                       2002   0.48                      
2023-07-06 14:32:54,957 - main.py[line:612] - INFO: relative error normalized:
                               avg(ss_ext_sales_price)
ca_county        d_qoy d_year                         
Abbeville County 1     1998   0.14                    
                       1999   0.26                    
                       2000   0.19                    
                       2001   1.00                    
                       2002   0.15                    
                 2     1998   0.30                    
                       1999   0.25                    
                       2000   1.00                    
                       2001   0.10                    
                       2002   0.18                    
                 3     1998   0.31                    
                       1999   0.31                    
                       2000   0.22                    
                       2001   0.13                    
                       2002   0.00                    
                 4     1998   0.20                    
                       1999   0.03                    
                       2000   0.07                    
                       2001   0.25                    
                       2002   0.08                    
Acadia Parish    1     1998   1.00                    
                       1999   0.13                    
                       2000   0.19                    
                       2001   0.12                    
                       2002   0.05                    
                 2     1998   0.07                    
                       1999   0.37                    
                       2000   0.21                    
                       2001   0.11                    
                       2002   0.18                    
                 3     1998   0.07                    
                       1999   0.36                    
                       2000   0.04                    
                       2001   0.05                    
                       2002   0.39                    
                 4     1998   0.07                    
                       1999   0.29                    
                       2000   0.09                    
                       2001   0.18                    
                       2002   0.03                    
Accomack County  1     1998   0.25                    
                       1999   0.07                    
                       2000   0.02                    
                       2001   0.04                    
                       2002   0.36                    
                 2     1998   0.24                    
                       1999   0.10                    
                       2000   0.02                    
                       2001   0.16                    
                       2002   0.13                    
2023-07-06 14:32:54,957 - main.py[line:615] - INFO: relative error average: 0.490432631014601
2023-07-06 14:32:54,957 - main.py[line:616] - INFO: relative error normalized average: 0.2417786615682377
2023-07-06 14:32:55,010 - main.py[line:662] - INFO: total_time:23.477988068014383