main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-06-26 10:24:50,543 - main.py[line:642] - INFO: load query config config/tpcds_whole/query/sql31.json successfully
2023-06-26 10:24:50,543 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/31_store_sales.json successfully
2023-06-26 10:24:50,543 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/3_date_dim.json successfully
2023-06-26 10:24:50,543 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/94_customer_address.json successfully
2023-06-26 10:24:50,543 - dataset_utils.py[line:585] - INFO: load existing dataset(light):31-store_sales_ss_addr_sk#ss_sold_date_sk_ss_ext_sales_price_ss_addr_sk_binary_mm_0
2023-06-26 10:24:51,438 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:0.8950894479639828
2023-06-26 10:24:51,438 - pytorch_cvae.py[line:280] - INFO: feature info:[('ss_ext_sales_price', 'numerical', 1), ('ss_addr_sk', 'categorical', 17), ('ss_sold_date_sk', 'categorical', 12)]
2023-06-26 10:24:51,440 - model_utils.py[line:75] - INFO: load model name:torch_cvae_31-store_sales_ss_addr_sk_ld100_id100_bs128_ep20_0_binary_mm
2023-06-26 10:24:53,481 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.041951711056754
2023-06-26 10:24:53,482 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:2.9386169349309057
2023-06-26 10:24:53,482 - dataset_utils.py[line:585] - INFO: load existing dataset(light):3-date_dim_d_date_sk#d_year#d_qoy__d_date_sk#d_year#d_qoy_binary_gaussian5_0
2023-06-26 10:24:53,542 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:0.05988957593217492
2023-06-26 10:24:53,542 - pytorch_cvae.py[line:280] - INFO: feature info:[('d_date_sk', 'categorical', 18), ('d_year', 'categorical', 9), ('d_qoy', 'categorical', 3)]
2023-06-26 10:24:53,542 - model_utils.py[line:75] - INFO: load model name:torch_cvae_3-date_dim_d_date_sk_d_year_d_qoy_ld100_id150_bs128_ep100_0_binary_gaussian5
2023-06-26 10:24:53,544 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0016777939163148403
2023-06-26 10:24:53,544 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.0625367418397218
2023-06-26 10:24:53,544 - dataset_utils.py[line:585] - INFO: load existing dataset(light):94-customer_address_ca_address_sk#ca_county__ca_address_sk#ca_county_binary_gaussian5_0
2023-06-26 10:24:53,581 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:0.03677932498976588
2023-06-26 10:24:53,581 - pytorch_cvae.py[line:280] - INFO: feature info:[('ca_address_sk', 'categorical', 17), ('ca_county', 'categorical', 12)]
2023-06-26 10:24:53,582 - model_utils.py[line:75] - INFO: load model name:torch_cvae_94-customer_address_ca_address_sk_ca_county_ld100_id150_bs128_ep100_0_binary_gaussian5
2023-06-26 10:24:53,584 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0016339709982275963
2023-06-26 10:24:53,584 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.039446810027584434
2023-06-26 10:24:53,584 - main.py[line:572] - INFO: multi_sampling No.0 epoch
2023-06-26 10:24:53,589 - main.py[line:572] - INFO: multi_sampling No.1 epoch
2023-06-26 10:24:53,610 - main.py[line:572] - INFO: multi_sampling No.2 epoch
2023-06-26 10:27:49,551 - pytorch_cvae.py[line:407] - INFO: sampling time:175.45543000800535
2023-06-26 10:27:49,557 - dataset_utils.py[line:566] - INFO: load existing dataset:3-date_dim_d_date_sk#d_year#d_qoy__d_date_sk#d_year#d_qoy_binary_gaussian5_0
2023-06-26 10:27:49,959 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.4021420581266284
2023-06-26 10:27:49,960 - dataset_utils.py[line:566] - INFO: load existing dataset:94-customer_address_ca_address_sk#ca_county__ca_address_sk#ca_county_binary_gaussian5_0
2023-06-26 10:27:50,025 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.06554022501222789
2023-06-26 10:27:50,286 - main.py[line:555] - INFO: sample and aggregation time elapsed:176.70213705394417
2023-06-26 10:27:50,443 - pytorch_cvae.py[line:407] - INFO: sampling time:176.31383194890805
2023-06-26 10:27:50,443 - dataset_utils.py[line:566] - INFO: load existing dataset:3-date_dim_d_date_sk#d_year#d_qoy__d_date_sk#d_year#d_qoy_binary_gaussian5_0
2023-06-26 10:27:50,469 - pytorch_cvae.py[line:407] - INFO: sampling time:176.33507411112078
2023-06-26 10:27:50,474 - dataset_utils.py[line:566] - INFO: load existing dataset:3-date_dim_d_date_sk#d_year#d_qoy__d_date_sk#d_year#d_qoy_binary_gaussian5_0
2023-06-26 10:27:50,523 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.07952824397943914
2023-06-26 10:27:50,524 - dataset_utils.py[line:566] - INFO: load existing dataset:94-customer_address_ca_address_sk#ca_county__ca_address_sk#ca_county_binary_gaussian5_0
2023-06-26 10:27:50,577 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.05375765706412494
2023-06-26 10:27:50,675 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.2013041260652244
2023-06-26 10:27:50,678 - dataset_utils.py[line:566] - INFO: load existing dataset:94-customer_address_ca_address_sk#ca_county__ca_address_sk#ca_county_binary_gaussian5_0
2023-06-26 10:27:50,804 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.12563201505690813
2023-06-26 10:27:50,952 - main.py[line:555] - INFO: sample and aggregation time elapsed:177.3364812838845
2023-06-26 10:27:50,968 - main.py[line:555] - INFO: sample and aggregation time elapsed:177.37336834706366
2023-06-26 10:27:51,008 - main.py[line:593] - INFO: sample time: 177.42388553312048
2023-06-26 10:27:51,151 - main.py[line:104] - INFO: aqp result:
                               avg(ss_ext_sales_price)  \
ca_county        d_qoy d_year                            
Abbeville County 1     1998   2426.87                    
                       1999   1775.75                    
                       2000   2036.69                    
                       2001   1842.79                    
                       2002   1492.97                    
                       2003   2212.57                    
                 2     1998   1795.76                    
                       1999   1677.87                    
                       2000   1685.01                    
                       2001   2077.92                    
                       2002   1377.79                    
                 3     1998   1527.42                    
                       1999   1707.92                    
                       2000   2270.87                    
                       2001   1578.49                    
                       2002   2330.53                    
                 4     1998   1831.24                    
                       1999   2174.22                    
                       2000   1942.44                    
                       2001   1815.22                    
                       2002   1957.38                    
Acadia Parish    1     1998   2555.28                    
                       1999   1557.46                    
                       2000   3502.08                    
                       2001   2537.09                    
                       2002   1592.28                    
                 2     1998   1523.83                    
                       1999   1568.86                    
                       2000   2247.63                    
                       2001   1622.87                    
                       2002   2047.55                    
                 3     1998   2139.71                    
                       1999   2667.32                    
                       2000   1959.01                    
                       2001   2014.76                    
                       2002   2396.26                    
                 4     1998   1816.50                    
                       1999   1700.07                    
                       2000   1723.14                    
                       2001   2746.79                    
                       2002   1885.50                    
Accomack County  1     1998   1896.67                    
                       1999   2771.61                    
                       2000   2004.10                    
                       2001   1757.71                    
                       2002   2591.29                    
                 2     1998   1808.36                    
                       1999   1679.77                    
                       2000   2995.00                    
                       2001   2035.68                    

                               sum(ss_ext_sales_price)  
ca_county        d_qoy d_year                           
Abbeville County 1     1998   29046.99                  
                       1999   50144.71                  
                       2000   51885.94                  
                       2001   46000.09                  
                       2002   26189.20                  
                       2003   36227.02                  
                 2     1998   46764.73                  
                       1999   106900.33                 
                       2000   56026.83                  
                       2001   45933.68                  
                       2002   28209.09                  
                 3     1998   42464.33                  
                       1999   20789.37                  
                       2000   85757.26                  
                       2001   61351.83                  
                       2002   105745.51                 
                 4     1998   93496.54                  
                       1999   120881.82                 
                       2000   123233.49                 
                       2001   84753.99                  
                       2002   94690.04                  
Acadia Parish    1     1998   79858.19                  
                       1999   16808.50                  
                       2000   42926.05                  
                       2001   69818.76                  
                       2002   36900.65                  
                 2     1998   42607.63                  
                       1999   41881.04                  
                       2000   55251.87                  
                       2001   18289.62                  
                       2002   29212.19                  
                 3     1998   55743.83                  
                       1999   98372.79                  
                       2000   86319.66                  
                       2001   108308.29                 
                       2002   60310.72                  
                 4     1998   62210.90                  
                       1999   107812.84                 
                       2000   54196.12                  
                       2001   151354.65                 
                       2002   83360.14                  
Accomack County  1     1998   56574.36                  
                       1999   80813.24                  
                       2000   111456.80                 
                       2001   108389.23                 
                       2002   105161.93                 
                 2     1998   44843.11                  
                       1999   46018.38                  
                       2000   66943.43                  
                       2001   23002.87                  
2023-06-26 10:27:51,153 - main.py[line:105] - INFO: ground truth:
                               avg(ss_ext_sales_price)  \
ca_county        d_qoy d_year                            
Abbeville County 1     1998   2575.54                    
                       1999   3222.64                    
                       2000   2414.06                    
                       2002   1227.44                    
                 2     1998   1262.44                    
                       1999   2543.76                    
                       2001   2016.83                    
                       2002   2582.07                    
                 3     1998   2273.00                    
                       1999   2391.61                    
                       2000   1486.80                    
                       2001   1674.54                    
                       2002   1744.80                    
                 4     1998   1690.76                    
                       1999   1763.30                    
                       2000   2231.39                    
                       2001   2233.14                    
                       2002   1943.08                    
Acadia Parish    1     1999   2344.91                    
                       2000   2145.00                    
                       2001   1505.00                    
                       2002   1891.84                    
                 2     1998   1653.43                    
                       1999   2938.58                    
                       2000   1687.40                    
                       2001   2117.83                    
                       2002   2070.82                    
                 3     1998   2095.42                    
                       1999   1271.28                    
                       2000   1683.24                    
                       2001   1886.29                    
                       2002   3579.21                    
                 4     1998   2005.19                    
                       1999   2327.17                    
                       2000   1681.00                    
                       2001   1569.02                    
                       2002   1970.78                    
Accomack County  1     1998   2344.26                    
                       1999   1848.02                    
                       2000   2067.95                    
                       2001   2010.00                    
                       2002   3704.40                    
                 2     1998   2092.60                    
                       1999   1861.78                    
                       2000   1794.12                    
                       2001   2603.73                    
                       2002   2020.77                    
                 3     1998   1733.90                    
                       1999   2459.50                    
                       2000   1716.79                    

                               sum(ss_ext_sales_price)  
ca_county        d_qoy d_year                           
Abbeville County 1     1998    95295                    
                       1999    35449                    
                       2000    43453                    
                       2002    11047                    
                 2     1998    40398                    
                       1999    43244                    
                       2001    24202                    
                       2002    118775                   
                 3     1998    45460                    
                       1999    133930                   
                       2000    60959                    
                       2001    21769                    
                       2002    71537                    
                 4     1998    155550                   
                       1999    77585                    
                       2000    51322                    
                       2001    209915                   
                       2002    75780                    
Acadia Parish    1     1999    25794                    
                       2000    55770                    
                       2001    15050                    
                       2002    69998                    
                 2     1998    11574                    
                       1999    70526                    
                       2000    75933                    
                       2001    76242                    
                       2002    70408                    
                 3     1998    69149                    
                       1999    72463                    
                       2000    28615                    
                       2001    149017                   
                       2002    85901                    
                 4     1998    116301                   
                       1999    13963                    
                       2000    60516                    
                       2001    70606                    
                       2002    126130                   
Accomack County  1     1998    82049                    
                       1999    81313                    
                       2000    134417                   
                       2001    72360                    
                       2002    37044                    
                 2     1998    98352                    
                       1999    111707                   
                       2000    86118                    
                       2001    85923                    
                       2002    86893                    
                 3     1998    136978                   
                       1999    88542                    
                       2000    49787                    
2023-06-26 10:27:51,293 - main.py[line:611] - INFO: relative error:
                               avg(ss_ext_sales_price)  \
ca_county        d_qoy d_year                            
Abbeville County 1     1998   0.06                       
                       1999   0.45                       
                       2000   0.16                       
                       2001   1.00                       
                       2002   0.22                       
                       2003   1.00                       
                 2     1998   0.42                       
                       1999   0.34                       
                       2000   1.00                       
                       2001   0.03                       
                       2002   0.47                       
                 3     1998   0.33                       
                       1999   0.29                       
                       2000   0.53                       
                       2001   0.06                       
                       2002   0.34                       
                 4     1998   0.08                       
                       1999   0.23                       
                       2000   0.13                       
                       2001   0.19                       
                       2002   0.01                       
Acadia Parish    1     1998   1.00                       
                       1999   0.34                       
                       2000   0.63                       
                       2001   0.69                       
                       2002   0.16                       
                 2     1998   0.08                       
                       1999   0.47                       
                       2000   0.33                       
                       2001   0.23                       
                       2002   0.01                       
                 3     1998   0.02                       
                       1999   1.10                       
                       2000   0.16                       
                       2001   0.07                       
                       2002   0.33                       
                 4     1998   0.09                       
                       1999   0.27                       
                       2000   0.03                       
                       2001   0.75                       
                       2002   0.04                       
Accomack County  1     1998   0.19                       
                       1999   0.50                       
                       2000   0.03                       
                       2001   0.13                       
                       2002   0.30                       
                 2     1998   0.14                       
                       1999   0.10                       
                       2000   0.67                       
                       2001   0.22                                           
2023-06-26 10:27:51,295 - main.py[line:612] - INFO: relative error normalized:
                               avg(ss_ext_sales_price)
ca_county        d_qoy d_year                         
Abbeville County 1     1998   0.06                    
                       1999   0.36                    
                       2000   0.14                    
                       2001   1.00                    
                       2002   0.19                    
                       2003   1.00                    
                 2     1998   0.34                    
                       1999   0.29                    
                       2000   1.00                    
                       2001   0.03                    
                       2002   0.37                    
                 3     1998   0.28                    
                       1999   0.25                    
                       2000   0.41                    
                       2001   0.06                    
                       2002   0.29                    
                 4     1998   0.08                    
                       1999   0.21                    
                       2000   0.12                    
                       2001   0.17                    
                       2002   0.01                    
Acadia Parish    1     1998   1.00                    
                       1999   0.29                    
                       2000   0.47                    
                       2001   0.50                    
                       2002   0.15                    
                 2     1998   0.08                    
                       1999   0.37                    
                       2000   0.28                    
                       2001   0.21                    
                       2002   0.01                    
                 3     1998   0.02                    
                       1999   0.67                    
                       2000   0.15                    
                       2001   0.07                    
                       2002   0.28                    
                 4     1998   0.09                    
                       1999   0.24                    
                       2000   0.02                    
                       2001   0.53                    
                       2002   0.04                    
Accomack County  1     1998   0.17                    
                       1999   0.39                    
                       2000   0.03                    
                       2001   0.12                    
                       2002   0.26                    
                 2     1998   0.13                    
                       1999   0.09                    
                       2000   0.49                    
                       2001   0.20                    
2023-06-26 10:27:51,295 - main.py[line:615] - INFO: relative error average: 0.2526197003513553
2023-06-26 10:27:51,295 - main.py[line:616] - INFO: relative error normalized average: 0.2543380254576707
2023-06-26 10:27:51,309 - main.py[line:662] - INFO: total_time:180.76677323691547