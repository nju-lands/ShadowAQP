main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-06-07 13:56:33,728 - main.py[line:618] - INFO: load query config config/tpcds_whole/query/sql77.json successfully
2023-06-07 13:56:33,728 - main.py[line:625] - INFO: load train config ./config/tpcds_whole/train/77_store_sales.json successfully
2023-06-07 13:56:33,729 - main.py[line:625] - INFO: load train config ./config/tpcds_whole/train/3_date_dim.json successfully
2023-06-07 13:56:33,729 - main.py[line:625] - INFO: load train config ./config/tpcds_whole/train/77_store.json successfully
2023-06-07 13:56:33,729 - pytorch_cvae.py[line:249] - INFO: epoch:1
2023-06-07 13:56:33,729 - pytorch_cvae.py[line:250] - INFO: batch size:128
2023-06-07 13:56:33,729 - pytorch_cvae.py[line:251] - INFO: latent dimension:100
2023-06-07 13:56:33,729 - pytorch_cvae.py[line:252] - INFO: intermediate dimension:100
2023-06-07 13:56:33,729 - pytorch_cvae.py[line:253] - INFO: gpu num:0
2023-06-07 13:56:33,738 - dataset_utils.py[line:310] - INFO: loading data:/home/lihan/train_dataset/tpcds_whole_1G/store_sales.csv
2023-06-07 13:58:03,742 - dataset_utils.py[line:335] - INFO: data total rows:2622544
2023-06-07 13:58:03,742 - dataset_utils.py[line:367] - INFO: sample the training data sample rows:2622544
2023-06-07 13:58:03,742 - dataset_utils.py[line:371] - INFO: load data time elapsed:90.0039995261468
2023-06-07 13:58:05,152 - dataset_utils.py[line:43] - INFO: encode categorical columns time elapsed:1.408731162082404
/root/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/mixture/base.py:273: ConvergenceWarning: Initialization 1 did not converge. Try different init parameters, or increase max_iter, tol or check for degenerate data.
  % (init + 1), ConvergenceWarning)
/root/anaconda3/envs/py36/lib/python3.6/site-packages/sklearn/mixture/base.py:273: ConvergenceWarning: Initialization 1 did not converge. Try different init parameters, or increase max_iter, tol or check for degenerate data.
  % (init + 1), ConvergenceWarning)
2023-06-07 14:02:55,726 - dataset_utils.py[line:56] - INFO: encode numeric columnstime elapsed:290.57469313871115
2023-06-07 14:02:56,600 - dataset_utils.py[line:107] - INFO: data shape:(2622544, 28)
2023-06-07 14:02:56,600 - dataset_utils.py[line:136] - INFO: feature info:[('ss_ext_sales_price', 'numerical', 6), ('ss_net_profit', 'numerical', 6), ('ss_sold_date_sk', 'categorical', 12), ('ss_store_sk', 'categorical', 4)]
2023-06-07 14:02:56,600 - dataset_utils.py[line:137] - INFO: output info list:[(1, 'no'), (5, 'softmax'), (1, 'no'), (5, 'softmax'), (12, 'sigmoid'), (4, 'sigmoid')]
2023-06-07 14:02:58,866 - dataset_utils.py[line:140] - INFO: load data successfully
2023-06-07 14:02:58,867 - pytorch_cvae.py[line:258] - INFO: feature info:[('ss_ext_sales_price', 'numerical', 6), ('ss_net_profit', 'numerical', 6), ('ss_sold_date_sk', 'categorical', 12), ('ss_store_sk', 'categorical', 4)]
2023-06-07 14:05:55,073 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-06-07 14:05:55,073 - pytorch_cvae.py[line:177] - INFO: loss:4524.1279819607735, numeric_loss:247.78119748597965, categorical_loss:1230.9243897929555, kld_loss:564975.9375500679, epoch_train_time:176.2025649258867
2023-06-07 14:05:55,073 - pytorch_cvae.py[line:186] - INFO: training time elapsed:176.20341248018667
2023-06-07 14:05:55,075 - model_utils.py[line:67] - INFO: save model successfully
2023-06-07 14:06:03,387 - pytorch_cvae.py[line:268] - INFO: train model time elapsed:569.6576447859406
2023-06-07 14:06:03,395 - dataset_utils.py[line:584] - INFO: load existing dataset(light):3-date_dim_d_date_sk#d_year__d_date_sk#d_year_binary_gaussian5_0
2023-06-07 14:06:03,459 - dataset_utils.py[line:593] - INFO: load dataset(light) time elapsed:0.06458300305530429
2023-06-07 14:06:03,459 - pytorch_cvae.py[line:280] - INFO: feature info:[('d_date_sk', 'categorical', 18), ('d_year', 'categorical', 9)]
2023-06-07 14:06:03,460 - model_utils.py[line:75] - INFO: load model name:torch_cvae_3-date_dim_d_date_sk_d_year_ld100_id150_bs128_ep100_0_binary_gaussian5
2023-06-07 14:06:03,463 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0024666483514010906
2023-06-07 14:06:03,463 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.06802868191152811
2023-06-07 14:06:03,463 - pytorch_cvae.py[line:249] - INFO: epoch:1
2023-06-07 14:06:03,463 - pytorch_cvae.py[line:250] - INFO: batch size:128
2023-06-07 14:06:03,463 - pytorch_cvae.py[line:251] - INFO: latent dimension:100
2023-06-07 14:06:03,463 - pytorch_cvae.py[line:252] - INFO: intermediate dimension:150
2023-06-07 14:06:03,463 - pytorch_cvae.py[line:253] - INFO: gpu num:0
2023-06-07 14:07:33,455 - dataset_utils.py[line:310] - INFO: loading data:/home/lihan/train_dataset/tpcds_whole_1G/store.csv
2023-06-07 14:07:33,462 - dataset_utils.py[line:335] - INFO: data total rows:12
2023-06-07 14:07:33,463 - dataset_utils.py[line:371] - INFO: load data time elapsed:0.007388263009488583
2023-06-07 14:07:33,468 - dataset_utils.py[line:43] - INFO: encode categorical columns time elapsed:0.0058950381353497505
2023-06-07 14:07:33,469 - dataset_utils.py[line:56] - INFO: encode numeric columnstime elapsed:5.019828677177429e-07
2023-06-07 14:07:33,469 - dataset_utils.py[line:107] - INFO: data shape:(12, 4)
2023-06-07 14:07:33,469 - dataset_utils.py[line:136] - INFO: feature info:[('s_store_sk', 'categorical', 4)]
2023-06-07 14:07:33,469 - dataset_utils.py[line:137] - INFO: output info list:[(4, 'sigmoid')]
2023-06-07 14:07:33,469 - dataset_utils.py[line:140] - INFO: load data successfully
2023-06-07 14:07:33,469 - pytorch_cvae.py[line:258] - INFO: feature info:[('s_store_sk', 'categorical', 4)]
2023-06-07 14:07:33,924 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-06-07 14:07:33,924 - pytorch_cvae.py[line:177] - INFO: loss:0.665485143661499, numeric_loss:0.0, categorical_loss:0.652310848236084, kld_loss:2.4440464973449707, epoch_train_time:0.4542437940835953
2023-06-07 14:07:33,924 - pytorch_cvae.py[line:186] - INFO: training time elapsed:0.45488598803058267
2023-06-07 14:07:33,926 - model_utils.py[line:67] - INFO: save model successfully
2023-06-07 14:07:33,927 - pytorch_cvae.py[line:268] - INFO: train model time elapsed:0.4718861738219857
