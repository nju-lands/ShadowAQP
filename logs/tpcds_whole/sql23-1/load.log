main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-06-20 07:36:41,772 - main.py[line:642] - INFO: load query config config/tpcds_whole/query/sql23-1.json successfully
2023-06-20 07:36:41,773 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/23_store_sales.json successfully
2023-06-20 07:36:41,773 - main.py[line:649] - INFO: load train config ./config/tpcds_whole/train/23_customer.json successfully
2023-06-20 07:36:41,773 - dataset_utils.py[line:585] - INFO: load existing dataset(light):23-store_sales_ss_customer_sk_ss_sales_price#ss_quantity_ss_customer_sk_binary_mm_0
2023-06-20 07:36:42,694 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:0.9208460520021617
2023-06-20 07:36:42,694 - pytorch_cvae.py[line:280] - INFO: feature info:[('ss_sales_price', 'numerical', 1), ('ss_quantity', 'numerical', 1), ('ss_customer_sk', 'categorical', 18)]
2023-06-20 07:36:42,695 - model_utils.py[line:75] - INFO: load model name:torch_cvae_23-store_sales_ss_customer_sk_ld100_id100_bs128_ep10_0_binary_mm
2023-06-20 07:36:44,724 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0289371699327603
2023-06-20 07:36:44,724 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:2.9513963300269097
2023-06-20 07:36:44,724 - dataset_utils.py[line:585] - INFO: load existing dataset(light):23-customer_c_customer_sk__c_customer_sk_binary_gaussian5_0
2023-06-20 07:36:44,779 - dataset_utils.py[line:594] - INFO: load dataset(light) time elapsed:0.054886842030100524
2023-06-20 07:36:44,779 - pytorch_cvae.py[line:280] - INFO: feature info:[('c_customer_sk', 'categorical', 18)]
2023-06-20 07:36:44,780 - model_utils.py[line:75] - INFO: load model name:torch_cvae_23-customer_c_customer_sk_ld100_id150_bs128_ep100_0_binary_gaussian5
2023-06-20 07:36:44,781 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0015744050033390522
2023-06-20 07:36:44,781 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.05736996699124575
2023-06-20 07:36:44,781 - main.py[line:572] - INFO: multi_sampling No.0 epoch
2023-06-20 07:36:44,787 - main.py[line:572] - INFO: multi_sampling No.1 epoch
2023-06-20 07:36:44,807 - main.py[line:572] - INFO: multi_sampling No.2 epoch
2023-06-20 07:41:56,166 - pytorch_cvae.py[line:407] - INFO: sampling time:310.964880213025
2023-06-20 07:41:56,174 - dataset_utils.py[line:566] - INFO: load existing dataset:23-customer_c_customer_sk__c_customer_sk_binary_gaussian5_0
2023-06-20 07:41:56,717 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.5427328930236399
2023-06-20 07:41:57,622 - pytorch_cvae.py[line:407] - INFO: sampling time:312.2964051619638
2023-06-20 07:41:57,636 - dataset_utils.py[line:566] - INFO: load existing dataset:23-customer_c_customer_sk__c_customer_sk_binary_gaussian5_0
2023-06-20 07:41:57,839 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.2027303179493174
2023-06-20 07:41:58,070 - main.py[line:555] - INFO: sample and aggregation time elapsed:313.2778343260288
2023-06-20 07:41:58,079 - pytorch_cvae.py[line:407] - INFO: sampling time:312.8689338610275
2023-06-20 07:41:58,081 - dataset_utils.py[line:566] - INFO: load existing dataset:23-customer_c_customer_sk__c_customer_sk_binary_gaussian5_0
2023-06-20 07:41:58,159 - dataset_utils.py[line:578] - INFO: load dataset time elapsed:0.07843015203252435
2023-06-20 07:41:58,214 - main.py[line:555] - INFO: sample and aggregation time elapsed:313.3805439870339
2023-06-20 07:41:58,250 - main.py[line:555] - INFO: sample and aggregation time elapsed:313.46803817199543
2023-06-20 07:41:58,276 - main.py[line:593] - INFO: sample time: 313.4941190041136
2023-06-20 07:41:58,323 - main.py[line:104] - INFO: aqp result:
               avg(ss_quantity)  avg(ss_sales_price)  sum(ss_quantity)  \
c_customer_sk                                                            
1             51.97             68.57                383.02              
2             53.56             39.15                1842.39             
3             40.08             37.28                361.07              
4             73.83             31.92                544.20              
5             38.66             61.52                1393.25             
6             29.05             42.83                404.50              
7             46.97             44.56                2653.99             
10            35.63             42.89                466.83              
11            46.77             36.84                1225.60             
12            41.96             27.33                446.72              
14            44.12             22.60                1228.46             
15            58.95             47.06                1593.06             
16            58.41             34.63                2678.63             
17            54.20             37.53                1109.69             
18            70.30             42.35                1208.94             
19            49.70             36.34                1139.75             
20            42.55             43.35                1184.70             
21            46.35             44.02                1062.77             
22            65.61             51.52                1182.03             
23            41.00             42.65                1645.37             
24            44.02             41.44                540.77              
25            65.94             40.63                432.04              
27            34.77             32.16                341.66              
28            54.24             28.78                577.44              
29            50.29             47.39                947.25              
30            71.03             38.35                1628.82             
31            54.82             31.94                1212.22             
32            45.07             24.20                848.85              
33            60.88             55.49                1545.50             
34            50.46             27.13                1900.79             
35            76.76             35.82                2514.63             
36            34.59             56.89                623.24              
37            42.30             36.08                346.38              
38            46.48             35.94                1179.93             
39            37.39             28.13                2327.30             
40            40.97             39.31                234.88              
41            66.95             38.36                328.99              
42            58.41             40.10                1483.01             
43            60.42             28.66                346.39              
44            51.63             45.10                930.28              
45            48.78             39.80                1158.51             
46            46.08             53.51                301.93              
47            54.31             48.93                1156.48             
48            62.14             53.13                407.15              
49            36.62             66.32                1139.55             
50            56.15             40.70                505.86              
51            62.54             54.06                870.63              
52            34.20             31.56                644.17              
53            66.49             32.36                2722.60             
54            41.06             49.04                302.67              

               sum(ss_sales_price)  
c_customer_sk                       
1             505.40                
2             1346.68               
3             335.80                
4             235.27                
5             2216.80               
6             596.26                
7             2517.88               
10            561.99                
11            965.54                
12            290.93                
14            629.28                
15            1271.87               
16            1588.34               
17            768.32                
18            728.29                
19            833.21                
20            1207.08               
21            1009.34               
22            928.30                
23            1711.52               
24            509.01                
25            266.17                
27            316.02                
28            306.39                
29            892.67                
30            879.44                
31            706.31                
32            455.85                
33            1408.77               
34            1021.88               
35            1173.57               
36            1024.93               
37            295.47                
38            912.52                
39            1751.03               
40            225.35                
41            188.48                
42            1018.14               
43            164.31                
44            812.53                
45            945.35                
46            350.60                
47            1041.83               
48            348.12                
49            2063.75               
50            366.68                
51            752.59                
52            594.39                
53            1325.19               
54            361.47                
2023-06-20 07:41:58,329 - main.py[line:105] - INFO: ground truth:
               avg(ss_quantity)  avg(ss_sales_price)  sum(ss_quantity)  \
c_customer_sk                                                            
1             52.00             54.33                 468                
2             44.40             40.93                 1865               
3             47.27             39.91                 520                
4             59.44             34.56                 535                
5             56.30             48.59                 2477               
6             53.44             59.39                 962                
7             42.37             37.13                 2966               
10            53.69             44.12                 859                
11            40.84             42.19                 1307               
12            52.14             39.21                 730                
14            46.03             32.76                 1565               
15            48.03             39.56                 1633               
16            50.18             40.61                 2860               
17            46.16             45.80                 1154               
18            53.90             31.00                 1132               
19            49.59             40.93                 1438               
20            45.12             44.71                 1534               
21            51.46             45.93                 1441               
22            38.23             42.86                 841                
23            50.08             42.04                 2454               
24            41.07             47.00                 616                
25            53.62             28.50                 429                
27            64.00             31.92                 768                
28            39.54             44.15                 514                
29            54.12             42.38                 1299               
30            45.00             35.29                 1260               
31            45.63             31.22                 1232               
32            51.43             30.87                 1183               
33            45.13             40.94                 1399               
34            56.17             46.79                 2696               
35            54.42             44.35                 2177               
36            59.32             52.41                 1305               
37            53.40             20.50                 534                
38            49.12             48.75                 1572               
39            49.49             34.47                 3811               
40            69.43             18.57                 486                
41            66.00             26.50                 528                
42            56.81             41.39                 1761               
43            43.14             38.14                 302                
44            44.09             43.48                 1014               
45            47.48             32.00                 1377               
46            48.88             55.00                 391                
47            51.77             32.31                 1346               
48            38.50             24.00                 308                
49            53.05             43.37                 2016               
50            52.75             36.50                 633                
51            51.35             27.71                 873                
52            57.65             28.78                 1326               
53            53.10             33.42                 2655               
54            48.22             39.00                 434                

               sum(ss_sales_price)  
c_customer_sk                       
1              489                  
2              1719                 
3              439                  
4              311                  
5              2138                 
6              1069                 
7              2599                 
10             706                  
11             1350                 
12             549                  
14             1114                 
15             1345                 
16             2315                 
17             1145                 
18             651                  
19             1187                 
20             1520                 
21             1286                 
22             943                  
23             2060                 
24             705                  
25             228                  
27             383                  
28             574                  
29             1017                 
30             988                  
31             843                  
32             710                  
33             1269                 
34             2246                 
35             1774                 
36             1153                 
37             205                  
38             1560                 
39             2654                 
40             130                  
41             212                  
42             1283                 
43             267                  
44             1000                 
45             928                  
46             440                  
47             840                  
48             192                  
49             1648                 
50             438                  
51             471                  
52             662                  
53             1671                 
54             351                  
2023-06-20 07:41:58,377 - main.py[line:611] - INFO: relative error:
               avg(ss_quantity)  avg(ss_sales_price)  sum(ss_quantity)  \
c_customer_sk                                                            
1             0.00              0.26                 0.18                
2             0.21              0.04                 0.01                
3             0.15              0.07                 0.31                
4             0.24              0.08                 0.02                
5             0.31              0.27                 0.44                
6             0.46              0.28                 0.58                
7             0.11              0.20                 0.11                
10            0.34              0.03                 0.46                
11            0.15              0.13                 0.06                
12            0.20              0.30                 0.39                
14            0.04              0.31                 0.22                
15            0.23              0.19                 0.02                
16            0.16              0.15                 0.06                
17            0.17              0.18                 0.04                
18            0.30              0.37                 0.07                
19            0.00              0.11                 0.21                
20            0.06              0.03                 0.23                
21            0.10              0.04                 0.26                
22            0.72              0.20                 0.41                
23            0.18              0.01                 0.33                
24            0.07              0.12                 0.12                
25            0.23              0.43                 0.01                
27            0.46              0.01                 0.56                
28            0.37              0.35                 0.12                
29            0.07              0.12                 0.27                
30            0.58              0.09                 0.29                
31            0.20              0.02                 0.02                
32            0.12              0.22                 0.28                
33            0.35              0.36                 0.10                
34            0.10              0.42                 0.29                
35            0.41              0.19                 0.16                
36            0.42              0.09                 0.52                
37            0.21              0.76                 0.35                
38            0.05              0.26                 0.25                
39            0.24              0.18                 0.39                
40            0.41              1.12                 0.52                
41            0.01              0.45                 0.38                
42            0.03              0.03                 0.16                
43            0.40              0.25                 0.15                
44            0.17              0.04                 0.08                
45            0.03              0.24                 0.16                
46            0.06              0.03                 0.23                
47            0.05              0.51                 0.14                
48            0.61              1.21                 0.32                
49            0.31              0.53                 0.43                
50            0.06              0.12                 0.20                
51            0.22              0.95                 0.00                
52            0.41              0.10                 0.51                
53            0.25              0.03                 0.03                
54            0.15              0.26                 0.30                

               sum(ss_sales_price)  
c_customer_sk                       
1             0.03                  
2             0.22                  
3             0.24                  
4             0.24                  
5             0.04                  
6             0.44                  
7             0.03                  
10            0.20                  
11            0.28                  
12            0.47                  
14            0.44                  
15            0.05                  
16            0.31                  
17            0.33                  
18            0.12                  
19            0.30                  
20            0.21                  
21            0.22                  
22            0.02                  
23            0.17                  
24            0.28                  
25            0.17                  
27            0.17                  
28            0.47                  
29            0.12                  
30            0.11                  
31            0.16                  
32            0.36                  
33            0.11                  
34            0.55                  
35            0.34                  
36            0.11                  
37            0.44                  
38            0.42                  
39            0.34                  
40            0.73                  
41            0.11                  
42            0.21                  
43            0.38                  
44            0.19                  
45            0.02                  
46            0.20                  
47            0.24                  
48            0.81                  
49            0.25                  
50            0.16                  
51            0.60                  
52            0.10                  
53            0.21                  
54            0.03                  
2023-06-20 07:41:58,379 - main.py[line:612] - INFO: relative error normalized:
               avg(ss_quantity)  avg(ss_sales_price)  sum(ss_quantity)  \
c_customer_sk                                                            
1             0.00              0.23                 0.17                
2             0.19              0.04                 0.01                
3             0.14              0.06                 0.26                
4             0.21              0.07                 0.02                
5             0.27              0.23                 0.35                
6             0.37              0.24                 0.44                
7             0.10              0.18                 0.10                
10            0.29              0.03                 0.37                
11            0.13              0.12                 0.06                
12            0.18              0.26                 0.32                
14            0.04              0.27                 0.19                
15            0.20              0.17                 0.02                
16            0.15              0.14                 0.06                
17            0.16              0.17                 0.04                
18            0.26              0.31                 0.07                
19            0.00              0.11                 0.19                
20            0.06              0.03                 0.20                
21            0.09              0.04                 0.23                
22            0.51              0.18                 0.33                
23            0.17              0.01                 0.28                
24            0.07              0.11                 0.11                
25            0.21              0.35                 0.01                
27            0.37              0.01                 0.43                
28            0.31              0.29                 0.12                
29            0.07              0.11                 0.24                
30            0.44              0.08                 0.25                
31            0.18              0.02                 0.02                
32            0.12              0.19                 0.25                
33            0.29              0.30                 0.10                
34            0.10              0.34                 0.26                
35            0.34              0.17                 0.14                
36            0.34              0.08                 0.41                
37            0.19              0.53                 0.30                
38            0.05              0.23                 0.22                
39            0.22              0.17                 0.32                
40            0.34              0.67                 0.40                
41            0.01              0.36                 0.31                
42            0.03              0.03                 0.15                
43            0.33              0.22                 0.14                
44            0.16              0.04                 0.08                
45            0.03              0.22                 0.15                
46            0.06              0.03                 0.20                
47            0.05              0.40                 0.13                
48            0.46              0.70                 0.28                
49            0.27              0.41                 0.35                
50            0.06              0.11                 0.18                
51            0.20              0.61                 0.00                
52            0.33              0.09                 0.40                
53            0.22              0.03                 0.03                
54            0.14              0.23                 0.26                

               sum(ss_sales_price)  
c_customer_sk                       
1             0.03                  
2             0.19                  
3             0.21                  
4             0.22                  
5             0.04                  
6             0.36                  
7             0.03                  
10            0.18                  
11            0.25                  
12            0.38                  
14            0.35                  
15            0.05                  
16            0.27                  
17            0.28                  
18            0.11                  
19            0.26                  
20            0.19                  
21            0.19                  
22            0.02                  
23            0.16                  
24            0.24                  
25            0.15                  
27            0.16                  
28            0.37                  
29            0.12                  
30            0.10                  
31            0.15                  
32            0.30                  
33            0.10                  
34            0.42                  
35            0.29                  
36            0.11                  
37            0.36                  
38            0.34                  
39            0.29                  
40            0.52                  
41            0.11                  
42            0.19                  
43            0.32                  
44            0.17                  
45            0.02                  
46            0.18                  
47            0.21                  
48            0.56                  
49            0.22                  
50            0.15                  
51            0.45                  
52            0.10                  
53            0.19                  
54            0.03                  
2023-06-20 07:41:58,379 - main.py[line:615] - INFO: relative error average: 0.2688787054033672
2023-06-20 07:41:58,380 - main.py[line:616] - INFO: relative error normalized average: 0.2201140445136388
2023-06-20 07:41:58,396 - main.py[line:662] - INFO: total_time:316.6232590050204