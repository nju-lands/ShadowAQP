main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-06-02 09:49:48,794 - main.py[line:438] - INFO: load query config config/query/imdb_new.json successfully
2022-06-02 09:49:48,795 - main.py[line:445] - INFO: load train config ./config/train/imdb_ratings_torch_cvae.json successfully
2022-06-02 09:49:48,796 - main.py[line:445] - INFO: load train config ./config/train/imdb_basics_torch_cvae.json successfully
2022-06-02 09:49:48,796 - dataset_utils.py[line:562] - INFO: load existing dataset(light):imdb-ratings_r_tconst_averageRating#numVotes_r_tconst_binary_gaussian5_0
2022-06-02 09:49:52,298 - dataset_utils.py[line:571] - INFO: load dataset(light) time elapsed:3.5021662823855877
2022-06-02 09:49:52,298 - pytorch_cvae.py[line:273] - INFO: feature info:[('averageRating', 'numerical', 6), ('numVotes', 'numerical', 6), ('r_tconst', 'categorical', 22)]
2022-06-02 09:49:52,302 - model_utils.py[line:75] - INFO: load model name:torch_cvae_imdb-ratings_r_tconst_ld50_id100_bs512_ep100_0_binary_gaussian5
2022-06-02 09:49:59,749 - model_utils.py[line:86] - INFO: load torch model time elapsed:7.446710776537657
2022-06-02 09:49:59,749 - pytorch_cvae.py[line:283] - INFO: load model time elapsed:10.953668598085642
2022-06-02 09:49:59,750 - pytorch_cvae.py[line:242] - INFO: epoch:100
2022-06-02 09:49:59,750 - pytorch_cvae.py[line:243] - INFO: batch size:512
2022-06-02 09:49:59,750 - pytorch_cvae.py[line:244] - INFO: latent dimension:50
2022-06-02 09:49:59,750 - pytorch_cvae.py[line:245] - INFO: intermediate dimension:100
2022-06-02 09:49:59,750 - pytorch_cvae.py[line:246] - INFO: gpu num:0
2022-06-02 09:49:59,750 - dataset_utils.py[line:292] - INFO: loading data:/root/lihan/train_dataset/imdb/basics_simple.csv
2022-06-02 09:55:11,931 - dataset_utils.py[line:313] - INFO: data total rows:8943855
2022-06-02 09:55:11,931 - dataset_utils.py[line:345] - INFO: sample the training data sample rows:8943855
2022-06-02 09:55:11,931 - dataset_utils.py[line:349] - INFO: load data time elapsed:312.1812992952764
2022-06-02 09:58:23,314 - dataset_utils.py[line:43] - INFO: encode categorical columns time elapsed:191.37327537313104
2022-06-02 09:58:23,314 - dataset_utils.py[line:56] - INFO: encode numeric columnstime elapsed:1.3187527656555176e-06
2022-06-02 09:58:23,315 - dataset_utils.py[line:107] - INFO: data shape:(8943855, 30)
2022-06-02 09:58:23,315 - dataset_utils.py[line:136] - INFO: feature info:[('titleType', 'categorical', 5), ('b_tconst', 'categorical', 25)]
2022-06-02 09:58:23,315 - dataset_utils.py[line:137] - INFO: output info list:[(5, 'sigmoid'), (25, 'sigmoid')]
2022-06-02 09:58:24,403 - dataset_utils.py[line:140] - INFO: load data successfully
2022-06-02 09:58:24,413 - pytorch_cvae.py[line:251] - INFO: feature info:[('titleType', 'categorical', 5), ('b_tconst', 'categorical', 25)]
2022-06-02 10:00:29,238 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.1 epoch----------------------------
2022-06-02 10:00:29,238 - pytorch_cvae.py[line:176] - INFO: loss:3738.7829895094037, numeric_loss:0.0, categorical_loss:1830.6267983019352, kld_loss:353994.3544204235, epoch_train_time:124.82321779429913
2022-06-02 10:02:34,099 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.2 epoch----------------------------
2022-06-02 10:02:34,099 - pytorch_cvae.py[line:176] - INFO: loss:2673.9016016349196, numeric_loss:0.0, categorical_loss:587.6084627513774, kld_loss:350384.965508461, epoch_train_time:124.86057531833649
2022-06-02 10:04:39,242 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.3 epoch----------------------------
2022-06-02 10:04:39,242 - pytorch_cvae.py[line:176] - INFO: loss:2776.659449405968, numeric_loss:0.0, categorical_loss:567.8497631084174, kld_loss:336163.3849992752, epoch_train_time:125.14327665790915
2022-06-02 10:06:43,931 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.4 epoch----------------------------
2022-06-02 10:06:43,931 - pytorch_cvae.py[line:176] - INFO: loss:2957.5309706032276, numeric_loss:0.0, categorical_loss:588.4895031219348, kld_loss:327055.20576286316, epoch_train_time:124.68874317407608
2022-06-02 10:08:49,586 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.5 epoch----------------------------
2022-06-02 10:08:49,586 - pytorch_cvae.py[line:176] - INFO: loss:3132.3541499078274, numeric_loss:0.0, categorical_loss:606.1105580506846, kld_loss:316675.3157968521, epoch_train_time:125.65492373332381
2022-06-02 10:10:54,530 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.6 epoch----------------------------
2022-06-02 10:10:54,531 - pytorch_cvae.py[line:176] - INFO: loss:3360.3459371477365, numeric_loss:0.0, categorical_loss:653.3105681110173, kld_loss:308430.8319654465, epoch_train_time:124.94409915059805
2022-06-02 10:12:58,684 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.7 epoch----------------------------
2022-06-02 10:12:58,684 - pytorch_cvae.py[line:176] - INFO: loss:3599.481270685792, numeric_loss:0.0, categorical_loss:710.8165707048029, kld_loss:299447.14394569397, epoch_train_time:124.15304116532207
2022-06-02 10:15:03,769 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.8 epoch----------------------------
2022-06-02 10:15:03,769 - pytorch_cvae.py[line:176] - INFO: loss:3899.1921342909336, numeric_loss:0.0, categorical_loss:800.3319936878979, kld_loss:292562.3812484741, epoch_train_time:125.0846170373261
2022-06-02 10:17:08,417 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.9 epoch----------------------------
2022-06-02 10:17:08,417 - pytorch_cvae.py[line:176] - INFO: loss:4193.362921118736, numeric_loss:0.0, categorical_loss:883.1139745675027, kld_loss:284908.1893978119, epoch_train_time:124.64818543568254
2022-06-02 10:19:13,544 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.10 epoch----------------------------
2022-06-02 10:19:13,544 - pytorch_cvae.py[line:176] - INFO: loss:4479.6948469132185, numeric_loss:0.0, categorical_loss:969.0083824694157, kld_loss:275739.1079978943, epoch_train_time:125.12699672579765
2022-06-02 10:21:18,840 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.11 epoch----------------------------
2022-06-02 10:21:18,841 - pytorch_cvae.py[line:176] - INFO: loss:4766.963838085532, numeric_loss:0.0, categorical_loss:1052.8447001241148, kld_loss:266476.2395620346, epoch_train_time:125.29599896073341
2022-06-02 10:23:23,716 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.12 epoch----------------------------
2022-06-02 10:23:23,716 - pytorch_cvae.py[line:176] - INFO: loss:5080.4662045538425, numeric_loss:0.0, categorical_loss:1160.9082546010613, kld_loss:257140.44912433624, epoch_train_time:124.87546135485172
2022-06-02 10:25:28,416 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.13 epoch----------------------------
2022-06-02 10:25:28,416 - pytorch_cvae.py[line:176] - INFO: loss:5447.016548648477, numeric_loss:0.0, categorical_loss:1303.3808143511415, kld_loss:248816.87093925476, epoch_train_time:124.69952613860369
2022-06-02 10:27:33,326 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.14 epoch----------------------------
2022-06-02 10:27:33,326 - pytorch_cvae.py[line:176] - INFO: loss:5775.446164488792, numeric_loss:0.0, categorical_loss:1430.2291801422834, kld_loss:239061.12420654297, epoch_train_time:124.90959133952856
2022-06-02 10:29:38,367 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.15 epoch----------------------------
2022-06-02 10:29:38,368 - pytorch_cvae.py[line:176] - INFO: loss:6176.578907817602, numeric_loss:0.0, categorical_loss:1620.5153740271926, kld_loss:229890.37749767303, epoch_train_time:125.04174493998289
2022-06-02 10:31:43,291 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.16 epoch----------------------------
2022-06-02 10:31:43,291 - pytorch_cvae.py[line:176] - INFO: loss:6539.479701846838, numeric_loss:0.0, categorical_loss:1805.378475163132, kld_loss:219298.86390018463, epoch_train_time:124.92299550399184
2022-06-02 10:33:48,039 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.17 epoch----------------------------
2022-06-02 10:33:48,039 - pytorch_cvae.py[line:176] - INFO: loss:6919.345231473446, numeric_loss:0.0, categorical_loss:2017.3518430888653, kld_loss:208676.5660495758, epoch_train_time:124.74784118309617
2022-06-02 10:35:52,509 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.18 epoch----------------------------
2022-06-02 10:35:52,509 - pytorch_cvae.py[line:176] - INFO: loss:7314.399902284145, numeric_loss:0.0, categorical_loss:2308.285833708942, kld_loss:196037.02466773987, epoch_train_time:124.46996353566647
2022-06-02 10:37:58,143 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.19 epoch----------------------------
2022-06-02 10:37:58,143 - pytorch_cvae.py[line:176] - INFO: loss:7721.056744217873, numeric_loss:0.0, categorical_loss:2639.7503293156624, kld_loss:183224.45296669006, epoch_train_time:125.63394034281373
2022-06-02 10:40:03,537 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.20 epoch----------------------------
2022-06-02 10:40:03,537 - pytorch_cvae.py[line:176] - INFO: loss:8116.7054615318775, numeric_loss:0.0, categorical_loss:3043.2202318906784, kld_loss:168624.0251774788, epoch_train_time:125.39354711771011
2022-06-02 10:42:08,187 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.21 epoch----------------------------
2022-06-02 10:42:08,187 - pytorch_cvae.py[line:176] - INFO: loss:8496.58209168911, numeric_loss:0.0, categorical_loss:3553.950162217021, kld_loss:151569.07764577866, epoch_train_time:124.6498622149229
2022-06-02 10:44:13,580 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.22 epoch----------------------------
2022-06-02 10:44:13,581 - pytorch_cvae.py[line:176] - INFO: loss:8887.217748701572, numeric_loss:0.0, categorical_loss:4278.791382774711, kld_loss:130520.45415878296, epoch_train_time:125.39346427842975
2022-06-02 10:46:18,805 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.23 epoch----------------------------
2022-06-02 10:46:18,805 - pytorch_cvae.py[line:176] - INFO: loss:9225.194094151258, numeric_loss:0.0, categorical_loss:5411.224892705679, kld_loss:99864.47070097923, epoch_train_time:125.22420825064182
2022-06-02 10:48:23,132 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.24 epoch----------------------------
2022-06-02 10:48:23,132 - pytorch_cvae.py[line:176] - INFO: loss:9425.141832083464, numeric_loss:0.0, categorical_loss:7458.790626168251, kld_loss:47647.16858100891, epoch_train_time:124.32702299207449
2022-06-02 10:50:28,351 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.25 epoch----------------------------
2022-06-02 10:50:28,352 - pytorch_cvae.py[line:176] - INFO: loss:9552.271318078041, numeric_loss:0.0, categorical_loss:8189.112646907568, kld_loss:30598.413213789463, epoch_train_time:125.21928558498621
2022-06-02 10:52:32,635 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.26 epoch----------------------------
2022-06-02 10:52:32,635 - pytorch_cvae.py[line:176] - INFO: loss:9545.213876098394, numeric_loss:0.0, categorical_loss:8602.698617458344, kld_loss:19617.859696030617, epoch_train_time:124.28329304605722
2022-06-02 10:54:36,860 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.27 epoch----------------------------
2022-06-02 10:54:36,861 - pytorch_cvae.py[line:176] - INFO: loss:9429.257074713707, numeric_loss:0.0, categorical_loss:8870.131234019995, kld_loss:10802.340599000454, epoch_train_time:124.22538603842258
2022-06-02 10:56:40,909 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.28 epoch----------------------------
2022-06-02 10:56:40,909 - pytorch_cvae.py[line:176] - INFO: loss:9344.396348953247, numeric_loss:0.0, categorical_loss:8899.521938800812, kld_loss:7985.922594626434, epoch_train_time:124.04848492518067
2022-06-02 10:58:45,829 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.29 epoch----------------------------
2022-06-02 10:58:45,830 - pytorch_cvae.py[line:176] - INFO: loss:9382.00637859106, numeric_loss:0.0, categorical_loss:8963.463353484869, kld_loss:6987.815429323353, epoch_train_time:124.92008317634463
2022-06-02 11:00:51,347 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.30 epoch----------------------------
2022-06-02 11:00:51,347 - pytorch_cvae.py[line:176] - INFO: loss:9320.339379608631, numeric_loss:0.0, categorical_loss:8955.654921740294, kld_loss:5668.478480206861, epoch_train_time:125.51747496798635
2022-06-02 11:02:57,497 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.31 epoch----------------------------
2022-06-02 11:02:57,497 - pytorch_cvae.py[line:176] - INFO: loss:9322.751372754574, numeric_loss:0.0, categorical_loss:9017.382787972689, kld_loss:4423.396399322723, epoch_train_time:126.14946024119854
2022-06-02 11:05:02,952 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.32 epoch----------------------------
2022-06-02 11:05:02,952 - pytorch_cvae.py[line:176] - INFO: loss:9291.277332007885, numeric_loss:0.0, categorical_loss:9009.920633643866, kld_loss:3801.9402805957943, epoch_train_time:125.45495282113552
2022-06-02 11:07:07,169 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.33 epoch----------------------------
2022-06-02 11:07:07,169 - pytorch_cvae.py[line:176] - INFO: loss:9312.662039250135, numeric_loss:0.0, categorical_loss:9117.194613009691, kld_loss:2466.45523005462, epoch_train_time:124.21680957823992
2022-06-02 11:09:11,538 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.34 epoch----------------------------
2022-06-02 11:09:11,538 - pytorch_cvae.py[line:176] - INFO: loss:9289.302143752575, numeric_loss:0.0, categorical_loss:9069.097007662058, kld_loss:2597.236141508678, epoch_train_time:124.3685488179326
2022-06-02 11:11:15,800 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.35 epoch----------------------------
2022-06-02 11:11:15,800 - pytorch_cvae.py[line:176] - INFO: loss:9319.098113447428, numeric_loss:0.0, categorical_loss:9129.49865078926, kld_loss:2092.3796950476244, epoch_train_time:124.26253406330943
2022-06-02 11:13:20,291 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.36 epoch----------------------------
2022-06-02 11:13:20,291 - pytorch_cvae.py[line:176] - INFO: loss:9316.97050306201, numeric_loss:0.0, categorical_loss:9153.224769294262, kld_loss:1692.4937803333742, epoch_train_time:124.49052973091602
2022-06-02 11:15:25,140 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.37 epoch----------------------------
2022-06-02 11:15:25,141 - pytorch_cvae.py[line:176] - INFO: loss:9320.382608413696, numeric_loss:0.0, categorical_loss:9169.301255941391, kld_loss:1464.0502361876424, epoch_train_time:124.84926607087255
2022-06-02 11:17:30,643 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.38 epoch----------------------------
2022-06-02 11:17:30,643 - pytorch_cvae.py[line:176] - INFO: loss:9323.620924830437, numeric_loss:0.0, categorical_loss:9218.641162753105, kld_loss:954.7133120166254, epoch_train_time:125.50263093411922
2022-06-02 11:19:35,457 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.39 epoch----------------------------
2022-06-02 11:19:35,457 - pytorch_cvae.py[line:176] - INFO: loss:9297.17468187213, numeric_loss:0.0, categorical_loss:9183.401768565178, kld_loss:971.9924199539819, epoch_train_time:124.81381212547421
2022-06-02 11:21:40,543 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.40 epoch----------------------------
2022-06-02 11:21:40,543 - pytorch_cvae.py[line:176] - INFO: loss:9272.465373933315, numeric_loss:0.0, categorical_loss:9178.127408146858, kld_loss:757.8816436580964, epoch_train_time:125.08545748889446
2022-06-02 11:23:45,802 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.41 epoch----------------------------
2022-06-02 11:23:45,802 - pytorch_cvae.py[line:176] - INFO: loss:9294.515200406313, numeric_loss:0.0, categorical_loss:9221.409094274044, kld_loss:552.8327372723143, epoch_train_time:125.25849900767207
2022-06-02 11:25:51,667 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.42 epoch----------------------------
2022-06-02 11:25:51,667 - pytorch_cvae.py[line:176] - INFO: loss:9279.910868346691, numeric_loss:0.0, categorical_loss:9222.126031070948, kld_loss:411.7308881619829, epoch_train_time:125.86565044149756
2022-06-02 11:27:57,427 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.43 epoch----------------------------
2022-06-02 11:27:57,427 - pytorch_cvae.py[line:176] - INFO: loss:9283.362078666687, numeric_loss:0.0, categorical_loss:9233.63609945774, kld_loss:334.17709698027465, epoch_train_time:125.75900569930673
2022-06-02 11:30:02,209 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.44 epoch----------------------------
2022-06-02 11:30:02,209 - pytorch_cvae.py[line:176] - INFO: loss:9287.894731879234, numeric_loss:0.0, categorical_loss:9253.014293432236, kld_loss:221.31117375515169, epoch_train_time:124.78232615068555
2022-06-02 11:32:06,476 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.45 epoch----------------------------
2022-06-02 11:32:06,477 - pytorch_cvae.py[line:176] - INFO: loss:9275.915105879307, numeric_loss:0.0, categorical_loss:9251.887970387936, kld_loss:144.0740570531052, epoch_train_time:124.26721762120724
2022-06-02 11:34:11,222 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.46 epoch----------------------------
2022-06-02 11:34:11,223 - pytorch_cvae.py[line:176] - INFO: loss:9292.727291166782, numeric_loss:0.0, categorical_loss:9276.6020578444, kld_loss:91.47163020685548, epoch_train_time:124.74581321701407
2022-06-02 11:36:16,100 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.47 epoch----------------------------
2022-06-02 11:36:16,100 - pytorch_cvae.py[line:176] - INFO: loss:9316.217078983784, numeric_loss:0.0, categorical_loss:9300.523858577013, kld_loss:84.29919277864974, epoch_train_time:124.87721250206232
2022-06-02 11:38:20,298 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.48 epoch----------------------------
2022-06-02 11:38:20,299 - pytorch_cvae.py[line:176] - INFO: loss:9304.234271794558, numeric_loss:0.0, categorical_loss:9294.980028778315, kld_loss:47.12134944042191, epoch_train_time:124.19849365577102
2022-06-02 11:40:25,969 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.49 epoch----------------------------
2022-06-02 11:40:25,969 - pytorch_cvae.py[line:176] - INFO: loss:9286.127669423819, numeric_loss:0.0, categorical_loss:9276.469373047352, kld_loss:46.663443145225756, epoch_train_time:125.67063277959824
2022-06-02 11:42:31,177 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.50 epoch----------------------------
2022-06-02 11:42:31,177 - pytorch_cvae.py[line:176] - INFO: loss:9281.053308278322, numeric_loss:0.0, categorical_loss:9273.73273435235, kld_loss:33.59350196289597, epoch_train_time:125.20783842727542
2022-06-02 11:44:35,631 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.51 epoch----------------------------
2022-06-02 11:44:35,631 - pytorch_cvae.py[line:176] - INFO: loss:9282.967267781496, numeric_loss:0.0, categorical_loss:9275.364984750748, kld_loss:33.16821726912167, epoch_train_time:124.4538069292903
2022-06-02 11:46:40,120 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.52 epoch----------------------------
2022-06-02 11:46:40,120 - pytorch_cvae.py[line:176] - INFO: loss:9254.75027513504, numeric_loss:0.0, categorical_loss:9247.928314775229, kld_loss:28.326281187211862, epoch_train_time:124.488749332726
2022-06-02 11:48:45,576 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.53 epoch----------------------------
2022-06-02 11:48:45,576 - pytorch_cvae.py[line:176] - INFO: loss:9235.517502456903, numeric_loss:0.0, categorical_loss:9228.792367607355, kld_loss:26.602246310038026, epoch_train_time:125.45584788545966
2022-06-02 11:50:50,626 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.54 epoch----------------------------
2022-06-02 11:50:50,627 - pytorch_cvae.py[line:176] - INFO: loss:9264.547191292048, numeric_loss:0.0, categorical_loss:9257.880075633526, kld_loss:25.149330323329195, epoch_train_time:125.04999901354313
2022-06-02 11:52:55,875 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.55 epoch----------------------------
2022-06-02 11:52:55,875 - pytorch_cvae.py[line:176] - INFO: loss:9254.088963091373, numeric_loss:0.0, categorical_loss:9248.327236175537, kld_loss:20.74655904219253, epoch_train_time:125.24851620942354
2022-06-02 11:54:59,615 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.56 epoch----------------------------
2022-06-02 11:54:59,615 - pytorch_cvae.py[line:176] - INFO: loss:9261.44158872962, numeric_loss:0.0, categorical_loss:9256.463215947151, kld_loss:17.128554053080734, epoch_train_time:123.73999504372478
2022-06-02 11:57:04,267 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.57 epoch----------------------------
2022-06-02 11:57:04,267 - pytorch_cvae.py[line:176] - INFO: loss:9250.294242531061, numeric_loss:0.0, categorical_loss:9245.733635008335, kld_loss:15.008242045441875, epoch_train_time:124.6518766246736
2022-06-02 11:59:08,659 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.58 epoch----------------------------
2022-06-02 11:59:08,659 - pytorch_cvae.py[line:176] - INFO: loss:9258.04620873928, numeric_loss:0.0, categorical_loss:9253.82995685935, kld_loss:13.28439473605249, epoch_train_time:124.39173670113087
2022-06-02 12:01:12,994 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.59 epoch----------------------------
2022-06-02 12:01:12,994 - pytorch_cvae.py[line:176] - INFO: loss:9248.453232616186, numeric_loss:0.0, categorical_loss:9244.527568817139, kld_loss:11.85415319702588, epoch_train_time:124.33417780324817
2022-06-02 12:03:17,880 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.60 epoch----------------------------
2022-06-02 12:03:17,880 - pytorch_cvae.py[line:176] - INFO: loss:9252.548071444035, numeric_loss:0.0, categorical_loss:9248.343485951424, kld_loss:12.18028394744033, epoch_train_time:124.88591123744845
2022-06-02 12:05:22,586 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.61 epoch----------------------------
2022-06-02 12:05:22,587 - pytorch_cvae.py[line:176] - INFO: loss:9287.9652813375, numeric_loss:0.0, categorical_loss:9283.86223012209, kld_loss:11.414381932787364, epoch_train_time:124.70643658936024
2022-06-02 12:07:27,391 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.62 epoch----------------------------
2022-06-02 12:07:27,391 - pytorch_cvae.py[line:176] - INFO: loss:9267.881868600845, numeric_loss:0.0, categorical_loss:9263.394589394331, kld_loss:11.99980421148939, epoch_train_time:124.80439864471555
2022-06-02 12:09:32,149 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.63 epoch----------------------------
2022-06-02 12:09:32,150 - pytorch_cvae.py[line:176] - INFO: loss:9263.579651534557, numeric_loss:0.0, categorical_loss:9259.758601278067, kld_loss:9.83226486897911, epoch_train_time:124.75825516879559
2022-06-02 12:11:36,449 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.64 epoch----------------------------
2022-06-02 12:11:36,449 - pytorch_cvae.py[line:176] - INFO: loss:9250.762129306793, numeric_loss:0.0, categorical_loss:9246.962910473347, kld_loss:9.416275102179497, epoch_train_time:124.29938616603613
2022-06-02 12:13:40,631 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.65 epoch----------------------------
2022-06-02 12:13:40,631 - pytorch_cvae.py[line:176] - INFO: loss:9257.505724340677, numeric_loss:0.0, categorical_loss:9253.77983918786, kld_loss:8.903529266652185, epoch_train_time:124.18196122348309
2022-06-02 12:15:44,865 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.66 epoch----------------------------
2022-06-02 12:15:44,865 - pytorch_cvae.py[line:176] - INFO: loss:9267.859435290098, numeric_loss:0.0, categorical_loss:9264.07584413886, kld_loss:8.726101088541327, epoch_train_time:124.23362522572279
2022-06-02 12:17:49,008 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.67 epoch----------------------------
2022-06-02 12:17:49,008 - pytorch_cvae.py[line:176] - INFO: loss:9273.035515218973, numeric_loss:0.0, categorical_loss:9269.345582991838, kld_loss:8.221484227105975, epoch_train_time:124.14253655821085
2022-06-02 12:19:53,850 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.68 epoch----------------------------
2022-06-02 12:19:53,850 - pytorch_cvae.py[line:176] - INFO: loss:9272.338225841522, numeric_loss:0.0, categorical_loss:9269.012757599354, kld_loss:7.165322879096493, epoch_train_time:124.84200880676508
2022-06-02 12:21:58,932 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.69 epoch----------------------------
2022-06-02 12:21:58,932 - pytorch_cvae.py[line:176] - INFO: loss:9279.739184498787, numeric_loss:0.0, categorical_loss:9276.068430840969, kld_loss:7.656392218952533, epoch_train_time:125.08152226731181
2022-06-02 12:24:04,632 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.70 epoch----------------------------
2022-06-02 12:24:04,632 - pytorch_cvae.py[line:176] - INFO: loss:9254.350189208984, numeric_loss:0.0, categorical_loss:9251.300041496754, kld_loss:6.164661301067099, epoch_train_time:125.70039528235793
2022-06-02 12:26:08,611 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.71 epoch----------------------------
2022-06-02 12:26:08,611 - pytorch_cvae.py[line:176] - INFO: loss:9278.906459867954, numeric_loss:0.0, categorical_loss:9276.050582021475, kld_loss:5.598633096378762, epoch_train_time:123.97840517386794
2022-06-02 12:28:12,876 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.72 epoch----------------------------
2022-06-02 12:28:12,876 - pytorch_cvae.py[line:176] - INFO: loss:9272.657676190138, numeric_loss:0.0, categorical_loss:9269.750653773546, kld_loss:5.533236123432289, epoch_train_time:124.26490226387978
2022-06-02 12:30:17,475 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.73 epoch----------------------------
2022-06-02 12:30:17,476 - pytorch_cvae.py[line:176] - INFO: loss:9280.232207089663, numeric_loss:0.0, categorical_loss:9277.32392629981, kld_loss:5.380095519969473, epoch_train_time:124.59943663701415
2022-06-02 12:32:22,285 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.74 epoch----------------------------
2022-06-02 12:32:22,285 - pytorch_cvae.py[line:176] - INFO: loss:9263.874758988619, numeric_loss:0.0, categorical_loss:9261.12060892582, kld_loss:4.9567575921537355, epoch_train_time:124.80962671339512
2022-06-02 12:34:27,526 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.75 epoch----------------------------
2022-06-02 12:34:27,526 - pytorch_cvae.py[line:176] - INFO: loss:9291.556691765785, numeric_loss:0.0, categorical_loss:9288.268091708422, kld_loss:5.763848027563654, epoch_train_time:125.24015604704618
2022-06-02 12:36:32,634 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.76 epoch----------------------------
2022-06-02 12:36:32,634 - pytorch_cvae.py[line:176] - INFO: loss:9294.210817575455, numeric_loss:0.0, categorical_loss:9291.349546730518, kld_loss:4.888618201774079, epoch_train_time:125.10781686380506
2022-06-02 12:38:38,170 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.77 epoch----------------------------
2022-06-02 12:38:38,170 - pytorch_cvae.py[line:176] - INFO: loss:9305.882361769676, numeric_loss:0.0, categorical_loss:9302.816876530647, kld_loss:5.110764346522046, epoch_train_time:125.53626400232315
2022-06-02 12:40:42,900 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.78 epoch----------------------------
2022-06-02 12:40:42,900 - pytorch_cvae.py[line:176] - INFO: loss:9327.461557984352, numeric_loss:0.0, categorical_loss:9324.4895811975, kld_loss:4.839788172917906, epoch_train_time:124.72952353209257
2022-06-02 12:42:47,873 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.79 epoch----------------------------
2022-06-02 12:42:47,873 - pytorch_cvae.py[line:176] - INFO: loss:9300.464170694351, numeric_loss:0.0, categorical_loss:9297.634248822927, kld_loss:4.505925773526542, epoch_train_time:124.97346942126751
2022-06-02 12:44:53,030 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.80 epoch----------------------------
2022-06-02 12:44:53,030 - pytorch_cvae.py[line:176] - INFO: loss:9317.934642374516, numeric_loss:0.0, categorical_loss:9315.33729031682, kld_loss:4.04764642623195, epoch_train_time:125.15652178227901
2022-06-02 12:46:58,126 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.81 epoch----------------------------
2022-06-02 12:46:58,126 - pytorch_cvae.py[line:176] - INFO: loss:9314.787496596575, numeric_loss:0.0, categorical_loss:9311.996736168861, kld_loss:4.260803707744344, epoch_train_time:125.09607556089759
2022-06-02 12:49:03,123 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.82 epoch----------------------------
2022-06-02 12:49:03,123 - pytorch_cvae.py[line:176] - INFO: loss:9270.234352469444, numeric_loss:0.0, categorical_loss:9267.715845555067, kld_loss:3.7708832571515813, epoch_train_time:124.9967184253037
2022-06-02 12:51:08,483 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.83 epoch----------------------------
2022-06-02 12:51:08,483 - pytorch_cvae.py[line:176] - INFO: loss:9255.282500267029, numeric_loss:0.0, categorical_loss:9252.517358332872, kld_loss:4.0642746659432305, epoch_train_time:125.35950556397438
2022-06-02 12:53:13,569 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.84 epoch----------------------------
2022-06-02 12:53:13,569 - pytorch_cvae.py[line:176] - INFO: loss:9290.0250518322, numeric_loss:0.0, categorical_loss:9287.286971837282, kld_loss:3.9546855102671543, epoch_train_time:125.08587417379022
2022-06-02 12:55:17,900 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.85 epoch----------------------------
2022-06-02 12:55:17,900 - pytorch_cvae.py[line:176] - INFO: loss:9296.375251948833, numeric_loss:0.0, categorical_loss:9294.173958867788, kld_loss:3.1273537823581137, epoch_train_time:124.33092726022005
2022-06-02 12:57:22,081 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.86 epoch----------------------------
2022-06-02 12:57:22,081 - pytorch_cvae.py[line:176] - INFO: loss:9297.02537971735, numeric_loss:0.0, categorical_loss:9294.744042932987, kld_loss:3.1912253444024827, epoch_train_time:124.18084406852722
2022-06-02 12:59:26,441 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.87 epoch----------------------------
2022-06-02 12:59:26,441 - pytorch_cvae.py[line:176] - INFO: loss:9305.6664929986, numeric_loss:0.0, categorical_loss:9303.232248425484, kld_loss:3.356099479889963, epoch_train_time:124.36001192778349
2022-06-02 13:01:31,414 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.88 epoch----------------------------
2022-06-02 13:01:31,414 - pytorch_cvae.py[line:176] - INFO: loss:9312.563901126385, numeric_loss:0.0, categorical_loss:9310.366242915392, kld_loss:2.9892917240504175, epoch_train_time:124.97260567545891
2022-06-02 13:03:35,486 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.89 epoch----------------------------
2022-06-02 13:03:35,486 - pytorch_cvae.py[line:176] - INFO: loss:9312.31808334589, numeric_loss:0.0, categorical_loss:9309.81509128213, kld_loss:3.3623153653607005, epoch_train_time:124.07128354161978
2022-06-02 13:05:39,826 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.90 epoch----------------------------
2022-06-02 13:05:39,826 - pytorch_cvae.py[line:176] - INFO: loss:9319.654516637325, numeric_loss:0.0, categorical_loss:9316.861749619246, kld_loss:3.7086779140590806, epoch_train_time:124.34045685455203
2022-06-02 13:07:43,762 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.91 epoch----------------------------
2022-06-02 13:07:43,762 - pytorch_cvae.py[line:176] - INFO: loss:9283.75981399417, numeric_loss:0.0, categorical_loss:9281.531112790108, kld_loss:2.928711254076916, epoch_train_time:123.9354360178113
2022-06-02 13:09:47,983 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.92 epoch----------------------------
2022-06-02 13:09:47,983 - pytorch_cvae.py[line:176] - INFO: loss:9286.430168896914, numeric_loss:0.0, categorical_loss:9284.157794684172, kld_loss:2.957867204793729, epoch_train_time:124.22086638584733
2022-06-02 13:11:53,252 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.93 epoch----------------------------
2022-06-02 13:11:53,252 - pytorch_cvae.py[line:176] - INFO: loss:9301.82630699873, numeric_loss:0.0, categorical_loss:9299.117171764374, kld_loss:3.4965369341662154, epoch_train_time:125.26845881342888
2022-06-02 13:13:58,568 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.94 epoch----------------------------
2022-06-02 13:13:58,568 - pytorch_cvae.py[line:176] - INFO: loss:9290.677204161882, numeric_loss:0.0, categorical_loss:9288.332448124886, kld_loss:3.003641948918812, epoch_train_time:125.3165838457644
2022-06-02 13:16:03,871 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.95 epoch----------------------------
2022-06-02 13:16:03,871 - pytorch_cvae.py[line:176] - INFO: loss:9282.452043831348, numeric_loss:0.0, categorical_loss:9280.036607146263, kld_loss:3.0741360649699345, epoch_train_time:125.30236426368356
2022-06-02 13:18:08,716 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.96 epoch----------------------------
2022-06-02 13:18:08,716 - pytorch_cvae.py[line:176] - INFO: loss:9312.721010416746, numeric_loss:0.0, categorical_loss:9310.570705145597, kld_loss:2.721688887999335, epoch_train_time:124.84509705379605
2022-06-02 13:20:12,621 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.97 epoch----------------------------
2022-06-02 13:20:12,621 - pytorch_cvae.py[line:176] - INFO: loss:9308.332527518272, numeric_loss:0.0, categorical_loss:9305.935371935368, kld_loss:3.0205099011509446, epoch_train_time:123.90452352538705
2022-06-02 13:22:16,336 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.98 epoch----------------------------
2022-06-02 13:22:16,336 - pytorch_cvae.py[line:176] - INFO: loss:9300.915733367205, numeric_loss:0.0, categorical_loss:9298.568537801504, kld_loss:2.9472223063348792, epoch_train_time:123.71505570411682
2022-06-02 13:24:20,680 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.99 epoch----------------------------
2022-06-02 13:24:20,680 - pytorch_cvae.py[line:176] - INFO: loss:9310.050161778927, numeric_loss:0.0, categorical_loss:9307.785176962614, kld_loss:2.836896914872341, epoch_train_time:124.34408721327782
2022-06-02 13:26:25,514 - pytorch_cvae.py[line:169] - INFO: ----------------------------No.100 epoch----------------------------
2022-06-02 13:26:25,514 - pytorch_cvae.py[line:176] - INFO: loss:9307.316126644611, numeric_loss:0.0, categorical_loss:9304.69405078888, kld_loss:3.279228777217213, epoch_train_time:124.83370929583907
2022-06-02 13:26:25,514 - pytorch_cvae.py[line:185] - INFO: training time elapsed:12481.100178740919
2022-06-02 13:26:25,519 - model_utils.py[line:67] - INFO: save model successfully
2022-06-02 13:31:16,874 - pytorch_cvae.py[line:261] - INFO: train model time elapsed:13277.115817081183
2022-06-02 13:31:16,894 - main.py[line:382] - INFO: multi_sampling No.0 epoch
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/root/anaconda3/envs/py36/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/anaconda3/envs/py36/lib/python3.6/threading.py", line 864, in run
    self._target(*self._args, **self._kwargs)
  File "main.py", line 362, in sample_generation_and_aggregation
    sample_list = generate_sample_list(model_dataset_list, query_config, train_config_list)
  File "main.py", line 81, in generate_sample_list
    sample = generate_samples(model, dataset, query_config, train_config_list[i])
  File "/root/lihan/table_cvae_aqp/models/pytorch_cvae.py", line 200, in generate_samples
    query_config)
  File "/root/lihan/table_cvae_aqp/models/pytorch_cvae.py", line 531, in statistics_sampling_with_small_group
    group_sample = int(statistics_sampling_samples * (relative_variances / sum_relative_variance))
ZeroDivisionError: float division by zero

feature_names: ['titleType_0', 'titleType_1', 'titleType_2', 'titleType_3', 'titleType_4', 'b_tconst_0', 'b_tconst_1', 'b_tconst_2', 'b_tconst_3', 'b_tconst_4', 'b_tconst_5', 'b_tconst_6', 'b_tconst_7', 'b_tconst_8', 'b_tconst_9', 'b_tconst_10', 'b_tconst_11', 'b_tconst_12', 'b_tconst_13', 'b_tconst_14', 'b_tconst_15', 'b_tconst_16', 'b_tconst_17', 'b_tconst_18', 'b_tconst_19', 'b_tconst_20', 'b_tconst_21', 'b_tconst_22', 'b_tconst_23', 'b_tconst_24']
feature_names: ['titleType-b_tconst_0', 'titleType-b_tconst_1', 'titleType-b_tconst_2', 'titleType-b_tconst_3', 'titleType-b_tconst_4', 'titleType-b_tconst_5', 'titleType-b_tconst_6', 'titleType-b_tconst_7', 'titleType-b_tconst_8', 'titleType-b_tconst_9', 'titleType-b_tconst_10', 'titleType-b_tconst_11', 'titleType-b_tconst_12', 'titleType-b_tconst_13', 'titleType-b_tconst_14', 'titleType-b_tconst_15', 'titleType-b_tconst_16', 'titleType-b_tconst_17', 'titleType-b_tconst_18', 'titleType-b_tconst_19', 'titleType-b_tconst_20', 'titleType-b_tconst_21', 'titleType-b_tconst_22', 'titleType-b_tconst_23', 'titleType-b_tconst_24']
Traceback (most recent call last):
  File "main.py", line 456, in <module>
    model_aqp(query_config, train_config_list)
  File "main.py", line 396, in model_aqp
    sample_agg = pd.concat(sample_agg_list).groupby(level=0).mean()
  File "/root/anaconda3/envs/py36/lib/python3.6/site-packages/pandas/core/reshape/concat.py", line 284, in concat
    sort=sort,
  File "/root/anaconda3/envs/py36/lib/python3.6/site-packages/pandas/core/reshape/concat.py", line 331, in __init__
    raise ValueError("No objects to concatenate")
ValueError: No objects to concatenate
