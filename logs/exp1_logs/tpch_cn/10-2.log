main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:16:23,523 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:16:23,523 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:16:23,523 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:16:23,523 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:16:23,689 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16595788672566414
2022-07-09 15:16:23,689 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:16:23,690 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:16:25,726 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0357797406613827
2022-07-09 15:16:25,726 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.203251402825117
2022-07-09 15:16:25,726 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:25,728 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013562478125095367
2022-07-09 15:16:25,728 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:16:25,728 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:16:25,730 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013998337090015411
2022-07-09 15:16:25,730 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.00351560115814209
2022-07-09 15:16:25,730 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:16:25,730 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.01
2022-07-09 15:16:25,730 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:16:25,732 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.01
2022-07-09 15:16:25,733 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:16:25,734 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.01
2022-07-09 15:16:26,799 - pytorch_cvae.py[line:399] - INFO: sampling time:1.0664458610117435
2022-07-09 15:16:26,867 - pytorch_cvae.py[line:399] - INFO: sampling time:1.1334004700183868
2022-07-09 15:16:26,875 - pytorch_cvae.py[line:399] - INFO: sampling time:1.1449423916637897
2022-07-09 15:16:27,419 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:27,485 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.06648494675755501
2022-07-09 15:16:27,591 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:27,610 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.018793117254972458
2022-07-09 15:16:27,621 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:27,633 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.012484565377235413
2022-07-09 15:16:27,756 - main.py[line:509] - INFO: sample and aggregation time elapsed:2.0257720053195953
2022-07-09 15:16:27,764 - main.py[line:509] - INFO: sample and aggregation time elapsed:2.0315497294068336
2022-07-09 15:16:27,767 - main.py[line:509] - INFO: sample and aggregation time elapsed:2.0338428243994713
2022-07-09 15:16:27,771 - main.py[line:542] - INFO: sample time: 2.0413617193698883
2022-07-09 15:16:27,779 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4511.70         945069270.15   
ARGENTINA      4508.14         946912344.55   
BRAZIL         4539.06         953575399.23   
CANADA         4502.98         946792993.79   
CHINA          4559.37         957239183.87   
EGYPT          4456.05         938216300.31   
ETHIOPIA       4485.58         945098705.85   
FRANCE         4471.60         939742407.85   
GERMANY        4459.33         937341302.49   
INDIA          4463.74         938161780.96   
INDONESIA      4515.69         949022583.60   
IRAN           4512.14         949056745.81   
IRAQ           4523.43         949182178.28   
JAPAN          4455.42         932064876.92   
JORDAN         4461.80         934390100.88   
KENYA          4432.57         927297897.99   
MOROCCO        4379.06         920837221.84   
MOZAMBIQUE     4613.64         967687599.32   
PERU           4576.73         962326845.35   
ROMANIA        4562.24         958840714.93   
RUSSIA         4452.02         934967833.37   
SAUDI ARABIA   4493.60         943152758.64   
UNITED KINGDOM 4455.84         938324880.75   
UNITED STATES  4583.99         960766734.71   
VIETNAM        4478.06         939191660.49   
2022-07-09 15:16:27,781 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:16:27,785 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.00            0.00           
CHINA          0.01            0.01           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.01            0.01           
GERMANY        0.01            0.01           
INDIA          0.01            0.01           
INDONESIA      0.00            0.00           
IRAN           0.00            0.00           
IRAQ           0.00            0.00           
JAPAN          0.01            0.01           
JORDAN         0.01            0.01           
KENYA          0.01            0.01           
MOROCCO        0.03            0.03           
MOZAMBIQUE     0.03            0.03           
PERU           0.02            0.02           
ROMANIA        0.02            0.02           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.00            0.00           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.02            0.02           
VIETNAM        0.00            0.00           
2022-07-09 15:16:27,787 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.00            0.00           
CHINA          0.01            0.01           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.01            0.01           
GERMANY        0.01            0.01           
INDIA          0.01            0.01           
INDONESIA      0.00            0.00           
IRAN           0.00            0.00           
IRAQ           0.00            0.00           
JAPAN          0.01            0.01           
JORDAN         0.01            0.01           
KENYA          0.01            0.01           
MOROCCO        0.03            0.03           
MOZAMBIQUE     0.03            0.03           
PERU           0.02            0.02           
ROMANIA        0.02            0.02           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.00            0.00           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.02            0.02           
VIETNAM        0.00            0.00           
2022-07-09 15:16:27,787 - main.py[line:554] - INFO: relative error average: 0.009368770062350719
2022-07-09 15:16:27,787 - main.py[line:555] - INFO: relative error normalized average: 0.009302076751639063
2022-07-09 15:16:27,789 - main.py[line:601] - INFO: total_time:4.266012907028198
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:30:08,601 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:30:08,601 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:30:08,601 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:30:08,601 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:30:08,774 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17250452935695648
2022-07-09 15:30:08,774 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:30:08,775 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:30:10,824 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.049021504819393
2022-07-09 15:30:10,824 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2230611070990562
2022-07-09 15:30:10,824 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:30:10,826 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013624802231788635
2022-07-09 15:30:10,826 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:30:10,826 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:30:10,828 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013989843428134918
2022-07-09 15:30:10,828 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035260580480098724
2022-07-09 15:30:10,828 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:30:10,828 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.01
2022-07-09 15:30:11,454 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6252505369484425
2022-07-09 15:30:11,585 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:30:11,587 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.001983754336833954
2022-07-09 15:30:11,612 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7838619202375412
2022-07-09 15:30:11,615 - main.py[line:542] - INFO: sample time: 0.7873272970318794
2022-07-09 15:30:11,624 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4415.77         924975156.33   
ARGENTINA      4515.78         948516593.35   
BRAZIL         4519.44         949453808.35   
CANADA         4480.79         942126671.66   
CHINA          4626.93         971423599.36   
EGYPT          4454.96         937986491.43   
ETHIOPIA       4401.13         927305700.10   
FRANCE         4394.30         923496916.86   
GERMANY        4366.70         917871225.88   
INDIA          4346.47         913515069.95   
INDONESIA      4461.05         937537847.89   
IRAN           4546.84         956355276.97   
IRAQ           4468.07         937565572.32   
JAPAN          4586.79         959546578.52   
JORDAN         4451.98         932332975.91   
KENYA          4574.07         956899365.99   
MOROCCO        4498.96         946049755.23   
MOZAMBIQUE     4592.72         963300269.69   
PERU           4585.33         964134626.97   
ROMANIA        4556.52         957638481.26   
RUSSIA         4459.68         936578181.68   
SAUDI ARABIA   4534.84         951809235.77   
UNITED KINGDOM 4476.09         942587886.42   
UNITED STATES  4409.43         924181176.91   
VIETNAM        4486.50         940963648.54   
2022-07-09 15:30:11,626 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:30:11,633 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.01            0.01           
BRAZIL         0.00            0.00           
CANADA         0.00            0.00           
CHINA          0.03            0.03           
EGYPT          0.01            0.01           
ETHIOPIA       0.02            0.02           
FRANCE         0.02            0.02           
GERMANY        0.03            0.03           
INDIA          0.04            0.04           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.01            0.01           
JAPAN          0.02            0.02           
JORDAN         0.01            0.01           
KENYA          0.02            0.02           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.02            0.02           
PERU           0.02            0.02           
ROMANIA        0.01            0.01           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.00            0.00           
2022-07-09 15:30:11,634 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.01            0.01           
BRAZIL         0.00            0.00           
CANADA         0.00            0.00           
CHINA          0.03            0.03           
EGYPT          0.01            0.01           
ETHIOPIA       0.02            0.02           
FRANCE         0.02            0.02           
GERMANY        0.03            0.03           
INDIA          0.04            0.04           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.01            0.01           
JAPAN          0.02            0.02           
JORDAN         0.01            0.01           
KENYA          0.02            0.02           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.02            0.02           
PERU           0.02            0.02           
ROMANIA        0.01            0.01           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.00            0.00           
2022-07-09 15:30:11,634 - main.py[line:554] - INFO: relative error average: 0.013878999985203205
2022-07-09 15:30:11,634 - main.py[line:555] - INFO: relative error normalized average: 0.013739916448606797
2022-07-09 15:30:11,635 - main.py[line:601] - INFO: total_time:3.034113369882107
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
