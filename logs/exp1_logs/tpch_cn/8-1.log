main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:15:50,630 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:15:50,630 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:15:50,630 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:15:50,630 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:15:50,802 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17151187360286713
2022-07-09 15:15:50,802 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:15:50,803 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:15:52,844 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0405156686902046
2022-07-09 15:15:52,844 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2135467641055584
2022-07-09 15:15:52,844 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:52,845 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.001368056982755661
2022-07-09 15:15:52,845 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:15:52,846 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:15:52,848 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014076195657253265
2022-07-09 15:15:52,848 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035415291786193848
2022-07-09 15:15:52,848 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:15:52,848 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.008
2022-07-09 15:15:52,848 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:15:52,850 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.008
2022-07-09 15:15:52,851 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:15:52,851 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.008
2022-07-09 15:15:53,639 - pytorch_cvae.py[line:399] - INFO: sampling time:0.790489386767149
2022-07-09 15:15:53,660 - pytorch_cvae.py[line:399] - INFO: sampling time:0.8083157539367676
2022-07-09 15:15:54,130 - pytorch_cvae.py[line:399] - INFO: sampling time:1.2796961404383183
2022-07-09 15:15:54,247 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:54,264 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.017164196819067
2022-07-09 15:15:54,290 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:54,300 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.009751830250024796
2022-07-09 15:15:54,397 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.5454432778060436
2022-07-09 15:15:54,422 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.5741669237613678
2022-07-09 15:15:54,434 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:54,438 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0037817619740962982
2022-07-09 15:15:54,460 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.6104312092065811
2022-07-09 15:15:54,465 - main.py[line:542] - INFO: sample time: 1.6168707720935345
2022-07-09 15:15:54,474 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4561.26         955451795.83   
ARGENTINA      4538.92         953378158.65   
BRAZIL         4570.45         960170041.06   
CANADA         4523.99         951209742.04   
CHINA          4503.61         945533606.86   
EGYPT          4520.84         951858555.46   
ETHIOPIA       4462.88         940314544.22   
FRANCE         4465.29         938415948.58   
GERMANY        4507.04         947371186.03   
INDIA          4548.93         956067748.04   
INDONESIA      4518.77         949668662.14   
IRAN           4549.07         956823994.48   
IRAQ           4582.51         961579189.39   
JAPAN          4431.79         927121203.09   
JORDAN         4484.14         939068301.22   
KENYA          4393.18         919057950.00   
MOROCCO        4390.57         923257308.50   
MOZAMBIQUE     4549.87         954312800.56   
PERU           4536.43         953852155.17   
ROMANIA        4562.00         958790923.43   
RUSSIA         4445.25         933546828.85   
SAUDI ARABIA   4440.63         932035426.12   
UNITED KINGDOM 4408.29         928310319.47   
UNITED STATES  4532.68         950012567.03   
VIETNAM        4549.56         954187737.77   
2022-07-09 15:15:54,476 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:15:54,483 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.01            0.01           
CHINA          0.00            0.00           
EGYPT          0.00            0.00           
ETHIOPIA       0.01            0.01           
FRANCE         0.01            0.01           
GERMANY        0.00            0.00           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.02            0.02           
JAPAN          0.01            0.01           
JORDAN         0.00            0.00           
KENYA          0.02            0.02           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.01            0.01           
PERU           0.01            0.01           
ROMANIA        0.02            0.02           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:15:54,485 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.01            0.01           
CHINA          0.00            0.00           
EGYPT          0.00            0.00           
ETHIOPIA       0.01            0.01           
FRANCE         0.01            0.01           
GERMANY        0.00            0.00           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.02            0.02           
JAPAN          0.01            0.01           
JORDAN         0.00            0.00           
KENYA          0.02            0.02           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.01            0.01           
PERU           0.01            0.01           
ROMANIA        0.02            0.02           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:15:54,485 - main.py[line:554] - INFO: relative error average: 0.010853926918185451
2022-07-09 15:15:54,485 - main.py[line:555] - INFO: relative error normalized average: 0.010778791706869899
2022-07-09 15:15:54,486 - main.py[line:601] - INFO: total_time:3.855571534484625
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:29:40,245 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:29:40,245 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:29:40,245 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:29:40,245 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:29:40,416 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17091386392712593
2022-07-09 15:29:40,416 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:29:40,418 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:29:42,471 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0529112070798874
2022-07-09 15:29:42,471 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2253546118736267
2022-07-09 15:29:42,471 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:42,472 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.001362968236207962
2022-07-09 15:29:42,472 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:29:42,473 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:29:42,474 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013963952660560608
2022-07-09 15:29:42,474 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.00351807102560997
2022-07-09 15:29:42,474 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:29:42,475 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.008
2022-07-09 15:29:43,080 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6052311472594738
2022-07-09 15:29:43,184 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:43,186 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0018991939723491669
2022-07-09 15:29:43,210 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7356285825371742
2022-07-09 15:29:43,213 - main.py[line:542] - INFO: sample time: 0.739142257720232
2022-07-09 15:29:43,223 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4512.52         945242251.52   
ARGENTINA      4607.66         967815972.05   
BRAZIL         4619.10         970389471.45   
CANADA         4541.54         954898860.93   
CHINA          4503.73         945557792.61   
EGYPT          4563.21         960779045.22   
ETHIOPIA       4357.08         918022719.63   
FRANCE         4553.80         957017751.13   
GERMANY        4421.39         929367268.06   
INDIA          4503.08         946430770.47   
INDONESIA      4516.66         949226538.79   
IRAN           4438.64         933597877.65   
IRAQ           4502.08         944702732.27   
JAPAN          4455.32         932043478.03   
JORDAN         4499.63         942311523.66   
KENYA          4321.85         904136373.47   
MOROCCO        4436.78         932973952.30   
MOZAMBIQUE     4660.32         977477818.56   
PERU           4585.23         964113101.62   
ROMANIA        4580.68         962716998.93   
RUSSIA         4482.77         941426989.57   
SAUDI ARABIA   4420.94         927901921.80   
UNITED KINGDOM 4405.03         927625245.85   
UNITED STATES  4514.99         946304866.91   
VIETNAM        4609.19         966694079.62   
2022-07-09 15:29:43,226 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:29:43,232 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.03            0.03           
BRAZIL         0.02            0.02           
CANADA         0.01            0.01           
CHINA          0.00            0.00           
EGYPT          0.01            0.01           
ETHIOPIA       0.03            0.03           
FRANCE         0.01            0.01           
GERMANY        0.02            0.02           
INDIA          0.00            0.00           
INDONESIA      0.00            0.00           
IRAN           0.02            0.02           
IRAQ           0.00            0.00           
JAPAN          0.01            0.01           
JORDAN         0.00            0.00           
KENYA          0.04            0.04           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.04            0.04           
PERU           0.02            0.02           
ROMANIA        0.02            0.02           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.00            0.00           
VIETNAM        0.02            0.02           
2022-07-09 15:29:43,234 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.03            0.03           
BRAZIL         0.02            0.02           
CANADA         0.01            0.01           
CHINA          0.00            0.00           
EGYPT          0.01            0.01           
ETHIOPIA       0.03            0.03           
FRANCE         0.01            0.01           
GERMANY        0.02            0.02           
INDIA          0.00            0.00           
INDONESIA      0.00            0.00           
IRAN           0.02            0.02           
IRAQ           0.00            0.00           
JAPAN          0.01            0.01           
JORDAN         0.00            0.00           
KENYA          0.04            0.04           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.04            0.04           
PERU           0.02            0.02           
ROMANIA        0.02            0.02           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.00            0.00           
VIETNAM        0.02            0.02           
2022-07-09 15:29:43,234 - main.py[line:554] - INFO: relative error average: 0.014755721794037013
2022-07-09 15:29:43,235 - main.py[line:555] - INFO: relative error normalized average: 0.01458850671146541
2022-07-09 15:29:43,236 - main.py[line:601] - INFO: total_time:2.990586005151272
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
