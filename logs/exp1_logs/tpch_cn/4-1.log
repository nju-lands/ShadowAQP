main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:15:01,489 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:15:01,490 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:15:01,490 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:15:01,490 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:15:01,658 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.1687249280512333
2022-07-09 15:15:01,659 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:15:01,660 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:15:03,715 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.055123705416918
2022-07-09 15:15:03,715 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.22535403072834
2022-07-09 15:15:03,715 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:03,716 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013701915740966797
2022-07-09 15:15:03,716 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:15:03,717 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:15:03,718 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013903304934501648
2022-07-09 15:15:03,719 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003527045249938965
2022-07-09 15:15:03,719 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:15:03,719 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.004
2022-07-09 15:15:03,719 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:15:03,721 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.004
2022-07-09 15:15:03,721 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:15:03,722 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.004
2022-07-09 15:15:04,305 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5857410058379173
2022-07-09 15:15:04,370 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:04,373 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0020894110202789307
2022-07-09 15:15:04,429 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7106646336615086
2022-07-09 15:15:04,440 - pytorch_cvae.py[line:399] - INFO: sampling time:0.71831488981843
2022-07-09 15:15:04,555 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:04,562 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.00711330771446228
2022-07-09 15:15:04,576 - pytorch_cvae.py[line:399] - INFO: sampling time:0.8530757986009121
2022-07-09 15:15:04,642 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.920960083603859
2022-07-09 15:15:04,670 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:04,671 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0017659515142440796
2022-07-09 15:15:04,683 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.9609119445085526
2022-07-09 15:15:04,688 - main.py[line:542] - INFO: sample time: 0.9691611565649509
2022-07-09 15:15:04,696 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4632.93         970463481.28   
ARGENTINA      4631.10         972738561.67   
BRAZIL         4534.58         952632831.19   
CANADA         4577.53         962467389.38   
CHINA          4557.70         956888114.98   
EGYPT          4582.52         964845439.16   
ETHIOPIA       4433.89         934207341.91   
FRANCE         4470.80         939575222.74   
GERMANY        4465.08         938550622.55   
INDIA          4522.36         950481783.70   
INDONESIA      4436.24         932323787.74   
IRAN           4510.19         948646623.69   
IRAQ           4490.26         942221672.24   
JAPAN          4493.44         940019454.91   
JORDAN         4387.72         918876391.94   
KENYA          4463.93         933859255.43   
MOROCCO        4452.38         936255175.78   
MOZAMBIQUE     4523.09         948695646.47   
PERU           4533.18         953169256.26   
ROMANIA        4548.98         956055368.76   
RUSSIA         4422.97         928866993.75   
SAUDI ARABIA   4369.97         917204124.17   
UNITED KINGDOM 4486.86         944855841.75   
UNITED STATES  4450.73         932837089.55   
VIETNAM        4529.22         949922782.24   
2022-07-09 15:15:04,699 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:15:04,705 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.03            0.03           
ARGENTINA      0.03            0.03           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.01            0.01           
EGYPT          0.02            0.02           
ETHIOPIA       0.01            0.01           
FRANCE         0.01            0.01           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.00            0.00           
JAPAN          0.00            0.00           
JORDAN         0.02            0.02           
KENYA          0.01            0.01           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.01            0.01           
PERU           0.01            0.01           
ROMANIA        0.01            0.01           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.03            0.03           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:15:04,706 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.03            0.03           
ARGENTINA      0.03            0.03           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.01            0.01           
EGYPT          0.02            0.02           
ETHIOPIA       0.01            0.01           
FRANCE         0.01            0.01           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.00            0.00           
JAPAN          0.00            0.00           
JORDAN         0.02            0.02           
KENYA          0.01            0.01           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.01            0.01           
PERU           0.01            0.01           
ROMANIA        0.01            0.01           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.03            0.03           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:15:04,707 - main.py[line:554] - INFO: relative error average: 0.011991542199150114
2022-07-09 15:15:04,707 - main.py[line:555] - INFO: relative error normalized average: 0.011877253315105325
2022-07-09 15:15:04,708 - main.py[line:601] - INFO: total_time:3.2183232977986336
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:28:55,679 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:28:55,679 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:28:55,679 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:28:55,679 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:28:55,845 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16528550535440445
2022-07-09 15:28:55,845 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:28:55,846 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:28:57,902 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.055507827550173
2022-07-09 15:28:57,902 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.222319584339857
2022-07-09 15:28:57,902 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:57,903 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013998746871948242
2022-07-09 15:28:57,903 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:28:57,904 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:28:57,905 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014731474220752716
2022-07-09 15:28:57,906 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003673221915960312
2022-07-09 15:28:57,906 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:28:57,906 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.004
2022-07-09 15:28:58,454 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5482948198914528
2022-07-09 15:28:58,508 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:58,510 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0018402524292469025
2022-07-09 15:28:58,531 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.6250727288424969
2022-07-09 15:28:58,534 - main.py[line:542] - INFO: sample time: 0.6285865679383278
2022-07-09 15:28:58,543 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4510.71         944862589.37   
ARGENTINA      4431.44         930802470.74   
BRAZIL         4557.77         957505336.01   
CANADA         4566.02         960047611.43   
CHINA          4473.04         939114046.21   
EGYPT          4918.29         1035540331.64  
ETHIOPIA       4529.80         954414897.24   
FRANCE         4408.69         926521445.72   
GERMANY        4476.16         940879386.76   
INDIA          4349.77         914208953.00   
INDONESIA      4314.39         906716385.46   
IRAN           4382.18         921721663.03   
IRAQ           4377.64         918591732.34   
JAPAN          4422.53         925184523.72   
JORDAN         4316.62         903987527.01   
KENYA          4280.99         895587217.91   
MOROCCO        4492.53         944698318.94   
MOZAMBIQUE     4572.49         959056074.05   
PERU           4615.57         970493508.06   
ROMANIA        4643.63         975947187.00   
RUSSIA         4570.26         959799428.59   
SAUDI ARABIA   4449.75         933949344.01   
UNITED KINGDOM 4436.65         934282508.79   
UNITED STATES  4593.51         962762989.82   
VIETNAM        4325.82         907262154.86   
2022-07-09 15:28:58,545 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:28:58,551 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.01            0.01           
EGYPT          0.09            0.09           
ETHIOPIA       0.01            0.01           
FRANCE         0.02            0.02           
GERMANY        0.00            0.00           
INDIA          0.04            0.04           
INDONESIA      0.04            0.04           
IRAN           0.03            0.03           
IRAQ           0.03            0.03           
JAPAN          0.01            0.01           
JORDAN         0.04            0.04           
KENYA          0.05            0.05           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.02            0.02           
PERU           0.03            0.03           
ROMANIA        0.03            0.03           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.02            0.02           
VIETNAM        0.04            0.04           
2022-07-09 15:28:58,553 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.01            0.01           
EGYPT          0.09            0.09           
ETHIOPIA       0.01            0.01           
FRANCE         0.02            0.02           
GERMANY        0.00            0.00           
INDIA          0.03            0.03           
INDONESIA      0.04            0.04           
IRAN           0.03            0.03           
IRAQ           0.03            0.03           
JAPAN          0.01            0.01           
JORDAN         0.04            0.04           
KENYA          0.05            0.05           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.02            0.02           
PERU           0.03            0.03           
ROMANIA        0.03            0.03           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.02            0.02           
VIETNAM        0.04            0.04           
2022-07-09 15:28:58,553 - main.py[line:554] - INFO: relative error average: 0.023292889627905385
2022-07-09 15:28:58,553 - main.py[line:555] - INFO: relative error normalized average: 0.022847105211483
2022-07-09 15:28:58,554 - main.py[line:601] - INFO: total_time:2.8746004179120064
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
