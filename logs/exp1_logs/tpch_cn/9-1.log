main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:16:03,733 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:16:03,733 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:16:03,733 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:16:03,733 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:16:03,903 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.1696774698793888
2022-07-09 15:16:03,903 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:16:03,904 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:16:05,953 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.049292616546154
2022-07-09 15:16:05,954 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2204812690615654
2022-07-09 15:16:05,954 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:05,955 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013677552342414856
2022-07-09 15:16:05,955 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:16:05,956 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:16:05,957 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014144517481327057
2022-07-09 15:16:05,957 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003541748970746994
2022-07-09 15:16:05,957 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:16:05,958 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.009000000000000001
2022-07-09 15:16:05,958 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:16:05,959 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.009000000000000001
2022-07-09 15:16:05,961 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:16:05,961 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.009000000000000001
2022-07-09 15:16:06,846 - pytorch_cvae.py[line:399] - INFO: sampling time:0.8851117119193077
2022-07-09 15:16:06,848 - pytorch_cvae.py[line:399] - INFO: sampling time:0.887910608202219
2022-07-09 15:16:07,218 - pytorch_cvae.py[line:399] - INFO: sampling time:1.2599174045026302
2022-07-09 15:16:07,652 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:07,711 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0587535984814167
2022-07-09 15:16:07,791 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:07,853 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.06185077875852585
2022-07-09 15:16:07,879 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:07,885 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.00639091432094574
2022-07-09 15:16:07,976 - main.py[line:509] - INFO: sample and aggregation time elapsed:2.015299804508686
2022-07-09 15:16:07,984 - main.py[line:509] - INFO: sample and aggregation time elapsed:2.0246083065867424
2022-07-09 15:16:07,999 - main.py[line:509] - INFO: sample and aggregation time elapsed:2.041295927017927
2022-07-09 15:16:08,004 - main.py[line:542] - INFO: sample time: 2.0464427061378956
2022-07-09 15:16:08,014 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4509.64         944639444.84   
ARGENTINA      4567.32         959341892.61   
BRAZIL         4547.94         955440535.79   
CANADA         4482.99         942588601.08   
CHINA          4516.71         948282225.77   
EGYPT          4471.89         941552335.54   
ETHIOPIA       4488.62         945738705.54   
FRANCE         4495.96         944862052.40   
GERMANY        4472.45         940099535.67   
INDIA          4468.05         939066995.77   
INDONESIA      4499.89         945701037.95   
IRAN           4456.05         937258913.37   
IRAQ           4479.32         939927050.45   
JAPAN          4465.42         934156009.55   
JORDAN         4453.95         932746635.23   
KENYA          4433.19         927427021.43   
MOROCCO        4483.84         942871083.69   
MOZAMBIQUE     4580.60         960758701.44   
PERU           4536.42         953851267.44   
ROMANIA        4504.53         946711930.06   
RUSSIA         4497.89         944602295.95   
SAUDI ARABIA   4438.29         931543323.93   
UNITED KINGDOM 4526.24         953149037.68   
UNITED STATES  4488.58         940770179.14   
VIETNAM        4431.25         929374685.73   
2022-07-09 15:16:08,017 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:16:08,024 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.02            0.02           
BRAZIL         0.01            0.01           
CANADA         0.00            0.00           
CHINA          0.00            0.00           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.01            0.01           
INDONESIA      0.00            0.00           
IRAN           0.01            0.01           
IRAQ           0.01            0.01           
JAPAN          0.00            0.00           
JORDAN         0.01            0.01           
KENYA          0.01            0.01           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.02            0.02           
PERU           0.01            0.01           
ROMANIA        0.00            0.00           
RUSSIA         0.00            0.00           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.00            0.00           
VIETNAM        0.01            0.01           
2022-07-09 15:16:08,026 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.02            0.02           
BRAZIL         0.01            0.01           
CANADA         0.00            0.00           
CHINA          0.00            0.00           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.01            0.01           
INDONESIA      0.00            0.00           
IRAN           0.01            0.01           
IRAQ           0.01            0.01           
JAPAN          0.00            0.00           
JORDAN         0.01            0.01           
KENYA          0.01            0.01           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.02            0.02           
PERU           0.01            0.01           
ROMANIA        0.00            0.00           
RUSSIA         0.00            0.00           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.00            0.00           
VIETNAM        0.01            0.01           
2022-07-09 15:16:08,026 - main.py[line:554] - INFO: relative error average: 0.007048981239457885
2022-07-09 15:16:08,026 - main.py[line:555] - INFO: relative error normalized average: 0.007009314137345793
2022-07-09 15:16:08,027 - main.py[line:601] - INFO: total_time:4.294695172458887
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:29:51,560 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:29:51,560 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:29:51,560 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:29:51,560 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:29:51,733 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.1725107841193676
2022-07-09 15:29:51,733 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:29:51,734 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:29:53,803 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0689764358103275
2022-07-09 15:29:53,803 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2430394925177097
2022-07-09 15:29:53,804 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:53,805 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013934113085269928
2022-07-09 15:29:53,805 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:29:53,806 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:29:53,807 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014059916138648987
2022-07-09 15:29:53,807 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035705119371414185
2022-07-09 15:29:53,807 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:29:53,808 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.009000000000000001
2022-07-09 15:29:54,419 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6114252507686615
2022-07-09 15:29:54,536 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:54,538 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0020194239914417267
2022-07-09 15:29:54,564 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7563294433057308
2022-07-09 15:29:54,567 - main.py[line:542] - INFO: sample time: 0.759858027100563
2022-07-09 15:29:54,577 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4489.26         940369925.82   
ARGENTINA      4443.70         933377114.62   
BRAZIL         4490.82         943439836.11   
CANADA         4395.92         924282443.27   
CHINA          4466.81         937807476.59   
EGYPT          4498.65         947186299.46   
ETHIOPIA       4609.12         971128261.86   
FRANCE         4517.38         949362791.85   
GERMANY        4378.15         920278641.21   
INDIA          4497.79         945318210.48   
INDONESIA      4453.72         935998923.41   
IRAN           4438.64         933596754.69   
IRAQ           4524.99         949510831.61   
JAPAN          4388.62         918089827.33   
JORDAN         4519.05         946378968.52   
KENYA          4461.80         933412134.99   
MOROCCO        4387.25         922559213.40   
MOZAMBIQUE     4681.51         981922604.57   
PERU           4567.57         960399120.85   
ROMANIA        4650.41         977372691.56   
RUSSIA         4502.92         945658754.00   
SAUDI ARABIA   4221.11         885959845.55   
UNITED KINGDOM 4462.84         939798942.42   
UNITED STATES  4394.36         921023025.45   
VIETNAM        4508.89         945659010.11   
2022-07-09 15:29:54,579 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:29:54,585 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.01            0.01           
BRAZIL         0.00            0.00           
CANADA         0.02            0.02           
CHINA          0.01            0.01           
EGYPT          0.00            0.00           
ETHIOPIA       0.03            0.03           
FRANCE         0.00            0.00           
GERMANY        0.03            0.03           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.02            0.02           
IRAQ           0.00            0.00           
JAPAN          0.02            0.02           
JORDAN         0.00            0.00           
KENYA          0.01            0.01           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.04            0.04           
PERU           0.02            0.02           
ROMANIA        0.03            0.03           
RUSSIA         0.00            0.00           
SAUDI ARABIA   0.06            0.06           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.02            0.02           
VIETNAM        0.00            0.00           
2022-07-09 15:29:54,587 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.01            0.01           
BRAZIL         0.00            0.00           
CANADA         0.02            0.02           
CHINA          0.01            0.01           
EGYPT          0.00            0.00           
ETHIOPIA       0.03            0.03           
FRANCE         0.00            0.00           
GERMANY        0.03            0.03           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.02            0.02           
IRAQ           0.00            0.00           
JAPAN          0.02            0.02           
JORDAN         0.00            0.00           
KENYA          0.01            0.01           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.04            0.04           
PERU           0.02            0.02           
ROMANIA        0.03            0.03           
RUSSIA         0.00            0.00           
SAUDI ARABIA   0.06            0.06           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.02            0.02           
VIETNAM        0.00            0.00           
2022-07-09 15:29:54,587 - main.py[line:554] - INFO: relative error average: 0.01515314669241115
2022-07-09 15:29:54,587 - main.py[line:555] - INFO: relative error normalized average: 0.014931742260809757
2022-07-09 15:29:54,588 - main.py[line:601] - INFO: total_time:3.0280285887420177
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
