main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:14:20,343 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:14:20,343 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:14:20,343 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:14:20,344 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:14:21,993 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:1.6492682844400406
2022-07-09 15:14:21,993 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:14:22,014 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:14:28,580 - model_utils.py[line:86] - INFO: load torch model time elapsed:6.566062990576029
2022-07-09 15:14:28,581 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:8.237019512802362
2022-07-09 15:14:28,581 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:28,597 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.015843313187360764
2022-07-09 15:14:28,597 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:14:28,599 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:14:28,614 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.015417270362377167
2022-07-09 15:14:28,615 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.03383585438132286
2022-07-09 15:14:28,615 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:14:28,615 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.001
2022-07-09 15:14:28,616 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:14:28,621 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.001
2022-07-09 15:14:28,621 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:14:28,622 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.001
2022-07-09 15:14:29,228 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6065872274339199
2022-07-09 15:14:29,318 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:29,319 - pytorch_cvae.py[line:399] - INFO: sampling time:0.7036555632948875
2022-07-09 15:14:29,321 - pytorch_cvae.py[line:399] - INFO: sampling time:0.698676373809576
2022-07-09 15:14:29,393 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:29,404 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.08560867235064507
2022-07-09 15:14:29,418 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:29,430 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.011370822787284851
2022-07-09 15:14:29,433 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.04031438007950783
2022-07-09 15:14:29,522 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.9015623144805431
2022-07-09 15:14:29,538 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.9228104054927826
2022-07-09 15:14:29,550 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.9284804984927177
2022-07-09 15:14:29,555 - main.py[line:542] - INFO: sample time: 0.9405186399817467
2022-07-09 15:14:29,578 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4512.55         945248072.05   
ARGENTINA      4508.63         947014609.91   
BRAZIL         4533.36         952377905.93   
CANADA         4496.27         945380745.76   
CHINA          4681.05         982785872.59   
EGYPT          4646.89         978398303.32   
ETHIOPIA       4521.64         952696021.68   
FRANCE         4252.25         893644743.91   
GERMANY        4580.81         962877709.28   
INDIA          4484.96         942622649.71   
INDONESIA      4583.31         963232152.06   
IRAN           4384.75         922262728.93   
IRAQ           4674.19         980817101.82   
JAPAN          4540.88         949943763.41   
JORDAN         4374.00         916003756.31   
KENYA          4474.12         935989617.32   
MOROCCO        4436.10         932832334.16   
MOZAMBIQUE     4472.86         938159137.06   
PERU           4421.23         929629496.68   
ROMANIA        4539.08         953973522.69   
RUSSIA         4536.07         952619328.63   
SAUDI ARABIA   4435.64         930986774.80   
UNITED KINGDOM 4250.58         895100345.84   
UNITED STATES  4533.49         950182822.35   
VIETNAM        4482.15         940049433.66   
2022-07-09 15:14:29,582 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:14:29,589 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.01            0.01           
BRAZIL         0.00            0.00           
CANADA         0.00            0.00           
CHINA          0.04            0.04           
EGYPT          0.03            0.03           
ETHIOPIA       0.01            0.01           
FRANCE         0.05            0.05           
GERMANY        0.02            0.02           
INDIA          0.01            0.01           
INDONESIA      0.02            0.02           
IRAN           0.03            0.03           
IRAQ           0.04            0.04           
JAPAN          0.01            0.01           
JORDAN         0.03            0.03           
KENYA          0.00            0.00           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.01            0.01           
PERU           0.02            0.02           
ROMANIA        0.01            0.01           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.05            0.05           
UNITED STATES  0.01            0.01           
VIETNAM        0.00            0.00           
2022-07-09 15:14:29,591 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.01            0.01           
BRAZIL         0.00            0.00           
CANADA         0.00            0.00           
CHINA          0.04            0.04           
EGYPT          0.03            0.03           
ETHIOPIA       0.01            0.01           
FRANCE         0.05            0.05           
GERMANY        0.02            0.02           
INDIA          0.01            0.01           
INDONESIA      0.02            0.02           
IRAN           0.03            0.03           
IRAQ           0.04            0.04           
JAPAN          0.01            0.01           
JORDAN         0.03            0.03           
KENYA          0.00            0.00           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.01            0.01           
PERU           0.02            0.02           
ROMANIA        0.01            0.01           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.05            0.05           
UNITED STATES  0.01            0.01           
VIETNAM        0.00            0.00           
2022-07-09 15:14:29,592 - main.py[line:554] - INFO: relative error average: 0.01732228724314913
2022-07-09 15:14:29,592 - main.py[line:555] - INFO: relative error normalized average: 0.01705825830958154
2022-07-09 15:14:29,593 - main.py[line:601] - INFO: total_time:9.250481363385916
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:28:22,783 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:28:22,783 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:28:22,783 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:28:22,783 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:28:22,955 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17180483415722847
2022-07-09 15:28:22,955 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:28:22,956 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:28:25,018 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0613350570201874
2022-07-09 15:28:25,018 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.234680723398924
2022-07-09 15:28:25,018 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:25,019 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013685710728168488
2022-07-09 15:28:25,019 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:28:25,020 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:28:25,021 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.001419011503458023
2022-07-09 15:28:25,021 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035572126507759094
2022-07-09 15:28:25,021 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:28:25,022 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.001
2022-07-09 15:28:25,530 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5078112818300724
2022-07-09 15:28:25,545 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:25,547 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0018222816288471222
2022-07-09 15:28:25,560 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.5382759533822536
2022-07-09 15:28:25,563 - main.py[line:542] - INFO: sample time: 0.5416237078607082
2022-07-09 15:28:25,573 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4226.16         885257307.97   
ARGENTINA      4071.18         855130265.10   
BRAZIL         4529.77         951623369.83   
CANADA         4661.91         980208408.28   
CHINA          4442.65         932733510.44   
EGYPT          4513.83         950381672.65   
ETHIOPIA       4595.15         968184208.14   
FRANCE         4285.40         900611951.90   
GERMANY        4209.05         884733112.59   
INDIA          4567.95         960064933.02   
INDONESIA      4703.39         988469469.37   
IRAN           4658.95         979935213.93   
IRAQ           4413.59         926134382.76   
JAPAN          4725.41         988545571.47   
JORDAN         4896.73         1025473528.88  
KENYA          4307.20         901070896.18   
MOROCCO        4314.21         907201634.58   
MOZAMBIQUE     4511.32         946227815.90   
PERU           4369.25         918700147.30   
ROMANIA        4331.15         910273906.74   
RUSSIA         4424.75         929241075.50   
SAUDI ARABIA   4552.59         955532974.47   
UNITED KINGDOM 4336.91         913279326.08   
UNITED STATES  4771.35         1000037771.83  
VIETNAM        4087.69         857318370.92   
2022-07-09 15:28:25,576 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:28:25,582 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.06            0.06           
ARGENTINA      0.09            0.09           
BRAZIL         0.00            0.00           
CANADA         0.04            0.04           
CHINA          0.01            0.01           
EGYPT          0.00            0.00           
ETHIOPIA       0.02            0.02           
FRANCE         0.05            0.05           
GERMANY        0.06            0.06           
INDIA          0.01            0.01           
INDONESIA      0.05            0.05           
IRAN           0.03            0.03           
IRAQ           0.02            0.02           
JAPAN          0.05            0.05           
JORDAN         0.09            0.09           
KENYA          0.04            0.04           
MOROCCO        0.04            0.04           
MOZAMBIQUE     0.00            0.00           
PERU           0.03            0.03           
ROMANIA        0.04            0.04           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.03            0.03           
UNITED STATES  0.06            0.06           
VIETNAM        0.09            0.09           
2022-07-09 15:28:25,584 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.06            0.06           
ARGENTINA      0.09            0.09           
BRAZIL         0.00            0.00           
CANADA         0.04            0.04           
CHINA          0.01            0.01           
EGYPT          0.00            0.00           
ETHIOPIA       0.02            0.02           
FRANCE         0.05            0.05           
GERMANY        0.06            0.06           
INDIA          0.01            0.01           
INDONESIA      0.05            0.05           
IRAN           0.03            0.03           
IRAQ           0.02            0.02           
JAPAN          0.05            0.05           
JORDAN         0.08            0.08           
KENYA          0.04            0.04           
MOROCCO        0.04            0.04           
MOZAMBIQUE     0.00            0.00           
PERU           0.03            0.03           
ROMANIA        0.04            0.04           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.03            0.03           
UNITED STATES  0.06            0.06           
VIETNAM        0.09            0.09           
2022-07-09 15:28:25,584 - main.py[line:554] - INFO: relative error average: 0.03860549379374659
2022-07-09 15:28:25,584 - main.py[line:555] - INFO: relative error normalized average: 0.037543736177517745
2022-07-09 15:28:25,585 - main.py[line:601] - INFO: total_time:2.802207615226507
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
