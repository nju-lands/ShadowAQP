main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:15:19,467 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:15:19,467 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:15:19,467 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:15:19,467 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:15:19,639 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17158743366599083
2022-07-09 15:15:19,639 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:15:19,640 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:15:21,680 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0400373488664627
2022-07-09 15:15:21,681 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2131288945674896
2022-07-09 15:15:21,681 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:21,682 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013653859496116638
2022-07-09 15:15:21,682 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:15:21,683 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:15:21,684 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013942644000053406
2022-07-09 15:15:21,684 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035060010850429535
2022-07-09 15:15:21,684 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:15:21,685 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.005
2022-07-09 15:15:21,685 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:15:21,686 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.005
2022-07-09 15:15:21,687 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:15:21,688 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.005
2022-07-09 15:15:22,298 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6098594181239605
2022-07-09 15:15:22,379 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:22,381 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0021632015705108643
2022-07-09 15:15:22,461 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7736366353929043
2022-07-09 15:15:22,490 - pytorch_cvae.py[line:399] - INFO: sampling time:0.8027296178042889
2022-07-09 15:15:22,646 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:22,651 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.004805590957403183
2022-07-09 15:15:22,667 - pytorch_cvae.py[line:399] - INFO: sampling time:0.982624314725399
2022-07-09 15:15:22,677 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.9909923821687698
2022-07-09 15:15:22,765 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:22,766 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0018495544791221619
2022-07-09 15:15:22,780 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.0952322147786617
2022-07-09 15:15:22,784 - main.py[line:542] - INFO: sample time: 1.1001561619341373
2022-07-09 15:15:22,794 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4566.90         956632310.41   
ARGENTINA      4538.41         953269856.04   
BRAZIL         4467.76         938595696.64   
CANADA         4542.33         955066459.84   
CHINA          4573.61         960229265.50   
EGYPT          4491.51         945683950.37   
ETHIOPIA       4420.86         931462699.83   
FRANCE         4599.86         966697810.12   
GERMANY        4582.56         963245746.52   
INDIA          4589.85         964667131.30   
INDONESIA      4500.86         945906091.90   
IRAN           4452.84         936584568.07   
IRAQ           4480.78         940233000.00   
JAPAN          4470.45         935208603.51   
JORDAN         4517.17         945984799.09   
KENYA          4418.95         924448775.59   
MOROCCO        4464.80         938868000.89   
MOZAMBIQUE     4526.31         949370303.78   
PERU           4586.97         964479168.71   
ROMANIA        4531.16         952308689.59   
RUSSIA         4421.09         928472417.74   
SAUDI ARABIA   4456.87         935444047.17   
UNITED KINGDOM 4384.30         923259073.99   
UNITED STATES  4549.17         953470239.85   
VIETNAM        4534.17         950960651.89   
2022-07-09 15:15:22,797 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:15:22,803 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.01            0.01           
CHINA          0.02            0.02           
EGYPT          0.00            0.00           
ETHIOPIA       0.02            0.02           
FRANCE         0.02            0.02           
GERMANY        0.02            0.02           
INDIA          0.02            0.02           
INDONESIA      0.00            0.00           
IRAN           0.01            0.01           
IRAQ           0.01            0.01           
JAPAN          0.00            0.00           
JORDAN         0.00            0.00           
KENYA          0.02            0.02           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.01            0.01           
PERU           0.02            0.02           
ROMANIA        0.01            0.01           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:15:22,805 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.01            0.01           
CHINA          0.02            0.02           
EGYPT          0.00            0.00           
ETHIOPIA       0.02            0.02           
FRANCE         0.02            0.02           
GERMANY        0.02            0.02           
INDIA          0.02            0.02           
INDONESIA      0.00            0.00           
IRAN           0.01            0.01           
IRAQ           0.01            0.01           
JAPAN          0.00            0.00           
JORDAN         0.00            0.00           
KENYA          0.02            0.02           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.01            0.01           
PERU           0.02            0.02           
ROMANIA        0.01            0.01           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:15:22,805 - main.py[line:554] - INFO: relative error average: 0.012052044344838609
2022-07-09 15:15:22,805 - main.py[line:555] - INFO: relative error normalized average: 0.011959868474376585
2022-07-09 15:15:22,806 - main.py[line:601] - INFO: total_time:3.339282773435116
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:29:12,257 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:29:12,257 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:29:12,258 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:29:12,258 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:29:12,428 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17081888765096664
2022-07-09 15:29:12,429 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:29:12,430 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:29:14,486 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0558583587408066
2022-07-09 15:29:14,486 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2282265052199364
2022-07-09 15:29:14,486 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:14,491 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.004447035491466522
2022-07-09 15:29:14,491 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:29:14,493 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:29:14,497 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.00393671914935112
2022-07-09 15:29:14,497 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.010801870375871658
2022-07-09 15:29:14,497 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:29:14,497 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.005
2022-07-09 15:29:15,058 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5599917136132717
2022-07-09 15:29:15,127 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:15,128 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0018850266933441162
2022-07-09 15:29:15,152 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.6548526212573051
2022-07-09 15:29:15,155 - main.py[line:542] - INFO: sample time: 0.6584508046507835
2022-07-09 15:29:15,165 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4461.50         934554339.84   
ARGENTINA      4440.46         932695603.47   
BRAZIL         4483.50         941901625.35   
CANADA         4595.66         966278567.51   
CHINA          4471.50         938792315.29   
EGYPT          4380.21         922249343.42   
ETHIOPIA       4450.02         937606056.90   
FRANCE         4329.38         909853322.26   
GERMANY        4505.37         947019222.72   
INDIA          4559.42         958271657.65   
INDONESIA      4452.33         935705350.67   
IRAN           4456.56         937365495.80   
IRAQ           4438.98         931462243.24   
JAPAN          4249.26         888937300.40   
JORDAN         4428.12         927336654.80   
KENYA          4372.41         914711870.20   
MOROCCO        4354.98         915773784.82   
MOZAMBIQUE     4469.37         937428385.80   
PERU           4404.15         926039438.62   
ROMANIA        4500.29         945821213.71   
RUSSIA         4504.32         945952412.42   
SAUDI ARABIA   4536.68         952194440.78   
UNITED KINGDOM 4610.15         970819110.91   
UNITED STATES  4360.73         913973101.54   
VIETNAM        4657.06         976735194.10   
2022-07-09 15:29:15,168 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:29:15,175 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.01            0.01           
EGYPT          0.03            0.03           
ETHIOPIA       0.01            0.01           
FRANCE         0.04            0.04           
GERMANY        0.00            0.00           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.01            0.01           
JAPAN          0.05            0.05           
JORDAN         0.02            0.02           
KENYA          0.03            0.03           
MOROCCO        0.03            0.03           
MOZAMBIQUE     0.01            0.01           
PERU           0.02            0.02           
ROMANIA        0.00            0.00           
RUSSIA         0.00            0.00           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.03            0.03           
UNITED STATES  0.03            0.03           
VIETNAM        0.04            0.04           
2022-07-09 15:29:15,177 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.01            0.01           
EGYPT          0.03            0.03           
ETHIOPIA       0.01            0.01           
FRANCE         0.04            0.04           
GERMANY        0.00            0.00           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.01            0.01           
JAPAN          0.05            0.05           
JORDAN         0.02            0.02           
KENYA          0.03            0.03           
MOROCCO        0.03            0.03           
MOZAMBIQUE     0.01            0.01           
PERU           0.02            0.02           
ROMANIA        0.00            0.00           
RUSSIA         0.00            0.00           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.03            0.03           
UNITED STATES  0.03            0.03           
VIETNAM        0.03            0.03           
2022-07-09 15:29:15,177 - main.py[line:554] - INFO: relative error average: 0.0173332086444887
2022-07-09 15:29:15,177 - main.py[line:555] - INFO: relative error normalized average: 0.017101009875338705
2022-07-09 15:29:15,178 - main.py[line:601] - INFO: total_time:2.920606032013893
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
