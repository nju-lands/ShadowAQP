main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:15:07,364 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:15:07,364 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:15:07,364 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:15:07,364 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:15:07,536 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17178023234009743
2022-07-09 15:15:07,536 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:15:07,537 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:15:09,587 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0494224950671196
2022-07-09 15:15:09,587 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.22271316498518
2022-07-09 15:15:09,587 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:09,588 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.00135064497590065
2022-07-09 15:15:09,588 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:15:09,589 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:15:09,590 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.001385960727930069
2022-07-09 15:15:09,590 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003493938595056534
2022-07-09 15:15:09,590 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:15:09,591 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.004
2022-07-09 15:15:09,591 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:15:09,592 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.004
2022-07-09 15:15:09,594 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:15:09,594 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.004
2022-07-09 15:15:10,174 - pytorch_cvae.py[line:399] - INFO: sampling time:0.579824760556221
2022-07-09 15:15:10,239 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:10,241 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0021440014243125916
2022-07-09 15:15:10,272 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.6782279275357723
2022-07-09 15:15:10,373 - pytorch_cvae.py[line:399] - INFO: sampling time:0.7799495831131935
2022-07-09 15:15:10,408 - pytorch_cvae.py[line:399] - INFO: sampling time:0.8171018064022064
2022-07-09 15:15:10,480 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:10,484 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0045944564044475555
2022-07-09 15:15:10,488 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:10,491 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0029008127748966217
2022-07-09 15:15:10,504 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.9119713976979256
2022-07-09 15:15:10,513 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.9220813624560833
2022-07-09 15:15:10,517 - main.py[line:542] - INFO: sample time: 0.9267816320061684
2022-07-09 15:15:10,525 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4479.70         938366876.40   
ARGENTINA      4504.30         946105263.05   
BRAZIL         4489.14         943087445.11   
CANADA         4474.18         940736339.31   
CHINA          4504.54         945728092.51   
EGYPT          4498.50         947154503.13   
ETHIOPIA       4549.87         958643170.08   
FRANCE         4500.05         945721733.55   
GERMANY        4448.34         935031283.09   
INDIA          4505.85         947012437.81   
INDONESIA      4570.05         960446068.17   
IRAN           4554.97         958064584.57   
IRAQ           4506.96         945726775.66   
JAPAN          4449.71         930869399.58   
JORDAN         4417.47         925106386.58   
KENYA          4439.52         928751740.17   
MOROCCO        4395.48         924289670.86   
MOZAMBIQUE     4536.39         951484319.52   
PERU           4501.95         946601669.93   
ROMANIA        4504.93         946795860.96   
RUSSIA         4407.53         925625640.17   
SAUDI ARABIA   4572.41         959693410.80   
UNITED KINGDOM 4468.54         940999266.60   
UNITED STATES  4530.40         949536481.80   
VIETNAM        4473.47         938228811.52   
2022-07-09 15:15:10,528 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:15:10,533 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.00            0.00           
BRAZIL         0.01            0.01           
CANADA         0.00            0.00           
CHINA          0.00            0.00           
EGYPT          0.00            0.00           
ETHIOPIA       0.01            0.01           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.02            0.02           
IRAN           0.01            0.01           
IRAQ           0.00            0.00           
JAPAN          0.01            0.01           
JORDAN         0.02            0.02           
KENYA          0.01            0.01           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.01            0.01           
PERU           0.00            0.00           
ROMANIA        0.00            0.00           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:15:10,535 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.00            0.00           
BRAZIL         0.01            0.01           
CANADA         0.00            0.00           
CHINA          0.00            0.00           
EGYPT          0.00            0.00           
ETHIOPIA       0.01            0.01           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.02            0.02           
IRAN           0.01            0.01           
IRAQ           0.00            0.00           
JAPAN          0.01            0.01           
JORDAN         0.02            0.02           
KENYA          0.01            0.01           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.01            0.01           
PERU           0.00            0.00           
ROMANIA        0.00            0.00           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:15:10,535 - main.py[line:554] - INFO: relative error average: 0.00784141668786973
2022-07-09 15:15:10,535 - main.py[line:555] - INFO: relative error normalized average: 0.007788368160761807
2022-07-09 15:15:10,536 - main.py[line:601] - INFO: total_time:3.1724108532071114
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:29:01,186 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:29:01,186 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:29:01,186 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:29:01,186 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:29:01,352 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16576197743415833
2022-07-09 15:29:01,352 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:29:01,353 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:29:03,401 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.047411810606718
2022-07-09 15:29:03,401 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2147016786038876
2022-07-09 15:29:03,401 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:03,402 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013511218130588531
2022-07-09 15:29:03,402 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:29:03,403 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:29:03,405 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014183707535266876
2022-07-09 15:29:03,405 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035314559936523438
2022-07-09 15:29:03,405 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:29:03,405 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.004
2022-07-09 15:29:03,946 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5406828187406063
2022-07-09 15:29:04,002 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:04,004 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0019057579338550568
2022-07-09 15:29:04,030 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.6252090930938721
2022-07-09 15:29:04,033 - main.py[line:542] - INFO: sample time: 0.628678448498249
2022-07-09 15:29:04,043 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4581.35         959660852.97   
ARGENTINA      4498.80         944950849.84   
BRAZIL         4464.63         937937917.02   
CANADA         4602.77         967773338.93   
CHINA          4482.15         941026676.22   
EGYPT          4479.85         943227645.77   
ETHIOPIA       4352.68         917096210.19   
FRANCE         4413.84         927603045.21   
GERMANY        4362.57         917003458.09   
INDIA          4634.68         974088348.78   
INDONESIA      4550.84         956408210.03   
IRAN           4512.96         949228445.43   
IRAQ           4640.16         973677727.70   
JAPAN          4636.02         969846412.28   
JORDAN         4464.83         935023807.37   
KENYA          4349.23         909862220.71   
MOROCCO        4559.52         958784402.25   
MOZAMBIQUE     4539.75         952189067.60   
PERU           4554.18         957583849.49   
ROMANIA        4556.78         957693160.05   
RUSSIA         4260.60         894767598.27   
SAUDI ARABIA   4563.51         957825924.75   
UNITED KINGDOM 4416.76         930093555.07   
UNITED STATES  4500.20         943205757.77   
VIETNAM        4402.72         923390615.54   
2022-07-09 15:29:04,046 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:29:04,052 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.00            0.00           
BRAZIL         0.01            0.01           
CANADA         0.03            0.03           
CHINA          0.00            0.00           
EGYPT          0.00            0.00           
ETHIOPIA       0.03            0.03           
FRANCE         0.02            0.02           
GERMANY        0.03            0.03           
INDIA          0.03            0.03           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.03            0.03           
JAPAN          0.03            0.03           
JORDAN         0.01            0.01           
KENYA          0.03            0.03           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.01            0.01           
PERU           0.01            0.01           
ROMANIA        0.01            0.01           
RUSSIA         0.06            0.06           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.00            0.00           
VIETNAM        0.02            0.02           
2022-07-09 15:29:04,054 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.00            0.00           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.00            0.00           
EGYPT          0.00            0.00           
ETHIOPIA       0.03            0.03           
FRANCE         0.02            0.02           
GERMANY        0.03            0.03           
INDIA          0.03            0.03           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.03            0.03           
JAPAN          0.03            0.03           
JORDAN         0.01            0.01           
KENYA          0.03            0.03           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.01            0.01           
PERU           0.01            0.01           
ROMANIA        0.01            0.01           
RUSSIA         0.05            0.05           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.00            0.00           
VIETNAM        0.02            0.02           
2022-07-09 15:29:04,054 - main.py[line:554] - INFO: relative error average: 0.01780382298090258
2022-07-09 15:29:04,054 - main.py[line:555] - INFO: relative error normalized average: 0.017568531522995166
2022-07-09 15:29:04,055 - main.py[line:601] - INFO: total_time:2.8690447583794594
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
