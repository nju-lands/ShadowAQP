main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:15:13,193 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:15:13,193 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:15:13,193 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:15:13,194 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:15:13,359 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16543404385447502
2022-07-09 15:15:13,359 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:15:13,360 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:15:15,403 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.042485326528549
2022-07-09 15:15:15,403 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.209449429064989
2022-07-09 15:15:15,403 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:15,404 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013459175825119019
2022-07-09 15:15:15,404 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:15:15,405 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:15:15,406 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014026351273059845
2022-07-09 15:15:15,407 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035226717591285706
2022-07-09 15:15:15,407 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:15:15,407 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.005
2022-07-09 15:15:15,407 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:15:15,409 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.005
2022-07-09 15:15:15,409 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:15:15,410 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.005
2022-07-09 15:15:16,180 - pytorch_cvae.py[line:399] - INFO: sampling time:0.7731180712580681
2022-07-09 15:15:16,250 - pytorch_cvae.py[line:399] - INFO: sampling time:0.8394801393151283
2022-07-09 15:15:16,326 - pytorch_cvae.py[line:399] - INFO: sampling time:0.9166600666940212
2022-07-09 15:15:16,430 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:16,439 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.008584447205066681
2022-07-09 15:15:16,568 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:16,591 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.022747505456209183
2022-07-09 15:15:16,674 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:16,695 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.021116994321346283
2022-07-09 15:15:16,738 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.3281910829246044
2022-07-09 15:15:16,740 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.3329898528754711
2022-07-09 15:15:16,771 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.3622132688760757
2022-07-09 15:15:16,776 - main.py[line:542] - INFO: sample time: 1.3689975887537003
2022-07-09 15:15:16,785 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4477.40         937884926.89   
ARGENTINA      4582.48         962526227.43   
BRAZIL         4518.15         949181678.06   
CANADA         4472.75         940436280.28   
CHINA          4538.80         952920711.50   
EGYPT          4418.38         930286359.13   
ETHIOPIA       4429.68         933319845.12   
FRANCE         4440.89         933287859.81   
GERMANY        4443.05         933919894.64   
INDIA          4508.15         947496961.47   
INDONESIA      4411.31         927085062.03   
IRAN           4449.20         935817330.38   
IRAQ           4484.60         941034777.71   
JAPAN          4365.51         913256710.08   
JORDAN         4427.64         927236378.48   
KENYA          4374.82         915217227.93   
MOROCCO        4497.80         945807273.45   
MOZAMBIQUE     4546.22         953546051.57   
PERU           4594.94         966154515.45   
ROMANIA        4505.85         946990163.09   
RUSSIA         4457.21         936058161.35   
SAUDI ARABIA   4411.71         925964259.11   
UNITED KINGDOM 4504.47         948563821.27   
UNITED STATES  4418.98         926183803.41   
VIETNAM        4403.77         923611398.22   
2022-07-09 15:15:16,787 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:15:16,794 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.02            0.02           
BRAZIL         0.00            0.00           
CANADA         0.00            0.00           
CHINA          0.01            0.01           
EGYPT          0.02            0.02           
ETHIOPIA       0.01            0.01           
FRANCE         0.01            0.01           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.02            0.02           
IRAN           0.01            0.01           
IRAQ           0.00            0.00           
JAPAN          0.03            0.03           
JORDAN         0.02            0.02           
KENYA          0.03            0.03           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.01            0.01           
PERU           0.02            0.02           
ROMANIA        0.00            0.00           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.02            0.02           
2022-07-09 15:15:16,796 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.02            0.02           
BRAZIL         0.00            0.00           
CANADA         0.00            0.00           
CHINA          0.01            0.01           
EGYPT          0.02            0.02           
ETHIOPIA       0.01            0.01           
FRANCE         0.01            0.01           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.02            0.02           
IRAN           0.01            0.01           
IRAQ           0.00            0.00           
JAPAN          0.03            0.03           
JORDAN         0.02            0.02           
KENYA          0.03            0.03           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.01            0.01           
PERU           0.02            0.02           
ROMANIA        0.00            0.00           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.02            0.02           
2022-07-09 15:15:16,796 - main.py[line:554] - INFO: relative error average: 0.01245076284762886
2022-07-09 15:15:16,796 - main.py[line:555] - INFO: relative error normalized average: 0.012340724436927084
2022-07-09 15:15:16,797 - main.py[line:601] - INFO: total_time:3.603996142745018
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:29:06,693 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:29:06,693 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:29:06,693 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:29:06,693 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:29:06,866 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.1728747971355915
2022-07-09 15:29:06,866 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:29:06,868 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:29:08,926 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0587433613836765
2022-07-09 15:29:08,926 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2331375554203987
2022-07-09 15:29:08,926 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:08,928 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013549774885177612
2022-07-09 15:29:08,928 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:29:08,928 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:29:08,930 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013984069228172302
2022-07-09 15:29:08,930 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0034990012645721436
2022-07-09 15:29:08,930 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:29:08,930 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.005
2022-07-09 15:29:09,495 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5640925355255604
2022-07-09 15:29:09,562 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:09,563 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0018667839467525482
2022-07-09 15:29:09,588 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.6580582819879055
2022-07-09 15:29:09,591 - main.py[line:542] - INFO: sample time: 0.6615130789577961
2022-07-09 15:29:09,601 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4405.21         922763310.11   
ARGENTINA      4473.87         939714038.59   
BRAZIL         4608.52         968166422.90   
CANADA         4558.16         958394487.58   
CHINA          4507.18         946283178.18   
EGYPT          4342.66         914342252.33   
ETHIOPIA       4630.28         975585118.54   
FRANCE         4426.39         930242216.27   
GERMANY        4527.79         951732197.58   
INDIA          4623.99         971842566.25   
INDONESIA      4386.17         921802840.74   
IRAN           4429.21         931612625.19   
IRAQ           4429.01         929369735.37   
JAPAN          4374.01         915033920.67   
JORDAN         4390.24         919404162.09   
KENYA          4563.61         954712749.59   
MOROCCO        4374.42         919862801.37   
MOZAMBIQUE     4607.07         966310914.99   
PERU           4439.45         933461646.09   
ROMANIA        4470.06         939467586.98   
RUSSIA         4381.20         920096695.60   
SAUDI ARABIA   4476.99         939667466.00   
UNITED KINGDOM 4583.42         965190684.26   
UNITED STATES  4666.17         977991379.22   
VIETNAM        4572.58         959016773.62   
2022-07-09 15:29:09,604 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:29:09,610 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.00            0.00           
BRAZIL         0.02            0.02           
CANADA         0.02            0.02           
CHINA          0.00            0.00           
EGYPT          0.03            0.03           
ETHIOPIA       0.03            0.03           
FRANCE         0.02            0.02           
GERMANY        0.01            0.01           
INDIA          0.03            0.03           
INDONESIA      0.02            0.02           
IRAN           0.02            0.02           
IRAQ           0.02            0.02           
JAPAN          0.03            0.03           
JORDAN         0.02            0.02           
KENYA          0.02            0.02           
MOROCCO        0.03            0.03           
MOZAMBIQUE     0.02            0.02           
PERU           0.01            0.01           
ROMANIA        0.01            0.01           
RUSSIA         0.03            0.03           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.04            0.04           
VIETNAM        0.02            0.02           
2022-07-09 15:29:09,612 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.00            0.00           
BRAZIL         0.02            0.02           
CANADA         0.02            0.02           
CHINA          0.00            0.00           
EGYPT          0.03            0.03           
ETHIOPIA       0.03            0.03           
FRANCE         0.02            0.02           
GERMANY        0.01            0.01           
INDIA          0.03            0.03           
INDONESIA      0.02            0.02           
IRAN           0.02            0.02           
IRAQ           0.02            0.02           
JAPAN          0.02            0.02           
JORDAN         0.02            0.02           
KENYA          0.02            0.02           
MOROCCO        0.03            0.03           
MOZAMBIQUE     0.02            0.02           
PERU           0.01            0.01           
ROMANIA        0.01            0.01           
RUSSIA         0.03            0.03           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.04            0.04           
VIETNAM        0.02            0.02           
2022-07-09 15:29:09,612 - main.py[line:554] - INFO: relative error average: 0.019096547396596737
2022-07-09 15:29:09,612 - main.py[line:555] - INFO: relative error normalized average: 0.018871720046071613
2022-07-09 15:29:09,613 - main.py[line:601] - INFO: total_time:2.9202584251761436
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
