main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:15:57,146 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:15:57,146 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:15:57,146 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:15:57,147 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:15:57,316 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16963788866996765
2022-07-09 15:15:57,316 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:15:57,318 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:15:59,367 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.049689617007971
2022-07-09 15:15:59,367 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.220825482159853
2022-07-09 15:15:59,367 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:59,369 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.001358959823846817
2022-07-09 15:15:59,369 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:15:59,369 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:15:59,371 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014168359339237213
2022-07-09 15:15:59,371 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003523577004671097
2022-07-09 15:15:59,371 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:15:59,371 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.008
2022-07-09 15:15:59,371 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:15:59,374 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.008
2022-07-09 15:15:59,374 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:15:59,375 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.008
2022-07-09 15:16:00,014 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6389086060225964
2022-07-09 15:16:00,134 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:00,137 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.002047669142484665
2022-07-09 15:16:00,439 - pytorch_cvae.py[line:399] - INFO: sampling time:1.0648979544639587
2022-07-09 15:16:00,523 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.1478213630616665
2022-07-09 15:16:00,539 - pytorch_cvae.py[line:399] - INFO: sampling time:1.167838554829359
2022-07-09 15:16:00,934 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:00,953 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.01911398023366928
2022-07-09 15:16:00,969 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:00,975 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.005975406616926193
2022-07-09 15:16:01,012 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.6380757316946983
2022-07-09 15:16:01,038 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.6666109263896942
2022-07-09 15:16:01,043 - main.py[line:542] - INFO: sample time: 1.6717334687709808
2022-07-09 15:16:01,053 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4481.97         938843588.91   
ARGENTINA      4444.66         933577802.57   
BRAZIL         4515.60         948646174.20   
CANADA         4514.67         949250106.76   
CHINA          4532.21         951536980.03   
EGYPT          4461.28         939318227.07   
ETHIOPIA       4493.33         946731953.26   
FRANCE         4504.22         946597655.44   
GERMANY        4514.17         948869177.43   
INDIA          4493.19         944351537.23   
INDONESIA      4542.77         954712516.29   
IRAN           4488.57         944098891.87   
IRAQ           4551.87         955150252.34   
JAPAN          4347.04         909391869.64   
JORDAN         4470.10         936127464.95   
KENYA          4458.53         932729191.02   
MOROCCO        4391.05         923359252.65   
MOZAMBIQUE     4521.35         948329849.47   
PERU           4553.43         957426528.33   
ROMANIA        4588.67         964395427.28   
RUSSIA         4434.89         931371472.35   
SAUDI ARABIA   4516.14         947883158.37   
UNITED KINGDOM 4479.32         943268740.61   
UNITED STATES  4554.47         954580064.86   
VIETNAM        4478.89         939367381.23   
2022-07-09 15:16:01,056 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:16:01,062 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.01            0.01           
BRAZIL         0.00            0.00           
CANADA         0.01            0.01           
CHINA          0.01            0.01           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.00            0.00           
GERMANY        0.00            0.00           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.01            0.01           
JAPAN          0.03            0.03           
JORDAN         0.01            0.01           
KENYA          0.01            0.01           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.01            0.01           
PERU           0.01            0.01           
ROMANIA        0.02            0.02           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.00            0.00           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.01            0.01           
VIETNAM        0.00            0.00           
2022-07-09 15:16:01,064 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.01            0.01           
BRAZIL         0.00            0.00           
CANADA         0.01            0.01           
CHINA          0.01            0.01           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.00            0.00           
GERMANY        0.00            0.00           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.01            0.01           
JAPAN          0.03            0.03           
JORDAN         0.01            0.01           
KENYA          0.01            0.01           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.01            0.01           
PERU           0.01            0.01           
ROMANIA        0.02            0.02           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.00            0.00           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.01            0.01           
VIETNAM        0.00            0.00           
2022-07-09 15:16:01,065 - main.py[line:554] - INFO: relative error average: 0.008503044824100107
2022-07-09 15:16:01,065 - main.py[line:555] - INFO: relative error normalized average: 0.008439586619118582
2022-07-09 15:16:01,066 - main.py[line:601] - INFO: total_time:3.919855948537588
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:29:45,895 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:29:45,895 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:29:45,895 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:29:45,895 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:29:46,067 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.1711651049554348
2022-07-09 15:29:46,067 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:29:46,068 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:29:48,147 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.079190466552973
2022-07-09 15:29:48,147 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.251894634217024
2022-07-09 15:29:48,147 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:48,149 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013551563024520874
2022-07-09 15:29:48,149 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:29:48,149 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:29:48,151 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014049261808395386
2022-07-09 15:29:48,151 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003534208983182907
2022-07-09 15:29:48,151 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:29:48,151 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.008
2022-07-09 15:29:48,754 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6028408855199814
2022-07-09 15:29:48,859 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:48,861 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0019377991557121277
2022-07-09 15:29:48,891 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7397827655076981
2022-07-09 15:29:48,894 - main.py[line:542] - INFO: sample time: 0.7431242913007736
2022-07-09 15:29:48,904 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4457.09         933630720.95   
ARGENTINA      4458.63         936513782.04   
BRAZIL         4392.95         922879002.76   
CANADA         4601.28         967461176.61   
CHINA          4586.65         962966932.48   
EGYPT          4374.10         920962077.03   
ETHIOPIA       4433.40         934103058.37   
FRANCE         4368.68         918113117.02   
GERMANY        4589.32         964665974.58   
INDIA          4507.63         947385892.62   
INDONESIA      4543.47         954860723.92   
IRAN           4505.01         947556831.93   
IRAQ           4515.40         947498368.65   
JAPAN          4540.78         949921421.65   
JORDAN         4480.51         938309177.94   
KENYA          4521.49         945899458.49   
MOROCCO        4516.16         949667520.73   
MOZAMBIQUE     4567.73         958057546.47   
PERU           4540.73         954755999.04   
ROMANIA        4565.19         959460412.26   
RUSSIA         4417.66         927752353.00   
SAUDI ARABIA   4456.41         935346833.11   
UNITED KINGDOM 4494.18         946396884.60   
UNITED STATES  4426.52         927763451.56   
VIETNAM        4525.49         949140522.29   
2022-07-09 15:29:48,906 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:29:48,912 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.01            0.01           
BRAZIL         0.03            0.03           
CANADA         0.02            0.02           
CHINA          0.02            0.02           
EGYPT          0.03            0.03           
ETHIOPIA       0.01            0.01           
FRANCE         0.03            0.03           
GERMANY        0.02            0.02           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.00            0.00           
JAPAN          0.01            0.01           
JORDAN         0.00            0.00           
KENYA          0.01            0.01           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.02            0.02           
PERU           0.01            0.01           
ROMANIA        0.02            0.02           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.01            0.01           
2022-07-09 15:29:48,914 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.01            0.01           
BRAZIL         0.03            0.03           
CANADA         0.02            0.02           
CHINA          0.02            0.02           
EGYPT          0.03            0.03           
ETHIOPIA       0.01            0.01           
FRANCE         0.03            0.03           
GERMANY        0.02            0.02           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.00            0.00           
JAPAN          0.01            0.01           
JORDAN         0.00            0.00           
KENYA          0.01            0.01           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.02            0.02           
PERU           0.01            0.01           
ROMANIA        0.02            0.02           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.01            0.01           
2022-07-09 15:29:48,914 - main.py[line:554] - INFO: relative error average: 0.012427509077829784
2022-07-09 15:29:48,914 - main.py[line:555] - INFO: relative error normalized average: 0.012314065161169736
2022-07-09 15:29:48,915 - main.py[line:601] - INFO: total_time:3.0199117474257946
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
