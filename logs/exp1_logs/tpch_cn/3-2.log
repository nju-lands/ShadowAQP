main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:14:55,548 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:14:55,548 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:14:55,548 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:14:55,548 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:14:55,721 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.1729743741452694
2022-07-09 15:14:55,721 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:14:55,722 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:14:57,774 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0516907796263695
2022-07-09 15:14:57,774 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.226165007799864
2022-07-09 15:14:57,774 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:57,776 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013766735792160034
2022-07-09 15:14:57,776 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:14:57,776 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:14:57,778 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013703592121601105
2022-07-09 15:14:57,778 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0034930258989334106
2022-07-09 15:14:57,778 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:14:57,778 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.003
2022-07-09 15:14:57,778 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:14:57,780 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.003
2022-07-09 15:14:57,781 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:14:57,782 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.003
2022-07-09 15:14:58,353 - pytorch_cvae.py[line:399] - INFO: sampling time:0.574757881462574
2022-07-09 15:14:58,402 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:58,405 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0025511346757411957
2022-07-09 15:14:58,429 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.6514558121562004
2022-07-09 15:14:58,533 - pytorch_cvae.py[line:399] - INFO: sampling time:0.7503389865159988
2022-07-09 15:14:58,585 - pytorch_cvae.py[line:399] - INFO: sampling time:0.804292842745781
2022-07-09 15:14:58,682 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:58,699 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.01712288334965706
2022-07-09 15:14:58,721 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:58,726 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.004698541015386581
2022-07-09 15:14:58,758 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.9759101122617722
2022-07-09 15:14:58,782 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.0013190060853958
2022-07-09 15:14:58,786 - main.py[line:542] - INFO: sample time: 1.0087550170719624
2022-07-09 15:14:58,796 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4555.00         954140214.61   
ARGENTINA      4629.42         972387015.57   
BRAZIL         4486.62         942558882.73   
CANADA         4402.20         925602157.79   
CHINA          4667.30         979900329.17   
EGYPT          4536.16         955084307.15   
ETHIOPIA       4453.17         938268804.45   
FRANCE         4423.77         929691179.60   
GERMANY        4540.38         954379699.16   
INDIA          4482.45         942093514.19   
INDONESIA      4462.29         937799103.38   
IRAN           4502.29         946983942.79   
IRAQ           4603.95         966078133.70   
JAPAN          4385.74         917487482.16   
JORDAN         4461.53         934333926.32   
KENYA          4493.19         939979203.64   
MOROCCO        4468.54         939652594.98   
MOZAMBIQUE     4684.69         982591297.99   
PERU           4588.79         964861032.75   
ROMANIA        4604.75         967776358.39   
RUSSIA         4424.38         929164085.21   
SAUDI ARABIA   4498.49         944178317.96   
UNITED KINGDOM 4438.84         934744292.40   
UNITED STATES  4445.19         931676791.94   
VIETNAM        4425.44         928155464.57   
2022-07-09 15:14:58,799 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:14:58,806 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.03            0.03           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.04            0.04           
EGYPT          0.01            0.01           
ETHIOPIA       0.01            0.01           
FRANCE         0.02            0.02           
GERMANY        0.01            0.01           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.02            0.02           
JAPAN          0.02            0.02           
JORDAN         0.01            0.01           
KENYA          0.00            0.00           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.04            0.04           
PERU           0.02            0.02           
ROMANIA        0.02            0.02           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.00            0.00           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.01            0.01           
VIETNAM        0.02            0.02           
2022-07-09 15:14:58,808 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.03            0.03           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.04            0.04           
EGYPT          0.01            0.01           
ETHIOPIA       0.01            0.01           
FRANCE         0.02            0.02           
GERMANY        0.01            0.01           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.02            0.02           
JAPAN          0.02            0.02           
JORDAN         0.01            0.01           
KENYA          0.00            0.00           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.04            0.04           
PERU           0.02            0.02           
ROMANIA        0.02            0.02           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.00            0.00           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.01            0.01           
VIETNAM        0.02            0.02           
2022-07-09 15:14:58,808 - main.py[line:554] - INFO: relative error average: 0.014780897274698368
2022-07-09 15:14:58,808 - main.py[line:555] - INFO: relative error normalized average: 0.014617620977375298
2022-07-09 15:14:58,809 - main.py[line:601] - INFO: total_time:3.261542286723852
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:28:50,201 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:28:50,201 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:28:50,201 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:28:50,201 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:28:50,372 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.1710657849907875
2022-07-09 15:28:50,372 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:28:50,374 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:28:52,410 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.036040298640728
2022-07-09 15:28:52,410 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2086311280727386
2022-07-09 15:28:52,410 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:52,411 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013599582016468048
2022-07-09 15:28:52,411 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:28:52,412 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:28:52,413 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014081262052059174
2022-07-09 15:28:52,413 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003519956022500992
2022-07-09 15:28:52,413 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:28:52,414 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.003
2022-07-09 15:28:52,950 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5358362309634686
2022-07-09 15:28:52,991 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:52,993 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0017728917300701141
2022-07-09 15:28:53,011 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.597319982945919
2022-07-09 15:28:53,014 - main.py[line:542] - INFO: sample time: 0.6008036583662033
2022-07-09 15:28:53,024 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4563.92         956009052.64   
ARGENTINA      4483.57         941750494.78   
BRAZIL         4492.08         943705855.25   
CANADA         4640.75         975760473.14   
CHINA          4522.29         949455487.60   
EGYPT          4707.70         991201509.22   
ETHIOPIA       4358.95         918417203.22   
FRANCE         4376.60         919776877.49   
GERMANY        4467.38         939035010.26   
INDIA          4615.67         970093051.77   
INDONESIA      4413.02         927443739.68   
IRAN           4495.15         945483577.81   
IRAQ           4373.07         917632275.51   
JAPAN          4531.53         947987645.28   
JORDAN         4576.21         958348955.32   
KENYA          4458.75         932774924.45   
MOROCCO        4524.11         951339497.88   
MOZAMBIQUE     4703.63         986563564.97   
PERU           4586.65         964411114.09   
ROMANIA        4621.68         971333236.29   
RUSSIA         4451.22         934800725.37   
SAUDI ARABIA   4776.19         1002464884.13  
UNITED KINGDOM 4478.65         943127569.02   
UNITED STATES  4416.62         925687506.49   
VIETNAM        4519.72         947929149.96   
2022-07-09 15:28:53,027 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:28:53,033 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.00            0.00           
BRAZIL         0.00            0.00           
CANADA         0.03            0.03           
CHINA          0.00            0.00           
EGYPT          0.05            0.05           
ETHIOPIA       0.03            0.03           
FRANCE         0.03            0.03           
GERMANY        0.01            0.01           
INDIA          0.02            0.02           
INDONESIA      0.02            0.02           
IRAN           0.00            0.00           
IRAQ           0.03            0.03           
JAPAN          0.01            0.01           
JORDAN         0.02            0.02           
KENYA          0.01            0.01           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.05            0.05           
PERU           0.02            0.02           
ROMANIA        0.03            0.03           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.06            0.06           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.00            0.00           
2022-07-09 15:28:53,035 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.00            0.00           
BRAZIL         0.00            0.00           
CANADA         0.03            0.03           
CHINA          0.00            0.00           
EGYPT          0.05            0.05           
ETHIOPIA       0.03            0.03           
FRANCE         0.03            0.03           
GERMANY        0.01            0.01           
INDIA          0.02            0.02           
INDONESIA      0.02            0.02           
IRAN           0.00            0.00           
IRAQ           0.03            0.03           
JAPAN          0.01            0.01           
JORDAN         0.02            0.02           
KENYA          0.01            0.01           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.04            0.04           
PERU           0.02            0.02           
ROMANIA        0.03            0.03           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.06            0.06           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.00            0.00           
2022-07-09 15:28:53,035 - main.py[line:554] - INFO: relative error average: 0.018935637767583988
2022-07-09 15:28:53,035 - main.py[line:555] - INFO: relative error normalized average: 0.018643831457191545
2022-07-09 15:28:53,037 - main.py[line:601] - INFO: total_time:2.835712321102619
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
