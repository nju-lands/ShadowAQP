main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:14:43,893 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:14:43,893 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:14:43,893 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:14:43,893 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:14:44,063 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16938678547739983
2022-07-09 15:14:44,063 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:14:44,064 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:14:46,107 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0433803163468838
2022-07-09 15:14:46,107 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.214288506656885
2022-07-09 15:14:46,107 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:46,109 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013564564287662506
2022-07-09 15:14:46,109 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:14:46,110 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:14:46,111 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014016814529895782
2022-07-09 15:14:46,111 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.00350368395447731
2022-07-09 15:14:46,111 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:14:46,111 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.002
2022-07-09 15:14:46,112 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:14:46,114 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.002
2022-07-09 15:14:46,114 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:14:46,115 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.002
2022-07-09 15:14:46,672 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5606293939054012
2022-07-09 15:14:46,708 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:46,710 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0019963830709457397
2022-07-09 15:14:46,792 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.6804258450865746
2022-07-09 15:14:46,839 - pytorch_cvae.py[line:399] - INFO: sampling time:0.7249108254909515
2022-07-09 15:14:46,852 - pytorch_cvae.py[line:399] - INFO: sampling time:0.7363083995878696
2022-07-09 15:14:46,941 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:46,954 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.012100063264369965
2022-07-09 15:14:46,971 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:46,976 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.005013737827539444
2022-07-09 15:14:47,008 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.8941930010914803
2022-07-09 15:14:47,032 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.9167405106127262
2022-07-09 15:14:47,036 - main.py[line:542] - INFO: sample time: 0.9253972209990025
2022-07-09 15:14:47,046 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4408.53         923458774.53   
ARGENTINA      4721.78         991786990.40   
BRAZIL         4537.15         953174458.62   
CANADA         4500.02         946168908.85   
CHINA          4660.53         978477464.74   
EGYPT          4523.59         952436810.35   
ETHIOPIA       4515.45         951390716.99   
FRANCE         4350.17         914223417.64   
GERMANY        4470.30         939647205.32   
INDIA          4542.33         954680278.34   
INDONESIA      4577.11         961930955.46   
IRAN           4658.35         979810063.45   
IRAQ           4683.79         982832882.59   
JAPAN          4587.53         959701598.53   
JORDAN         4407.52         923021997.94   
KENYA          4279.86         895350430.07   
MOROCCO        4386.18         922335746.15   
MOZAMBIQUE     4494.49         942697628.30   
PERU           4430.53         931585539.59   
ROMANIA        4548.58         955970945.16   
RUSSIA         4552.74         956120604.08   
SAUDI ARABIA   4582.19         961746051.35   
UNITED KINGDOM 4324.58         910682060.70   
UNITED STATES  4621.21         968569423.23   
VIETNAM        4554.04         955127515.92   
2022-07-09 15:14:47,049 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:14:47,055 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.05            0.05           
BRAZIL         0.01            0.01           
CANADA         0.00            0.00           
CHINA          0.03            0.03           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.03            0.03           
GERMANY        0.01            0.01           
INDIA          0.01            0.01           
INDONESIA      0.02            0.02           
IRAN           0.03            0.03           
IRAQ           0.04            0.04           
JAPAN          0.02            0.02           
JORDAN         0.02            0.02           
KENYA          0.05            0.05           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.00            0.00           
PERU           0.02            0.02           
ROMANIA        0.01            0.01           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.04            0.04           
UNITED STATES  0.03            0.03           
VIETNAM        0.01            0.01           
2022-07-09 15:14:47,057 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.05            0.05           
BRAZIL         0.01            0.01           
CANADA         0.00            0.00           
CHINA          0.03            0.03           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.03            0.03           
GERMANY        0.01            0.01           
INDIA          0.01            0.01           
INDONESIA      0.02            0.02           
IRAN           0.03            0.03           
IRAQ           0.04            0.04           
JAPAN          0.02            0.02           
JORDAN         0.02            0.02           
KENYA          0.05            0.05           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.00            0.00           
PERU           0.02            0.02           
ROMANIA        0.01            0.01           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.04            0.04           
UNITED STATES  0.03            0.03           
VIETNAM        0.01            0.01           
2022-07-09 15:14:47,057 - main.py[line:554] - INFO: relative error average: 0.020344795131186505
2022-07-09 15:14:47,057 - main.py[line:555] - INFO: relative error normalized average: 0.02003944841975753
2022-07-09 15:14:47,058 - main.py[line:601] - INFO: total_time:3.165551997721195
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:28:39,195 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:28:39,195 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:28:39,195 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:28:39,195 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:28:39,371 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17663603648543358
2022-07-09 15:28:39,372 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:28:39,376 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:28:41,433 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0571074560284615
2022-07-09 15:28:41,433 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2379343397915363
2022-07-09 15:28:41,433 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:41,434 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.001369968056678772
2022-07-09 15:28:41,434 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:28:41,435 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:28:41,436 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013789497315883636
2022-07-09 15:28:41,436 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035090111196041107
2022-07-09 15:28:41,436 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:28:41,437 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.002
2022-07-09 15:28:41,952 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5154096335172653
2022-07-09 15:28:41,980 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:41,982 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0016832537949085236
2022-07-09 15:28:42,007 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.5702332630753517
2022-07-09 15:28:42,009 - main.py[line:542] - INFO: sample time: 0.5730030909180641
2022-07-09 15:28:42,019 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4520.35         946882463.45   
ARGENTINA      4737.55         995099310.23   
BRAZIL         4320.85         907731874.36   
CANADA         4496.06         945337821.92   
CHINA          4571.23         959730779.04   
EGYPT          4349.27         915735134.81   
ETHIOPIA       4407.39         928623557.24   
FRANCE         4533.36         952722109.55   
GERMANY        4596.88         966253959.96   
INDIA          4571.10         960726471.28   
INDONESIA      4626.15         972236424.32   
IRAN           4292.14         902783293.75   
IRAQ           4758.31         998469678.94   
JAPAN          4432.70         927312400.00   
JORDAN         4670.15         978023675.81   
KENYA          4478.56         936918740.99   
MOROCCO        4288.28         901748002.79   
MOZAMBIQUE     4174.81         875644651.90   
PERU           4528.87         952261889.69   
ROMANIA        4171.46         876711919.24   
RUSSIA         4557.68         957158000.96   
SAUDI ARABIA   4326.12         908000722.85   
UNITED KINGDOM 4379.65         922280240.15   
UNITED STATES  4593.18         962694516.76   
VIETNAM        4630.85         971238137.19   
2022-07-09 15:28:42,021 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:28:42,027 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.06            0.06           
BRAZIL         0.04            0.04           
CANADA         0.00            0.00           
CHINA          0.01            0.01           
EGYPT          0.03            0.03           
ETHIOPIA       0.02            0.02           
FRANCE         0.01            0.01           
GERMANY        0.02            0.02           
INDIA          0.01            0.01           
INDONESIA      0.03            0.03           
IRAN           0.05            0.05           
IRAQ           0.06            0.06           
JAPAN          0.01            0.01           
JORDAN         0.04            0.04           
KENYA          0.00            0.00           
MOROCCO        0.05            0.05           
MOZAMBIQUE     0.07            0.07           
PERU           0.01            0.01           
ROMANIA        0.07            0.07           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.04            0.04           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.02            0.02           
VIETNAM        0.03            0.03           
2022-07-09 15:28:42,029 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.06            0.06           
BRAZIL         0.04            0.04           
CANADA         0.00            0.00           
CHINA          0.01            0.01           
EGYPT          0.03            0.03           
ETHIOPIA       0.02            0.02           
FRANCE         0.01            0.01           
GERMANY        0.02            0.02           
INDIA          0.01            0.01           
INDONESIA      0.03            0.03           
IRAN           0.05            0.05           
IRAQ           0.05            0.05           
JAPAN          0.01            0.01           
JORDAN         0.04            0.04           
KENYA          0.00            0.00           
MOROCCO        0.05            0.05           
MOZAMBIQUE     0.07            0.07           
PERU           0.01            0.01           
ROMANIA        0.07            0.07           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.04            0.04           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.02            0.02           
VIETNAM        0.03            0.03           
2022-07-09 15:28:42,029 - main.py[line:554] - INFO: relative error average: 0.029074894380163006
2022-07-09 15:28:42,029 - main.py[line:555] - INFO: relative error normalized average: 0.028454017155532495
2022-07-09 15:28:42,030 - main.py[line:601] - INFO: total_time:2.835792411118746
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
