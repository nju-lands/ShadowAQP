main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:15:44,282 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:15:44,282 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:15:44,283 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:15:44,283 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:15:44,452 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16981421411037445
2022-07-09 15:15:44,453 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:15:44,454 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:15:46,495 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.041153661906719
2022-07-09 15:15:46,495 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.212488368153572
2022-07-09 15:15:46,495 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:46,497 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0015671439468860626
2022-07-09 15:15:46,497 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:15:46,497 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:15:46,499 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014439262449741364
2022-07-09 15:15:46,499 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003787863999605179
2022-07-09 15:15:46,499 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:15:46,499 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.007
2022-07-09 15:15:46,499 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:15:46,501 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.007
2022-07-09 15:15:46,502 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:15:46,503 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.007
2022-07-09 15:15:47,247 - pytorch_cvae.py[line:399] - INFO: sampling time:0.7450840994715691
2022-07-09 15:15:47,334 - pytorch_cvae.py[line:399] - INFO: sampling time:0.8342980928719044
2022-07-09 15:15:47,597 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:47,604 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.006286237388849258
2022-07-09 15:15:47,629 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:47,634 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0045219361782073975
2022-07-09 15:15:47,750 - pytorch_cvae.py[line:399] - INFO: sampling time:1.2471422404050827
2022-07-09 15:15:47,874 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.3743181675672531
2022-07-09 15:15:47,875 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.3740080669522285
2022-07-09 15:15:47,937 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:47,939 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0018868297338485718
2022-07-09 15:15:47,954 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.4511849470436573
2022-07-09 15:15:47,958 - main.py[line:542] - INFO: sample time: 1.4592953957617283
2022-07-09 15:15:47,967 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4471.95         936743300.64   
ARGENTINA      4634.47         973447022.46   
BRAZIL         4507.70         946986668.50   
CANADA         4514.97         949312073.16   
CHINA          4518.68         948696214.92   
EGYPT          4444.27         935736857.62   
ETHIOPIA       4478.55         943617644.76   
FRANCE         4422.53         929429210.98   
GERMANY        4391.91         923170662.85   
INDIA          4502.00         946203066.29   
INDONESIA      4455.62         936398407.56   
IRAN           4466.21         939396424.67   
IRAQ           4508.60         946071776.31   
JAPAN          4471.68         935467485.02   
JORDAN         4444.59         930785549.00   
KENYA          4401.06         920706115.56   
MOROCCO        4389.50         923033454.54   
MOZAMBIQUE     4542.58         952784306.14   
PERU           4578.52         962703095.53   
ROMANIA        4494.06         944511483.83   
RUSSIA         4495.94         944191743.94   
SAUDI ARABIA   4443.26         932586470.76   
UNITED KINGDOM 4451.33         937374116.48   
UNITED STATES  4491.42         941364841.74   
VIETNAM        4573.46         959201956.98   
2022-07-09 15:15:47,970 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:15:47,977 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.03            0.03           
BRAZIL         0.00            0.00           
CANADA         0.01            0.01           
CHINA          0.00            0.00           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.02            0.02           
GERMANY        0.02            0.02           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.00            0.00           
JAPAN          0.00            0.00           
JORDAN         0.01            0.01           
KENYA          0.02            0.02           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.01            0.01           
PERU           0.02            0.02           
ROMANIA        0.00            0.00           
RUSSIA         0.00            0.00           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.00            0.00           
VIETNAM        0.02            0.02           
2022-07-09 15:15:47,979 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.03            0.03           
BRAZIL         0.00            0.00           
CANADA         0.01            0.01           
CHINA          0.00            0.00           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.02            0.02           
GERMANY        0.02            0.02           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.00            0.00           
JAPAN          0.00            0.00           
JORDAN         0.01            0.01           
KENYA          0.02            0.02           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.01            0.01           
PERU           0.02            0.02           
ROMANIA        0.00            0.00           
RUSSIA         0.00            0.00           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.00            0.00           
VIETNAM        0.02            0.02           
2022-07-09 15:15:47,979 - main.py[line:554] - INFO: relative error average: 0.010278072747559519
2022-07-09 15:15:47,979 - main.py[line:555] - INFO: relative error normalized average: 0.01018899357518254
2022-07-09 15:15:47,980 - main.py[line:601] - INFO: total_time:3.697727259248495
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:29:34,621 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:29:34,622 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:29:34,622 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:29:34,622 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:29:34,792 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17038967460393906
2022-07-09 15:29:34,792 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:29:34,793 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:29:36,859 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0655726715922356
2022-07-09 15:29:36,859 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2375033646821976
2022-07-09 15:29:36,859 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:36,861 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.001359499990940094
2022-07-09 15:29:36,861 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:29:36,861 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:29:36,863 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013768672943115234
2022-07-09 15:29:36,863 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035028718411922455
2022-07-09 15:29:36,863 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:29:36,863 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.007
2022-07-09 15:29:37,454 - pytorch_cvae.py[line:399] - INFO: sampling time:0.590308029204607
2022-07-09 15:29:37,547 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:37,549 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0019233338534832
2022-07-09 15:29:37,578 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7150988653302193
2022-07-09 15:29:37,581 - main.py[line:542] - INFO: sample time: 0.7181014232337475
2022-07-09 15:29:37,590 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4413.72         924545778.56   
ARGENTINA      4689.45         984995452.60   
BRAZIL         4460.03         936971619.30   
CANADA         4589.92         965071602.70   
CHINA          4459.36         936242760.67   
EGYPT          4428.34         932383340.97   
ETHIOPIA       4489.70         945966781.13   
FRANCE         4487.73         943132041.15   
GERMANY        4471.21         939838948.78   
INDIA          4428.27         930706665.27   
INDONESIA      4427.74         930539081.02   
IRAN           4439.37         933750415.33   
IRAQ           4456.31         935099001.02   
JAPAN          4518.35         945230510.95   
JORDAN         4529.23         948511762.50   
KENYA          4356.46         911376661.54   
MOROCCO        4429.71         931488452.44   
MOZAMBIQUE     4505.34         944972191.03   
PERU           4610.80         969488903.21   
ROMANIA        4517.80         949502205.55   
RUSSIA         4398.75         923780814.44   
SAUDI ARABIA   4430.29         929864697.03   
UNITED KINGDOM 4502.03         948050869.59   
UNITED STATES  4474.20         937755767.29   
VIETNAM        4523.33         948687756.74   
2022-07-09 15:29:37,592 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:29:37,598 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.05            0.05           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.01            0.01           
EGYPT          0.02            0.02           
ETHIOPIA       0.00            0.00           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.02            0.02           
INDONESIA      0.01            0.01           
IRAN           0.02            0.02           
IRAQ           0.01            0.01           
JAPAN          0.01            0.01           
JORDAN         0.01            0.01           
KENYA          0.03            0.03           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.00            0.00           
PERU           0.02            0.02           
ROMANIA        0.01            0.01           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:29:37,600 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.04            0.04           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.01            0.01           
EGYPT          0.02            0.02           
ETHIOPIA       0.00            0.00           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.02            0.02           
INDONESIA      0.01            0.01           
IRAN           0.02            0.02           
IRAQ           0.01            0.01           
JAPAN          0.01            0.01           
JORDAN         0.01            0.01           
KENYA          0.03            0.03           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.00            0.00           
PERU           0.02            0.02           
ROMANIA        0.01            0.01           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:29:37,600 - main.py[line:554] - INFO: relative error average: 0.013532861492305495
2022-07-09 15:29:37,600 - main.py[line:555] - INFO: relative error normalized average: 0.013389566470891385
2022-07-09 15:29:37,601 - main.py[line:601] - INFO: total_time:2.9797541238367558
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
