main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:15:31,606 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:15:31,606 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:15:31,606 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:15:31,606 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:15:31,776 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16940133646130562
2022-07-09 15:15:31,776 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:15:31,777 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:15:33,817 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.040163390338421
2022-07-09 15:15:33,817 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2110645696520805
2022-07-09 15:15:33,817 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:33,819 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.001378968358039856
2022-07-09 15:15:33,819 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:15:33,820 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:15:33,821 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013896562159061432
2022-07-09 15:15:33,821 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003514263778924942
2022-07-09 15:15:33,821 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:15:33,821 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.006
2022-07-09 15:15:33,822 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:15:33,823 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.006
2022-07-09 15:15:33,824 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:15:33,825 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.006
2022-07-09 15:15:34,441 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6170794107019901
2022-07-09 15:15:34,536 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:34,539 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0022244900465011597
2022-07-09 15:15:34,565 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7425076216459274
2022-07-09 15:15:34,707 - pytorch_cvae.py[line:399] - INFO: sampling time:0.8853992559015751
2022-07-09 15:15:34,792 - pytorch_cvae.py[line:399] - INFO: sampling time:0.9666599407792091
2022-07-09 15:15:34,969 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:34,984 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.014540079981088638
2022-07-09 15:15:35,053 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.2318709753453732
2022-07-09 15:15:35,059 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:35,065 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.005925681442022324
2022-07-09 15:15:35,089 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.264517243951559
2022-07-09 15:15:35,094 - main.py[line:542] - INFO: sample time: 1.2727459147572517
2022-07-09 15:15:35,104 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4527.84         948451877.98   
ARGENTINA      4569.71         959844561.76   
BRAZIL         4532.53         952203844.92   
CANADA         4492.69         944627635.10   
CHINA          4500.77         944935982.49   
EGYPT          4431.89         933130505.42   
ETHIOPIA       4474.98         942865066.45   
FRANCE         4411.19         927047538.08   
GERMANY        4471.25         939847025.24   
INDIA          4498.99         945571614.24   
INDONESIA      4519.56         949834989.74   
IRAN           4459.31         937943875.53   
IRAQ           4665.04         978898328.72   
JAPAN          4508.77         943225179.42   
JORDAN         4415.34         924659670.16   
KENYA          4516.17         944786255.31   
MOROCCO        4452.75         936332129.18   
MOZAMBIQUE     4507.10         945342588.32   
PERU           4558.16         958421319.59   
ROMANIA        4464.65         938330507.98   
RUSSIA         4452.30         935027788.59   
SAUDI ARABIA   4463.63         936863064.44   
UNITED KINGDOM 4486.72         944827473.63   
UNITED STATES  4417.91         925958573.55   
VIETNAM        4438.29         930852165.48   
2022-07-09 15:15:35,106 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:15:35,113 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.02            0.02           
BRAZIL         0.00            0.00           
CANADA         0.00            0.00           
CHINA          0.00            0.00           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.02            0.02           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.04            0.04           
JAPAN          0.00            0.00           
JORDAN         0.02            0.02           
KENYA          0.01            0.01           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.00            0.00           
PERU           0.01            0.01           
ROMANIA        0.01            0.01           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.01            0.01           
2022-07-09 15:15:35,115 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.02            0.02           
BRAZIL         0.00            0.00           
CANADA         0.00            0.00           
CHINA          0.00            0.00           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.02            0.02           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.03            0.03           
JAPAN          0.00            0.00           
JORDAN         0.02            0.02           
KENYA          0.01            0.01           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.00            0.00           
PERU           0.01            0.01           
ROMANIA        0.01            0.01           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.01            0.01           
2022-07-09 15:15:35,115 - main.py[line:554] - INFO: relative error average: 0.009752553878277696
2022-07-09 15:15:35,115 - main.py[line:555] - INFO: relative error normalized average: 0.009674640970383336
2022-07-09 15:15:35,116 - main.py[line:601] - INFO: total_time:3.5100242160260677
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:29:23,404 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:29:23,405 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:29:23,405 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:29:23,405 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:29:23,575 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17045051977038383
2022-07-09 15:29:23,575 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:29:23,577 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:29:25,645 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.068442054092884
2022-07-09 15:29:25,645 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2404161915183067
2022-07-09 15:29:25,645 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:25,647 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.001348111778497696
2022-07-09 15:29:25,647 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:29:25,647 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:29:25,649 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.001400243490934372
2022-07-09 15:29:25,649 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003499060869216919
2022-07-09 15:29:25,649 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:29:25,649 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.006
2022-07-09 15:29:26,224 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5748111754655838
2022-07-09 15:29:26,305 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:26,307 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.001889050006866455
2022-07-09 15:29:26,331 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.6813893131911755
2022-07-09 15:29:26,334 - main.py[line:542] - INFO: sample time: 0.684774924069643
2022-07-09 15:29:26,343 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4360.23         913341709.27   
ARGENTINA      4648.35         976361724.19   
BRAZIL         4430.68         930805869.76   
CANADA         4569.62         960803870.32   
CHINA          4598.12         965374461.60   
EGYPT          4371.05         920320546.68   
ETHIOPIA       4396.90         926413807.35   
FRANCE         4523.58         950667391.39   
GERMANY        4442.65         933836690.92   
INDIA          4484.58         942541984.88   
INDONESIA      4637.92         974709415.28   
IRAN           4481.24         942556566.88   
IRAQ           4343.95         911521243.21   
JAPAN          4538.52         949450074.79   
JORDAN         4506.47         943744889.32   
KENYA          4499.24         941246058.11   
MOROCCO        4516.10         949654106.09   
MOZAMBIQUE     4613.52         967661922.69   
PERU           4676.94         983397094.52   
ROMANIA        4656.35         978621127.15   
RUSSIA         4360.52         915752140.08   
SAUDI ARABIA   4382.87         919912377.98   
UNITED KINGDOM 4573.22         963042918.48   
UNITED STATES  4553.08         954288579.22   
VIETNAM        4463.48         936134758.09   
2022-07-09 15:29:26,345 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:29:26,352 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.03            0.03           
ARGENTINA      0.04            0.04           
BRAZIL         0.02            0.02           
CANADA         0.02            0.02           
CHINA          0.02            0.02           
EGYPT          0.03            0.03           
ETHIOPIA       0.02            0.02           
FRANCE         0.01            0.01           
GERMANY        0.01            0.01           
INDIA          0.01            0.01           
INDONESIA      0.03            0.03           
IRAN           0.01            0.01           
IRAQ           0.04            0.04           
JAPAN          0.01            0.01           
JORDAN         0.00            0.00           
KENYA          0.00            0.00           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.03            0.03           
PERU           0.04            0.04           
ROMANIA        0.04            0.04           
RUSSIA         0.03            0.03           
SAUDI ARABIA   0.03            0.03           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:29:26,354 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.03            0.03           
ARGENTINA      0.04            0.04           
BRAZIL         0.02            0.02           
CANADA         0.02            0.02           
CHINA          0.02            0.02           
EGYPT          0.03            0.03           
ETHIOPIA       0.02            0.02           
FRANCE         0.01            0.01           
GERMANY        0.01            0.01           
INDIA          0.01            0.01           
INDONESIA      0.03            0.03           
IRAN           0.01            0.01           
IRAQ           0.04            0.04           
JAPAN          0.01            0.01           
JORDAN         0.00            0.00           
KENYA          0.00            0.00           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.03            0.03           
PERU           0.04            0.04           
ROMANIA        0.04            0.04           
RUSSIA         0.03            0.03           
SAUDI ARABIA   0.03            0.03           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:29:26,354 - main.py[line:554] - INFO: relative error average: 0.01962271845478146
2022-07-09 15:29:26,354 - main.py[line:555] - INFO: relative error normalized average: 0.01935973562651775
2022-07-09 15:29:26,355 - main.py[line:601] - INFO: total_time:2.9506372027099133
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
