main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:14:49,721 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:14:49,721 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:14:49,722 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:14:49,722 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:14:49,891 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16913720965385437
2022-07-09 15:14:49,891 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:14:49,892 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:14:51,934 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.041713874787092
2022-07-09 15:14:51,934 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.212357185781002
2022-07-09 15:14:51,934 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:51,935 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013521797955036163
2022-07-09 15:14:51,935 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:14:51,936 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:14:51,937 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014142058789730072
2022-07-09 15:14:51,938 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035275444388389587
2022-07-09 15:14:51,938 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:14:51,938 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.003
2022-07-09 15:14:51,938 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:14:51,940 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.003
2022-07-09 15:14:51,942 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:14:51,943 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.003
2022-07-09 15:14:52,507 - pytorch_cvae.py[line:399] - INFO: sampling time:0.568534679710865
2022-07-09 15:14:52,555 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:52,558 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.00206790491938591
2022-07-09 15:14:52,586 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.6481491960585117
2022-07-09 15:14:52,639 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6981070302426815
2022-07-09 15:14:52,747 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:52,751 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0035611093044281006
2022-07-09 15:14:52,755 - pytorch_cvae.py[line:399] - INFO: sampling time:0.8113393038511276
2022-07-09 15:14:52,827 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.8875897228717804
2022-07-09 15:14:52,847 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:52,850 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0026142150163650513
2022-07-09 15:14:52,862 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.9193366952240467
2022-07-09 15:14:52,867 - main.py[line:542] - INFO: sample time: 0.9291232712566853
2022-07-09 15:14:52,876 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4635.22         970943292.21   
ARGENTINA      4458.70         936528410.58   
BRAZIL         4545.97         955025957.73   
CANADA         4628.03         973084061.47   
CHINA          4603.56         966517386.50   
EGYPT          4418.53         930316643.98   
ETHIOPIA       4450.53         937713562.83   
FRANCE         4518.11         949516437.45   
GERMANY        4543.77         955092284.64   
INDIA          4527.19         951497141.05   
INDONESIA      4454.73         936209908.80   
IRAN           4397.46         924934698.27   
IRAQ           4589.97         963145612.50   
JAPAN          4457.85         932573957.66   
JORDAN         4368.10         914768430.65   
KENYA          4493.85         940118504.01   
MOROCCO        4499.74         946215042.02   
MOZAMBIQUE     4534.32         951050276.09   
PERU           4505.97         947446824.60   
ROMANIA        4628.28         972721875.06   
RUSSIA         4397.79         923578939.06   
SAUDI ARABIA   4563.40         957802573.63   
UNITED KINGDOM 4556.18         959454660.15   
UNITED STATES  4482.75         939548604.74   
VIETNAM        4494.63         942667891.11   
2022-07-09 15:14:52,879 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:14:52,885 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.03            0.03           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.03            0.03           
CHINA          0.02            0.02           
EGYPT          0.02            0.02           
ETHIOPIA       0.01            0.01           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.02            0.02           
IRAQ           0.02            0.02           
JAPAN          0.01            0.01           
JORDAN         0.03            0.03           
KENYA          0.00            0.00           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.01            0.01           
PERU           0.00            0.00           
ROMANIA        0.03            0.03           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.00            0.00           
VIETNAM        0.00            0.00           
2022-07-09 15:14:52,887 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.03            0.03           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.03            0.03           
CHINA          0.02            0.02           
EGYPT          0.02            0.02           
ETHIOPIA       0.01            0.01           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.02            0.02           
IRAQ           0.02            0.02           
JAPAN          0.01            0.01           
JORDAN         0.03            0.03           
KENYA          0.00            0.00           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.01            0.01           
PERU           0.00            0.00           
ROMANIA        0.03            0.03           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.00            0.00           
VIETNAM        0.00            0.00           
2022-07-09 15:14:52,887 - main.py[line:554] - INFO: relative error average: 0.013070084485766282
2022-07-09 15:14:52,887 - main.py[line:555] - INFO: relative error normalized average: 0.012933920365641895
2022-07-09 15:14:52,888 - main.py[line:601] - INFO: total_time:3.1667538918554783
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:28:44,673 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:28:44,673 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:28:44,673 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:28:44,673 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:28:44,845 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.1714971661567688
2022-07-09 15:28:44,845 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:28:44,846 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:28:46,916 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.070023138076067
2022-07-09 15:28:46,916 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2430437728762627
2022-07-09 15:28:46,916 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:46,918 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013822317123413086
2022-07-09 15:28:46,918 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:28:46,918 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:28:46,920 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014117918908596039
2022-07-09 15:28:46,920 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035651475191116333
2022-07-09 15:28:46,920 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:28:46,920 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.003
2022-07-09 15:28:47,462 - pytorch_cvae.py[line:399] - INFO: sampling time:0.54154933989048
2022-07-09 15:28:47,503 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:47,504 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0018065758049488068
2022-07-09 15:28:47,528 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.6077683493494987
2022-07-09 15:28:47,531 - main.py[line:542] - INFO: sample time: 0.611259788274765
2022-07-09 15:28:47,541 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4586.56         960751423.12   
ARGENTINA      4368.51         917584307.89   
BRAZIL         4462.35         937459283.55   
CANADA         4594.64         966064725.77   
CHINA          4498.64         944488952.26   
EGYPT          4535.70         954986248.15   
ETHIOPIA       4461.35         939993384.61   
FRANCE         4355.12         915263654.13   
GERMANY        4392.48         923290889.57   
INDIA          4432.58         931612726.15   
INDONESIA      4600.27         966797008.30   
IRAN           4426.88         931124328.77   
IRAQ           4499.49         944160362.84   
JAPAN          4485.14         938283337.47   
JORDAN         4450.36         931993594.26   
KENYA          4354.59         910984101.74   
MOROCCO        4522.77         951057042.10   
MOZAMBIQUE     4561.89         956833194.83   
PERU           4216.00         886476330.11   
ROMANIA        4369.78         918391559.66   
RUSSIA         4479.96         940837326.30   
SAUDI ARABIA   4423.47         928433666.49   
UNITED KINGDOM 4421.23         931035933.11   
UNITED STATES  4512.51         945785452.69   
VIETNAM        4431.72         929473005.65   
2022-07-09 15:28:47,544 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:28:47,550 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.03            0.03           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.00            0.00           
EGYPT          0.01            0.01           
ETHIOPIA       0.01            0.01           
FRANCE         0.03            0.03           
GERMANY        0.02            0.02           
INDIA          0.02            0.02           
INDONESIA      0.02            0.02           
IRAN           0.02            0.02           
IRAQ           0.00            0.00           
JAPAN          0.00            0.00           
JORDAN         0.01            0.01           
KENYA          0.03            0.03           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.01            0.01           
PERU           0.06            0.06           
ROMANIA        0.03            0.03           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.00            0.00           
VIETNAM        0.01            0.01           
2022-07-09 15:28:47,552 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.03            0.03           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.00            0.00           
EGYPT          0.01            0.01           
ETHIOPIA       0.01            0.01           
FRANCE         0.03            0.03           
GERMANY        0.02            0.02           
INDIA          0.02            0.02           
INDONESIA      0.02            0.02           
IRAN           0.02            0.02           
IRAQ           0.00            0.00           
JAPAN          0.00            0.00           
JORDAN         0.01            0.01           
KENYA          0.03            0.03           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.01            0.01           
PERU           0.06            0.06           
ROMANIA        0.03            0.03           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.00            0.00           
VIETNAM        0.01            0.01           
2022-07-09 15:28:47,552 - main.py[line:554] - INFO: relative error average: 0.016869424332526573
2022-07-09 15:28:47,552 - main.py[line:555] - INFO: relative error normalized average: 0.016644301942036005
2022-07-09 15:28:47,553 - main.py[line:601] - INFO: total_time:2.880312219262123
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
