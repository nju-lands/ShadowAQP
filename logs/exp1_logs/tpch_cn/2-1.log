main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:14:38,000 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:14:38,000 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:14:38,000 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:14:38,000 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:14:38,172 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.1711709313094616
2022-07-09 15:14:38,172 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:14:38,173 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:14:40,216 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0430356822907925
2022-07-09 15:14:40,216 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2157166078686714
2022-07-09 15:14:40,216 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:40,218 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013576485216617584
2022-07-09 15:14:40,218 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:14:40,218 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:14:40,220 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013933628797531128
2022-07-09 15:14:40,220 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035181529819965363
2022-07-09 15:14:40,220 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:14:40,220 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.002
2022-07-09 15:14:40,220 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:14:40,222 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.002
2022-07-09 15:14:40,222 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:14:40,223 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.002
2022-07-09 15:14:40,782 - pytorch_cvae.py[line:399] - INFO: sampling time:0.56212392821908
2022-07-09 15:14:40,836 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:40,838 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0019354932010173798
2022-07-09 15:14:40,938 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7181479893624783
2022-07-09 15:14:40,977 - pytorch_cvae.py[line:399] - INFO: sampling time:0.7544624023139477
2022-07-09 15:14:40,981 - pytorch_cvae.py[line:399] - INFO: sampling time:0.7567100003361702
2022-07-09 15:14:41,119 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:41,131 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.012543920427560806
2022-07-09 15:14:41,137 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:41,144 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.00650583952665329
2022-07-09 15:14:41,178 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.9569788761436939
2022-07-09 15:14:41,201 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.9774845652282238
2022-07-09 15:14:41,206 - main.py[line:542] - INFO: sample time: 0.9857346266508102
2022-07-09 15:14:41,216 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4588.81         961223633.61   
ARGENTINA      4688.10         984712779.34   
BRAZIL         4504.38         946289389.10   
CANADA         4542.61         955124378.88   
CHINA          4467.20         937888642.09   
EGYPT          4536.48         955150351.32   
ETHIOPIA       4466.81         941142864.72   
FRANCE         4540.49         954220111.88   
GERMANY        4514.60         948959865.27   
INDIA          4613.27         969590196.33   
INDONESIA      4662.90         979960320.65   
IRAN           4605.66         968726114.09   
IRAQ           4538.23         952289600.37   
JAPAN          4388.97         918163796.21   
JORDAN         4572.90         957656044.02   
KENYA          4514.90         944520705.86   
MOROCCO        4527.56         952064752.50   
MOZAMBIQUE     4731.22         992350045.58   
PERU           4547.11         956097378.40   
ROMANIA        4600.56         966895767.83   
RUSSIA         4570.09         959765382.73   
SAUDI ARABIA   4403.04         924145441.19   
UNITED KINGDOM 4598.53         968372452.19   
UNITED STATES  4494.41         941992251.51   
VIETNAM        4432.45         929626149.76   
2022-07-09 15:14:41,219 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:14:41,225 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.05            0.05           
BRAZIL         0.00            0.00           
CANADA         0.01            0.01           
CHINA          0.01            0.01           
EGYPT          0.01            0.01           
ETHIOPIA       0.01            0.01           
FRANCE         0.01            0.01           
GERMANY        0.00            0.00           
INDIA          0.02            0.02           
INDONESIA      0.04            0.04           
IRAN           0.02            0.02           
IRAQ           0.01            0.01           
JAPAN          0.02            0.02           
JORDAN         0.02            0.02           
KENYA          0.00            0.00           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.05            0.05           
PERU           0.01            0.01           
ROMANIA        0.02            0.02           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.00            0.00           
VIETNAM        0.01            0.01           
2022-07-09 15:14:41,228 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.02            0.02           
ARGENTINA      0.04            0.04           
BRAZIL         0.00            0.00           
CANADA         0.01            0.01           
CHINA          0.01            0.01           
EGYPT          0.01            0.01           
ETHIOPIA       0.01            0.01           
FRANCE         0.01            0.01           
GERMANY        0.00            0.00           
INDIA          0.02            0.02           
INDONESIA      0.04            0.04           
IRAN           0.02            0.02           
IRAQ           0.01            0.01           
JAPAN          0.02            0.02           
JORDAN         0.02            0.02           
KENYA          0.00            0.00           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.05            0.05           
PERU           0.01            0.01           
ROMANIA        0.02            0.02           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.00            0.00           
VIETNAM        0.01            0.01           
2022-07-09 15:14:41,228 - main.py[line:554] - INFO: relative error average: 0.01666578414333147
2022-07-09 15:14:41,228 - main.py[line:555] - INFO: relative error normalized average: 0.016447667767805544
2022-07-09 15:14:41,229 - main.py[line:601] - INFO: total_time:3.2291776910424232
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:28:33,699 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:28:33,699 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:28:33,699 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:28:33,699 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:28:33,866 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16701235622167587
2022-07-09 15:28:33,866 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:28:33,868 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:28:35,946 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0780408643186092
2022-07-09 15:28:35,946 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2467833161354065
2022-07-09 15:28:35,946 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:35,947 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.001355443149805069
2022-07-09 15:28:35,947 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:28:35,948 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:28:35,949 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013601183891296387
2022-07-09 15:28:35,949 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0034707672894001007
2022-07-09 15:28:35,949 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:28:35,950 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.002
2022-07-09 15:28:36,470 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5199258476495743
2022-07-09 15:28:36,498 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:36,500 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0017581842839717865
2022-07-09 15:28:36,517 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.5676994323730469
2022-07-09 15:28:36,521 - main.py[line:542] - INFO: sample time: 0.5711653456091881
2022-07-09 15:28:36,530 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4715.74         987811432.85   
ARGENTINA      4367.49         917369468.26   
BRAZIL         4425.66         929751584.56   
CANADA         4447.23         935070652.47   
CHINA          4676.16         981759784.59   
EGYPT          4253.79         895630216.41   
ETHIOPIA       4258.08         897164841.19   
FRANCE         4310.08         905797110.87   
GERMANY        4329.84         910124372.27   
INDIA          4480.79         941745030.35   
INDONESIA      4461.29         937588333.03   
IRAN           4639.26         975795039.90   
IRAQ           4811.90         1009714337.58  
JAPAN          4456.02         932190053.24   
JORDAN         4724.40         989383023.36   
KENYA          4494.25         940201426.42   
MOROCCO        4506.59         947654953.47   
MOZAMBIQUE     4499.72         943793741.39   
PERU           4313.46         906970685.69   
ROMANIA        4461.72         937714874.84   
RUSSIA         4180.24         877893161.87   
SAUDI ARABIA   4399.07         923310968.81   
UNITED KINGDOM 4547.49         957623736.33   
UNITED STATES  4524.37         948272126.37   
VIETNAM        4330.47         908237983.92   
2022-07-09 15:28:36,533 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:28:36,540 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.05            0.05           
ARGENTINA      0.03            0.03           
BRAZIL         0.02            0.02           
CANADA         0.01            0.01           
CHINA          0.04            0.04           
EGYPT          0.05            0.05           
ETHIOPIA       0.05            0.05           
FRANCE         0.04            0.04           
GERMANY        0.04            0.04           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.03            0.03           
IRAQ           0.07            0.07           
JAPAN          0.01            0.01           
JORDAN         0.05            0.05           
KENYA          0.00            0.00           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.00            0.00           
PERU           0.04            0.04           
ROMANIA        0.01            0.01           
RUSSIA         0.07            0.07           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.01            0.01           
VIETNAM        0.04            0.04           
2022-07-09 15:28:36,542 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.05            0.05           
ARGENTINA      0.03            0.03           
BRAZIL         0.02            0.02           
CANADA         0.01            0.01           
CHINA          0.04            0.04           
EGYPT          0.05            0.05           
ETHIOPIA       0.05            0.05           
FRANCE         0.04            0.04           
GERMANY        0.04            0.04           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.03            0.03           
IRAQ           0.07            0.07           
JAPAN          0.01            0.01           
JORDAN         0.05            0.05           
KENYA          0.00            0.00           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.00            0.00           
PERU           0.04            0.04           
ROMANIA        0.01            0.01           
RUSSIA         0.07            0.07           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.01            0.01           
VIETNAM        0.04            0.04           
2022-07-09 15:28:36,542 - main.py[line:554] - INFO: relative error average: 0.027929935208323056
2022-07-09 15:28:36,542 - main.py[line:555] - INFO: relative error normalized average: 0.02731866419512464
2022-07-09 15:28:36,543 - main.py[line:601] - INFO: total_time:2.8442237190902233
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
