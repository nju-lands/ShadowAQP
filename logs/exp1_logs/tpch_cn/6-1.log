main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:15:25,452 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:15:25,452 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:15:25,452 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:15:25,452 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:15:25,622 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16979677602648735
2022-07-09 15:15:25,622 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:15:25,623 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:15:27,651 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0278072841465473
2022-07-09 15:15:27,651 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.199116103351116
2022-07-09 15:15:27,651 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:27,653 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013536140322685242
2022-07-09 15:15:27,653 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:15:27,653 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:15:27,655 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014002136886119843
2022-07-09 15:15:27,655 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035124942660331726
2022-07-09 15:15:27,655 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:15:27,655 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.006
2022-07-09 15:15:27,655 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:15:27,657 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.006
2022-07-09 15:15:27,657 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:15:27,658 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.006
2022-07-09 15:15:28,269 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6138164885342121
2022-07-09 15:15:28,362 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:28,364 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0020788460969924927
2022-07-09 15:15:28,459 - pytorch_cvae.py[line:399] - INFO: sampling time:0.8011947795748711
2022-07-09 15:15:28,551 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.8962563201785088
2022-07-09 15:15:28,706 - pytorch_cvae.py[line:399] - INFO: sampling time:1.046543586999178
2022-07-09 15:15:28,802 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:28,812 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.010618440806865692
2022-07-09 15:15:28,873 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.2169032543897629
2022-07-09 15:15:28,907 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:28,909 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0020618587732315063
2022-07-09 15:15:28,924 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.2657455429434776
2022-07-09 15:15:28,929 - main.py[line:542] - INFO: sample time: 1.2738259583711624
2022-07-09 15:15:28,938 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4481.42         938727020.97   
ARGENTINA      4469.05         938701645.37   
BRAZIL         4486.98         942633608.96   
CANADA         4513.16         948932468.21   
CHINA          4561.24         957632816.31   
EGYPT          4484.46         944198408.80   
ETHIOPIA       4496.01         947294916.58   
FRANCE         4424.52         929847602.46   
GERMANY        4503.99         946729771.09   
INDIA          4455.81         936495275.59   
INDONESIA      4584.11         963400694.74   
IRAN           4580.81         963501043.74   
IRAQ           4564.92         957889951.58   
JAPAN          4523.92         946395474.02   
JORDAN         4421.96         926046781.30   
KENYA          4367.10         913601452.61   
MOROCCO        4570.02         960992622.33   
MOZAMBIQUE     4612.99         967551874.87   
PERU           4558.82         958559921.86   
ROMANIA        4549.44         956151727.64   
RUSSIA         4460.52         936753654.97   
SAUDI ARABIA   4515.98         947849559.05   
UNITED KINGDOM 4403.40         927281055.41   
UNITED STATES  4471.41         937170828.73   
VIETNAM        4462.50         935928028.62   
2022-07-09 15:15:28,940 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:15:28,946 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.00            0.00           
BRAZIL         0.01            0.01           
CANADA         0.01            0.01           
CHINA          0.01            0.01           
EGYPT          0.00            0.00           
ETHIOPIA       0.00            0.00           
FRANCE         0.02            0.02           
GERMANY        0.00            0.00           
INDIA          0.01            0.01           
INDONESIA      0.02            0.02           
IRAN           0.02            0.02           
IRAQ           0.01            0.01           
JAPAN          0.01            0.01           
JORDAN         0.02            0.02           
KENYA          0.03            0.03           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.03            0.03           
PERU           0.01            0.01           
ROMANIA        0.01            0.01           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.00            0.00           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:15:28,948 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.00            0.00           
BRAZIL         0.01            0.01           
CANADA         0.01            0.01           
CHINA          0.01            0.01           
EGYPT          0.00            0.00           
ETHIOPIA       0.00            0.00           
FRANCE         0.02            0.02           
GERMANY        0.00            0.00           
INDIA          0.01            0.01           
INDONESIA      0.02            0.02           
IRAN           0.02            0.02           
IRAQ           0.01            0.01           
JAPAN          0.01            0.01           
JORDAN         0.02            0.02           
KENYA          0.03            0.03           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.03            0.03           
PERU           0.01            0.01           
ROMANIA        0.01            0.01           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.00            0.00           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:15:28,948 - main.py[line:554] - INFO: relative error average: 0.011171809450553622
2022-07-09 15:15:28,948 - main.py[line:555] - INFO: relative error normalized average: 0.011083098744650364
2022-07-09 15:15:28,949 - main.py[line:601] - INFO: total_time:3.497421905398369
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:29:17,814 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:29:17,814 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:29:17,814 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:29:17,814 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:29:17,985 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17117515206336975
2022-07-09 15:29:17,985 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:29:17,987 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:29:20,042 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0556111484766006
2022-07-09 15:29:20,042 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2283063903450966
2022-07-09 15:29:20,042 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:20,044 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013717524707317352
2022-07-09 15:29:20,044 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:29:20,044 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:29:20,046 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014017410576343536
2022-07-09 15:29:20,046 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003522716462612152
2022-07-09 15:29:20,046 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:29:20,046 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.006
2022-07-09 15:29:20,618 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5712861008942127
2022-07-09 15:29:20,698 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:20,700 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0019114799797534943
2022-07-09 15:29:20,730 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.6841969043016434
2022-07-09 15:29:20,734 - main.py[line:542] - INFO: sample time: 0.687612384557724
2022-07-09 15:29:20,743 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4532.78         949486613.48   
ARGENTINA      4635.04         973565928.22   
BRAZIL         4494.81         944279698.68   
CANADA         4514.40         949193816.10   
CHINA          4496.08         943951586.80   
EGYPT          4418.86         930386300.67   
ETHIOPIA       4530.11         954480815.74   
FRANCE         4487.47         943078531.01   
GERMANY        4442.34         933771440.71   
INDIA          4553.22         956967763.46   
INDONESIA      4399.62         924628966.18   
IRAN           4556.30         958345800.43   
IRAQ           4410.52         925490930.03   
JAPAN          4441.45         929143063.00   
JORDAN         4450.44         932011573.53   
KENYA          4252.33         889591060.91   
MOROCCO        4366.73         918245707.98   
MOZAMBIQUE     4720.16         990030273.24   
PERU           4360.29         916817227.88   
ROMANIA        4467.21         938869513.12   
RUSSIA         4504.34         945957050.21   
SAUDI ARABIA   4341.16         911156969.93   
UNITED KINGDOM 4384.67         923337477.73   
UNITED STATES  4431.65         928839345.18   
VIETNAM        4441.47         931518550.70   
2022-07-09 15:29:20,746 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:29:20,752 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.03            0.03           
BRAZIL         0.00            0.00           
CANADA         0.01            0.01           
CHINA          0.00            0.00           
EGYPT          0.02            0.02           
ETHIOPIA       0.01            0.01           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.01            0.01           
INDONESIA      0.02            0.02           
IRAN           0.01            0.01           
IRAQ           0.02            0.02           
JAPAN          0.01            0.01           
JORDAN         0.01            0.01           
KENYA          0.05            0.05           
MOROCCO        0.03            0.03           
MOZAMBIQUE     0.05            0.05           
PERU           0.03            0.03           
ROMANIA        0.01            0.01           
RUSSIA         0.00            0.00           
SAUDI ARABIA   0.04            0.04           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:29:20,754 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.03            0.03           
BRAZIL         0.00            0.00           
CANADA         0.01            0.01           
CHINA          0.00            0.00           
EGYPT          0.02            0.02           
ETHIOPIA       0.01            0.01           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.01            0.01           
INDONESIA      0.02            0.02           
IRAN           0.01            0.01           
IRAQ           0.02            0.02           
JAPAN          0.01            0.01           
JORDAN         0.01            0.01           
KENYA          0.05            0.05           
MOROCCO        0.03            0.03           
MOZAMBIQUE     0.05            0.05           
PERU           0.03            0.03           
ROMANIA        0.01            0.01           
RUSSIA         0.00            0.00           
SAUDI ARABIA   0.04            0.04           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:29:20,754 - main.py[line:554] - INFO: relative error average: 0.017342404188199764
2022-07-09 15:29:20,754 - main.py[line:555] - INFO: relative error normalized average: 0.017094793224498635
2022-07-09 15:29:20,755 - main.py[line:601] - INFO: total_time:2.9409457109868526
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
