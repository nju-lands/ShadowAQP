main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:15:37,777 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:15:37,777 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:15:37,777 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:15:37,777 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:15:37,945 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.1683252640068531
2022-07-09 15:15:37,945 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:15:37,947 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:15:39,989 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.042592741549015
2022-07-09 15:15:39,989 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.212416432797909
2022-07-09 15:15:39,989 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:39,991 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.001342765986919403
2022-07-09 15:15:39,991 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:15:39,991 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:15:39,993 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013829804956912994
2022-07-09 15:15:39,993 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0034902170300483704
2022-07-09 15:15:39,993 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:15:39,993 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.007
2022-07-09 15:15:39,993 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:15:39,995 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.007
2022-07-09 15:15:39,995 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:15:39,996 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.007
2022-07-09 15:15:40,645 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6485041826963425
2022-07-09 15:15:40,903 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:40,908 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.005092225968837738
2022-07-09 15:15:41,005 - pytorch_cvae.py[line:399] - INFO: sampling time:1.0093832947313786
2022-07-09 15:15:41,020 - pytorch_cvae.py[line:399] - INFO: sampling time:1.0261353589594364
2022-07-09 15:15:41,214 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.2176477015018463
2022-07-09 15:15:41,497 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:41,513 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:15:41,514 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.016297832131385803
2022-07-09 15:15:41,521 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0077686309814453125
2022-07-09 15:15:41,577 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.582371313124895
2022-07-09 15:15:41,596 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.6027519330382347
2022-07-09 15:15:41,601 - main.py[line:542] - INFO: sample time: 1.6079817079007626
2022-07-09 15:15:41,611 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4512.36         945207734.79   
ARGENTINA      4567.83         959449301.94   
BRAZIL         4505.34         946490805.32   
CANADA         4429.67         931378254.02   
CHINA          4529.90         951051746.50   
EGYPT          4414.22         929409277.64   
ETHIOPIA       4402.07         927503426.32   
FRANCE         4475.17         940491925.71   
GERMANY        4560.16         958536226.34   
INDIA          4512.19         948344202.94   
INDONESIA      4450.56         935335049.51   
IRAN           4466.51         939458073.09   
IRAQ           4405.81         924501438.38   
JAPAN          4410.29         922623237.37   
JORDAN         4426.56         927010949.01   
KENYA          4424.33         925573926.54   
MOROCCO        4469.27         939806580.39   
MOZAMBIQUE     4600.52         964935657.64   
PERU           4603.26         967905497.32   
ROMANIA        4562.39         958873223.10   
RUSSIA         4518.36         948901643.14   
SAUDI ARABIA   4530.56         950910605.79   
UNITED KINGDOM 4438.74         934722189.65   
UNITED STATES  4478.24         938603786.13   
VIETNAM        4591.93         963075005.56   
2022-07-09 15:15:41,614 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:15:41,621 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.02            0.02           
BRAZIL         0.00            0.00           
CANADA         0.01            0.01           
CHINA          0.01            0.01           
EGYPT          0.02            0.02           
ETHIOPIA       0.02            0.02           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.02            0.02           
JAPAN          0.02            0.02           
JORDAN         0.02            0.02           
KENYA          0.02            0.02           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.02            0.02           
PERU           0.02            0.02           
ROMANIA        0.02            0.02           
RUSSIA         0.00            0.00           
SAUDI ARABIA   0.00            0.00           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.00            0.00           
VIETNAM        0.02            0.02           
2022-07-09 15:15:41,623 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.02            0.02           
BRAZIL         0.00            0.00           
CANADA         0.01            0.01           
CHINA          0.01            0.01           
EGYPT          0.02            0.02           
ETHIOPIA       0.02            0.02           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.02            0.02           
JAPAN          0.02            0.02           
JORDAN         0.02            0.02           
KENYA          0.02            0.02           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.02            0.02           
PERU           0.02            0.02           
ROMANIA        0.02            0.02           
RUSSIA         0.00            0.00           
SAUDI ARABIA   0.00            0.00           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.00            0.00           
VIETNAM        0.02            0.02           
2022-07-09 15:15:41,623 - main.py[line:554] - INFO: relative error average: 0.012102015373868244
2022-07-09 15:15:41,623 - main.py[line:555] - INFO: relative error normalized average: 0.012002891678393192
2022-07-09 15:15:41,624 - main.py[line:601] - INFO: total_time:3.8477487340569496
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:29:29,003 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:29:29,003 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:29:29,003 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:29:29,003 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:29:29,170 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16635004431009293
2022-07-09 15:29:29,170 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:29:29,171 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:29:31,240 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.068413630127907
2022-07-09 15:29:31,240 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.23630278557539
2022-07-09 15:29:31,240 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:31,241 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.001366686075925827
2022-07-09 15:29:31,241 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:29:31,242 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:29:31,243 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014192648231983185
2022-07-09 15:29:31,243 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003553587943315506
2022-07-09 15:29:31,243 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:29:31,244 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.007
2022-07-09 15:29:31,830 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5860415175557137
2022-07-09 15:29:31,924 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:31,926 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.001961108297109604
2022-07-09 15:29:31,949 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7048355154693127
2022-07-09 15:29:31,952 - main.py[line:542] - INFO: sample time: 0.7082478739321232
2022-07-09 15:29:31,961 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4466.23         935545934.72   
ARGENTINA      4467.53         938381600.67   
BRAZIL         4485.55         942333939.21   
CANADA         4491.99         944481430.15   
CHINA          4584.06         962423688.83   
EGYPT          4298.94         905136913.15   
ETHIOPIA       4517.95         951918467.15   
FRANCE         4566.66         959720263.70   
GERMANY        4394.11         923633820.47   
INDIA          4580.75         962754452.49   
INDONESIA      4574.35         961350668.26   
IRAN           4521.39         951001246.63   
IRAQ           4558.74         956591400.56   
JAPAN          4473.01         935744031.01   
JORDAN         4547.78         952395129.64   
KENYA          4322.02         904170902.35   
MOROCCO        4385.08         922103636.33   
MOZAMBIQUE     4585.83         961854974.42   
PERU           4523.90         951217558.96   
ROMANIA        4563.14         959030285.25   
RUSSIA         4544.56         954402253.92   
SAUDI ARABIA   4462.08         936536432.10   
UNITED KINGDOM 4565.44         961404825.47   
UNITED STATES  4620.81         968484277.07   
VIETNAM        4432.97         929735815.44   
2022-07-09 15:29:31,964 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:29:31,971 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.00            0.00           
BRAZIL         0.01            0.01           
CANADA         0.00            0.00           
CHINA          0.02            0.02           
EGYPT          0.04            0.04           
ETHIOPIA       0.01            0.01           
FRANCE         0.02            0.02           
GERMANY        0.02            0.02           
INDIA          0.02            0.02           
INDONESIA      0.02            0.02           
IRAN           0.00            0.00           
IRAQ           0.01            0.01           
JAPAN          0.00            0.00           
JORDAN         0.01            0.01           
KENYA          0.04            0.04           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.02            0.02           
PERU           0.01            0.01           
ROMANIA        0.02            0.02           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.03            0.03           
VIETNAM        0.01            0.01           
2022-07-09 15:29:31,972 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.00            0.00           
BRAZIL         0.01            0.01           
CANADA         0.00            0.00           
CHINA          0.02            0.02           
EGYPT          0.04            0.04           
ETHIOPIA       0.01            0.01           
FRANCE         0.02            0.02           
GERMANY        0.02            0.02           
INDIA          0.02            0.02           
INDONESIA      0.02            0.02           
IRAN           0.00            0.00           
IRAQ           0.01            0.01           
JAPAN          0.00            0.00           
JORDAN         0.01            0.01           
KENYA          0.04            0.04           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.02            0.02           
PERU           0.01            0.01           
ROMANIA        0.02            0.02           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.03            0.03           
VIETNAM        0.01            0.01           
2022-07-09 15:29:31,973 - main.py[line:554] - INFO: relative error average: 0.01459035141754998
2022-07-09 15:29:31,973 - main.py[line:555] - INFO: relative error normalized average: 0.014429341440924599
2022-07-09 15:29:31,974 - main.py[line:601] - INFO: total_time:2.97067316994071
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
