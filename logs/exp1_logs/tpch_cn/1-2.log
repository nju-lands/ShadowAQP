main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:14:32,254 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:14:32,254 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:14:32,254 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:14:32,254 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:14:32,427 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17310575023293495
2022-07-09 15:14:32,427 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:14:32,429 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:14:34,486 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0572648756206036
2022-07-09 15:14:34,486 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2318690605461597
2022-07-09 15:14:34,486 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:34,487 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.001353427767753601
2022-07-09 15:14:34,487 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:14:34,488 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:14:34,489 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013937130570411682
2022-07-09 15:14:34,490 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003502301871776581
2022-07-09 15:14:34,490 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:14:34,490 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.001
2022-07-09 15:14:34,490 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:14:34,492 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.001
2022-07-09 15:14:34,493 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:14:34,493 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.001
2022-07-09 15:14:35,026 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5330984033644199
2022-07-09 15:14:35,045 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:35,047 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0020689330995082855
2022-07-09 15:14:35,064 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.5731096491217613
2022-07-09 15:14:35,147 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6570458747446537
2022-07-09 15:14:35,165 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6713489033281803
2022-07-09 15:14:35,214 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:35,228 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:14:35,228 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.014985769987106323
2022-07-09 15:14:35,235 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.007040031254291534
2022-07-09 15:14:35,272 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7786556258797646
2022-07-09 15:14:35,289 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7992200702428818
2022-07-09 15:14:35,294 - main.py[line:542] - INFO: sample time: 0.8043307140469551
2022-07-09 15:14:35,304 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4363.95         914120181.93   
ARGENTINA      4511.73         947666276.83   
BRAZIL         4591.71         964635100.62   
CANADA         4561.43         959082236.59   
CHINA          4590.52         963779847.53   
EGYPT          4463.64         939815715.03   
ETHIOPIA       4471.69         942172531.37   
FRANCE         4510.19         947852803.81   
GERMANY        4470.93         939781222.48   
INDIA          4516.18         949183064.33   
INDONESIA      4518.65         949643178.65   
IRAN           4532.01         953236475.93   
IRAQ           4741.07         994852497.83   
JAPAN          4399.17         920296867.27   
JORDAN         4644.28         972605393.05   
KENYA          4674.25         977858760.99   
MOROCCO        4428.05         931140053.12   
MOZAMBIQUE     4499.03         943649538.97   
PERU           4570.97         961114508.33   
ROMANIA        4406.35         926077358.84   
RUSSIA         4621.09         970475226.51   
SAUDI ARABIA   4524.76         949693222.75   
UNITED KINGDOM 4525.91         953078826.24   
UNITED STATES  4461.25         935041913.92   
VIETNAM        4530.36         950160447.71   
2022-07-09 15:14:35,306 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:14:35,313 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.03            0.03           
ARGENTINA      0.01            0.01           
BRAZIL         0.02            0.02           
CANADA         0.02            0.02           
CHINA          0.02            0.02           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.05            0.05           
JAPAN          0.02            0.02           
JORDAN         0.03            0.03           
KENYA          0.04            0.04           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.00            0.00           
PERU           0.02            0.02           
ROMANIA        0.02            0.02           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.00            0.00           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:14:35,314 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.03            0.03           
ARGENTINA      0.01            0.01           
BRAZIL         0.02            0.02           
CANADA         0.02            0.02           
CHINA          0.02            0.02           
EGYPT          0.01            0.01           
ETHIOPIA       0.00            0.00           
FRANCE         0.00            0.00           
GERMANY        0.01            0.01           
INDIA          0.00            0.00           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.05            0.05           
JAPAN          0.02            0.02           
JORDAN         0.03            0.03           
KENYA          0.04            0.04           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.00            0.00           
PERU           0.02            0.02           
ROMANIA        0.02            0.02           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.00            0.00           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.01            0.01           
VIETNAM        0.01            0.01           
2022-07-09 15:14:35,314 - main.py[line:554] - INFO: relative error average: 0.014783785512891905
2022-07-09 15:14:35,315 - main.py[line:555] - INFO: relative error normalized average: 0.014595552432661245
2022-07-09 15:14:35,316 - main.py[line:601] - INFO: total_time:3.0620225071907043
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:28:28,241 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:28:28,241 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:28:28,241 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:28:28,241 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:28:28,412 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17099092155694962
2022-07-09 15:28:28,412 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:28:28,413 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:28:30,487 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.073612552136183
2022-07-09 15:28:30,487 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2461141236126423
2022-07-09 15:28:30,487 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:30,491 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0044403523206710815
2022-07-09 15:28:30,492 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:28:30,494 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:28:30,498 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.004083860665559769
2022-07-09 15:28:30,498 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.010992947965860367
2022-07-09 15:28:30,498 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:28:30,499 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.001
2022-07-09 15:28:31,003 - pytorch_cvae.py[line:399] - INFO: sampling time:0.5039497055113316
2022-07-09 15:28:31,017 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:28:31,019 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.001705121248960495
2022-07-09 15:28:31,032 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.5335936024785042
2022-07-09 15:28:31,035 - main.py[line:542] - INFO: sample time: 0.5369784720242023
2022-07-09 15:28:31,044 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4623.67         968524322.47   
ARGENTINA      4676.22         982217544.00   
BRAZIL         4395.72         923462455.49   
CANADA         4437.50         933024069.48   
CHINA          4605.11         966843119.74   
EGYPT          4432.51         933260214.04   
ETHIOPIA       4403.93         927895485.46   
FRANCE         4520.49         950016142.16   
GERMANY        4315.74         907160525.39   
INDIA          4470.33         939547203.59   
INDONESIA      4600.67         966881155.19   
IRAN           5023.21         1056551782.40  
IRAQ           4536.07         951836103.02   
JAPAN          4098.33         857363007.45   
JORDAN         4599.38         963201766.02   
KENYA          4281.51         895696749.70   
MOROCCO        4293.22         902786487.69   
MOZAMBIQUE     4606.85         966263107.75   
PERU           4853.92         1020609337.54  
ROMANIA        4621.97         971393958.98   
RUSSIA         4363.78         916438135.27   
SAUDI ARABIA   4628.13         971389297.78   
UNITED KINGDOM 4499.01         947415135.85   
UNITED STATES  4400.78         922369056.66   
VIETNAM        4678.14         981155593.81   
2022-07-09 15:28:31,047 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:28:31,054 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.03            0.03           
ARGENTINA      0.04            0.04           
BRAZIL         0.03            0.03           
CANADA         0.01            0.01           
CHINA          0.02            0.02           
EGYPT          0.01            0.01           
ETHIOPIA       0.02            0.02           
FRANCE         0.01            0.01           
GERMANY        0.04            0.04           
INDIA          0.01            0.01           
INDONESIA      0.02            0.02           
IRAN           0.11            0.11           
IRAQ           0.01            0.01           
JAPAN          0.09            0.09           
JORDAN         0.02            0.02           
KENYA          0.05            0.05           
MOROCCO        0.05            0.05           
MOZAMBIQUE     0.02            0.02           
PERU           0.08            0.08           
ROMANIA        0.03            0.03           
RUSSIA         0.03            0.03           
SAUDI ARABIA   0.03            0.03           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.04            0.04           
2022-07-09 15:28:31,056 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.03            0.03           
ARGENTINA      0.04            0.04           
BRAZIL         0.03            0.03           
CANADA         0.01            0.01           
CHINA          0.02            0.02           
EGYPT          0.01            0.01           
ETHIOPIA       0.02            0.02           
FRANCE         0.01            0.01           
GERMANY        0.04            0.04           
INDIA          0.01            0.01           
INDONESIA      0.02            0.02           
IRAN           0.11            0.11           
IRAQ           0.01            0.01           
JAPAN          0.08            0.08           
JORDAN         0.02            0.02           
KENYA          0.05            0.05           
MOROCCO        0.04            0.04           
MOZAMBIQUE     0.02            0.02           
PERU           0.08            0.08           
ROMANIA        0.03            0.03           
RUSSIA         0.03            0.03           
SAUDI ARABIA   0.03            0.03           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.04            0.04           
2022-07-09 15:28:31,056 - main.py[line:554] - INFO: relative error average: 0.032752635405404774
2022-07-09 15:28:31,056 - main.py[line:555] - INFO: relative error normalized average: 0.03190205978376693
2022-07-09 15:28:31,057 - main.py[line:601] - INFO: total_time:2.816259890794754
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
