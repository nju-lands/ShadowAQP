main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:16:10,714 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:16:10,714 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:16:10,714 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:16:10,714 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:16:10,884 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16957713663578033
2022-07-09 15:16:10,884 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:16:10,885 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:16:12,915 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.029441423714161
2022-07-09 15:16:12,915 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2005475759506226
2022-07-09 15:16:12,915 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:12,916 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.001378372311592102
2022-07-09 15:16:12,916 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:16:12,917 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:16:12,918 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014049820601940155
2022-07-09 15:16:12,918 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035578273236751556
2022-07-09 15:16:12,918 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:16:12,919 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.009000000000000001
2022-07-09 15:16:12,919 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:16:12,920 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.009000000000000001
2022-07-09 15:16:12,921 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:16:12,922 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.009000000000000001
2022-07-09 15:16:13,597 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6759042777121067
2022-07-09 15:16:13,751 - pytorch_cvae.py[line:399] - INFO: sampling time:0.8318291641771793
2022-07-09 15:16:13,899 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:13,904 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0051011741161346436
2022-07-09 15:16:13,952 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:13,955 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0025376975536346436
2022-07-09 15:16:14,081 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.1607653424143791
2022-07-09 15:16:14,110 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.191838078200817
2022-07-09 15:16:14,134 - pytorch_cvae.py[line:399] - INFO: sampling time:1.211791142821312
2022-07-09 15:16:14,256 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:14,258 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.0019131749868392944
2022-07-09 15:16:14,273 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.350910298526287
2022-07-09 15:16:14,278 - main.py[line:542] - INFO: sample time: 1.3591735623776913
2022-07-09 15:16:14,287 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4514.68         945694231.76   
ARGENTINA      4561.67         958155454.12   
BRAZIL         4498.63         945081816.43   
CANADA         4534.35         953386920.87   
CHINA          4536.07         952348860.72   
EGYPT          4498.35         947122408.12   
ETHIOPIA       4427.82         932929178.10   
FRANCE         4488.02         943193012.70   
GERMANY        4402.39         925374174.97   
INDIA          4471.13         939715605.62   
INDONESIA      4546.32         955459733.25   
IRAN           4489.62         944319808.31   
IRAQ           4523.90         949281108.13   
JAPAN          4440.56         928955396.10   
JORDAN         4441.71         930183914.64   
KENYA          4395.51         919545421.94   
MOROCCO        4444.35         934566949.01   
MOZAMBIQUE     4536.16         951437456.23   
PERU           4535.10         953572820.70   
ROMANIA        4570.59         960595816.78   
RUSSIA         4446.58         933826076.70   
SAUDI ARABIA   4470.84         938376667.79   
UNITED KINGDOM 4529.83         953904861.00   
UNITED STATES  4512.08         945695861.71   
VIETNAM        4496.67         943096388.30   
2022-07-09 15:16:14,289 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:16:14,295 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.02            0.02           
BRAZIL         0.00            0.00           
CANADA         0.01            0.01           
CHINA          0.01            0.01           
EGYPT          0.00            0.00           
ETHIOPIA       0.01            0.01           
FRANCE         0.00            0.00           
GERMANY        0.02            0.02           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.00            0.00           
JAPAN          0.01            0.01           
JORDAN         0.01            0.01           
KENYA          0.02            0.02           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.01            0.01           
PERU           0.01            0.01           
ROMANIA        0.02            0.02           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.00            0.00           
VIETNAM        0.00            0.00           
2022-07-09 15:16:14,297 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.02            0.02           
BRAZIL         0.00            0.00           
CANADA         0.01            0.01           
CHINA          0.01            0.01           
EGYPT          0.00            0.00           
ETHIOPIA       0.01            0.01           
FRANCE         0.00            0.00           
GERMANY        0.02            0.02           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.00            0.00           
JAPAN          0.01            0.01           
JORDAN         0.01            0.01           
KENYA          0.02            0.02           
MOROCCO        0.01            0.01           
MOZAMBIQUE     0.01            0.01           
PERU           0.01            0.01           
ROMANIA        0.02            0.02           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.00            0.00           
VIETNAM        0.00            0.00           
2022-07-09 15:16:14,297 - main.py[line:554] - INFO: relative error average: 0.0092160050083642
2022-07-09 15:16:14,297 - main.py[line:555] - INFO: relative error normalized average: 0.00915622788486332
2022-07-09 15:16:14,298 - main.py[line:601] - INFO: total_time:3.5839403346180916
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:29:57,245 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:29:57,245 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:29:57,245 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:29:57,245 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:29:57,412 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.16644545271992683
2022-07-09 15:29:57,412 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:29:57,413 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:29:59,471 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0578984022140503
2022-07-09 15:29:59,471 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2258947640657425
2022-07-09 15:29:59,471 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:29:59,473 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.001364968717098236
2022-07-09 15:29:59,473 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:29:59,473 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:29:59,475 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014155805110931396
2022-07-09 15:29:59,475 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.003548242151737213
2022-07-09 15:29:59,475 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:29:59,475 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.009000000000000001
2022-07-09 15:30:00,087 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6109721548855305
2022-07-09 15:30:00,206 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:30:00,208 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.001943010836839676
2022-07-09 15:30:00,246 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7706990651786327
2022-07-09 15:30:00,249 - main.py[line:542] - INFO: sample time: 0.7741689868271351
2022-07-09 15:30:00,259 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4555.16         954172934.06   
ARGENTINA      4605.43         967346802.77   
BRAZIL         4491.55         943593105.62   
CANADA         4501.11         946399218.73   
CHINA          4484.03         941422060.59   
EGYPT          4441.95         935248456.61   
ETHIOPIA       4439.37         935361319.47   
FRANCE         4484.28         942408238.17   
GERMANY        4508.14         947602540.23   
INDIA          4445.65         934360969.04   
INDONESIA      4536.13         953317533.95   
IRAN           4492.63         944952129.45   
IRAQ           4619.08         969253310.95   
JAPAN          4427.37         926197735.67   
JORDAN         4454.71         932905015.80   
KENYA          4371.45         914512381.01   
MOROCCO        4505.61         947448119.32   
MOZAMBIQUE     4492.07         942189760.50   
PERU           4451.31         935954293.22   
ROMANIA        4503.91         946583263.53   
RUSSIA         4397.68         923555890.45   
SAUDI ARABIA   4439.45         931787645.80   
UNITED KINGDOM 4389.85         924426904.70   
UNITED STATES  4492.66         941626295.14   
VIETNAM        4396.94         922179756.17   
2022-07-09 15:30:00,262 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:30:00,268 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.03            0.03           
BRAZIL         0.00            0.00           
CANADA         0.00            0.00           
CHINA          0.00            0.00           
EGYPT          0.01            0.01           
ETHIOPIA       0.01            0.01           
FRANCE         0.00            0.00           
GERMANY        0.00            0.00           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.03            0.03           
JAPAN          0.01            0.01           
JORDAN         0.01            0.01           
KENYA          0.03            0.03           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.00            0.00           
PERU           0.01            0.01           
ROMANIA        0.00            0.00           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.00            0.00           
VIETNAM        0.02            0.02           
2022-07-09 15:30:00,270 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.03            0.03           
BRAZIL         0.00            0.00           
CANADA         0.00            0.00           
CHINA          0.00            0.00           
EGYPT          0.01            0.01           
ETHIOPIA       0.01            0.01           
FRANCE         0.00            0.00           
GERMANY        0.00            0.00           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.02            0.02           
JAPAN          0.01            0.01           
JORDAN         0.01            0.01           
KENYA          0.03            0.03           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.00            0.00           
PERU           0.01            0.01           
ROMANIA        0.00            0.00           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.00            0.00           
VIETNAM        0.02            0.02           
2022-07-09 15:30:00,270 - main.py[line:554] - INFO: relative error average: 0.011416855925647632
2022-07-09 15:30:00,270 - main.py[line:555] - INFO: relative error normalized average: 0.011314262913024176
2022-07-09 15:30:00,271 - main.py[line:601] - INFO: total_time:3.025977101176977
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
