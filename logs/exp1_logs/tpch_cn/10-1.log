main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:16:16,948 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:16:16,948 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:16:16,948 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:16:16,948 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:16:17,113 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.1653234325349331
2022-07-09 15:16:17,113 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:16:17,115 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:16:19,161 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.045822601765394
2022-07-09 15:16:19,161 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.2126504369080067
2022-07-09 15:16:19,161 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:19,162 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013663694262504578
2022-07-09 15:16:19,162 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:16:19,163 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:16:19,164 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0013995915651321411
2022-07-09 15:16:19,164 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035289861261844635
2022-07-09 15:16:19,164 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:16:19,165 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.01
2022-07-09 15:16:19,165 - main.py[line:525] - INFO: multi_sampling No.1 epoch
2022-07-09 15:16:19,166 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.01
2022-07-09 15:16:19,167 - main.py[line:525] - INFO: multi_sampling No.2 epoch
2022-07-09 15:16:19,168 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.01
2022-07-09 15:16:19,852 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6850586719810963
2022-07-09 15:16:20,002 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:20,004 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.002075914293527603
2022-07-09 15:16:20,157 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.9905479773879051
2022-07-09 15:16:20,178 - pytorch_cvae.py[line:399] - INFO: sampling time:1.0091389417648315
2022-07-09 15:16:20,394 - pytorch_cvae.py[line:399] - INFO: sampling time:1.229527272284031
2022-07-09 15:16:20,677 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:20,697 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.020125780254602432
2022-07-09 15:16:20,801 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.6333842724561691
2022-07-09 15:16:20,821 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:16:20,825 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.003948871046304703
2022-07-09 15:16:20,846 - main.py[line:509] - INFO: sample and aggregation time elapsed:1.6816261410713196
2022-07-09 15:16:20,848 - main.py[line:542] - INFO: sample time: 1.6839808486402035
2022-07-09 15:16:20,852 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4515.52         945869667.57   
ARGENTINA      4515.85         948531344.63   
BRAZIL         4478.28         940806997.52   
CANADA         4491.82         944444899.07   
CHINA          4545.82         954394075.19   
EGYPT          4476.98         942623177.23   
ETHIOPIA       4489.97         946023401.23   
FRANCE         4483.11         942161363.42   
GERMANY        4475.65         940771680.23   
INDIA          4450.86         935454384.12   
INDONESIA      4559.92         958317432.75   
IRAN           4531.59         953147393.57   
IRAQ           4474.64         938944773.50   
JAPAN          4393.67         919147967.47   
JORDAN         4493.23         940973119.93   
KENYA          4465.39         934164664.36   
MOROCCO        4419.51         929343344.65   
MOZAMBIQUE     4486.25         940968049.78   
PERU           4520.13         950424767.60   
ROMANIA        4471.05         939676928.39   
RUSSIA         4469.33         938603792.29   
SAUDI ARABIA   4428.95         929583847.78   
UNITED KINGDOM 4470.62         941436397.29   
UNITED STATES  4508.81         945011238.14   
VIETNAM        4541.90         952580902.50   
2022-07-09 15:16:20,853 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:16:20,856 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.00            0.00           
CHINA          0.01            0.01           
EGYPT          0.00            0.00           
ETHIOPIA       0.00            0.00           
FRANCE         0.00            0.00           
GERMANY        0.00            0.00           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.01            0.01           
JAPAN          0.02            0.02           
JORDAN         0.00            0.00           
KENYA          0.01            0.01           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.00            0.00           
PERU           0.00            0.00           
ROMANIA        0.01            0.01           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.00            0.00           
VIETNAM        0.01            0.01           
2022-07-09 15:16:20,857 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.00            0.00           
ARGENTINA      0.01            0.01           
BRAZIL         0.01            0.01           
CANADA         0.00            0.00           
CHINA          0.01            0.01           
EGYPT          0.00            0.00           
ETHIOPIA       0.00            0.00           
FRANCE         0.00            0.00           
GERMANY        0.00            0.00           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.01            0.01           
IRAQ           0.01            0.01           
JAPAN          0.02            0.02           
JORDAN         0.00            0.00           
KENYA          0.01            0.01           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.00            0.00           
PERU           0.00            0.00           
ROMANIA        0.01            0.01           
RUSSIA         0.01            0.01           
SAUDI ARABIA   0.02            0.02           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.00            0.00           
VIETNAM        0.01            0.01           
2022-07-09 15:16:20,857 - main.py[line:554] - INFO: relative error average: 0.007265683302262349
2022-07-09 15:16:20,857 - main.py[line:555] - INFO: relative error normalized average: 0.007225099902942649
2022-07-09 15:16:20,858 - main.py[line:601] - INFO: total_time:3.910275761038065
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2022-07-09 15:30:02,924 - main.py[line:581] - INFO: load query config config/query/customer_join_nation.json successfully
2022-07-09 15:30:02,924 - main.py[line:588] - INFO: load train config ./config/train/tpch_customer_torch_cvae.json successfully
2022-07-09 15:30:02,924 - main.py[line:588] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2022-07-09 15:30:02,924 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-1m-customer_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2022-07-09 15:30:03,096 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.17166881635785103
2022-07-09 15:30:03,096 - pytorch_cvae.py[line:276] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2022-07-09 15:30:03,097 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-1m-customer_c_nationkey_ld100_id100_bs512_ep150_0_binary_gaussian5
2022-07-09 15:30:05,147 - model_utils.py[line:86] - INFO: load torch model time elapsed:2.0501856729388237
2022-07-09 15:30:05,147 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:2.223388869315386
2022-07-09 15:30:05,147 - dataset_utils.py[line:567] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:30:05,149 - dataset_utils.py[line:576] - INFO: load dataset(light) time elapsed:0.0013746954500675201
2022-07-09 15:30:05,149 - pytorch_cvae.py[line:276] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2022-07-09 15:30:05,150 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2022-07-09 15:30:05,151 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0014332868158817291
2022-07-09 15:30:05,151 - pytorch_cvae.py[line:286] - INFO: load model time elapsed:0.0035773366689682007
2022-07-09 15:30:05,151 - main.py[line:525] - INFO: multi_sampling No.0 epoch
2022-07-09 15:30:05,151 - pytorch_cvae.py[line:419] - INFO: house sampling rate:0.01
2022-07-09 15:30:05,777 - pytorch_cvae.py[line:399] - INFO: sampling time:0.6250988580286503
2022-07-09 15:30:05,907 - dataset_utils.py[line:548] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2022-07-09 15:30:05,909 - dataset_utils.py[line:560] - INFO: load dataset time elapsed:0.001960843801498413
2022-07-09 15:30:05,932 - main.py[line:509] - INFO: sample and aggregation time elapsed:0.7811174914240837
2022-07-09 15:30:05,936 - main.py[line:542] - INFO: sample time: 0.7845800518989563
2022-07-09 15:30:05,946 - main.py[line:99] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4536.33         950229780.06   
ARGENTINA      4608.29         967947621.67   
BRAZIL         4451.76         935233831.71   
CANADA         4416.00         928503035.31   
CHINA          4396.34         923011598.71   
EGYPT          4451.61         937282661.00   
ETHIOPIA       4523.60         953108153.59   
FRANCE         4489.31         943463561.34   
GERMANY        4370.84         918741198.41   
INDIA          4552.98         956918308.70   
INDONESIA      4559.52         958232793.28   
IRAN           4507.06         947987541.43   
IRAQ           4475.74         939176056.74   
JAPAN          4409.29         922414005.34   
JORDAN         4493.30         940986960.81   
KENYA          4532.88         948283363.86   
MOROCCO        4502.39         946771493.83   
MOZAMBIQUE     4587.59         962224613.34   
PERU           4578.22         962638598.20   
ROMANIA        4625.34         972102844.01   
RUSSIA         4403.27         924731334.21   
SAUDI ARABIA   4454.53         934951442.32   
UNITED KINGDOM 4482.09         943851116.82   
UNITED STATES  4423.42         927114319.84   
VIETNAM        4436.15         930403405.18   
2022-07-09 15:30:05,948 - main.py[line:100] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4498.95         942399631.68   
ARGENTINA      4483.88         941816808.61   
BRAZIL         4511.85         947858318.41   
CANADA         4490.01         944064844.06   
CHINA          4504.31         945679440.88   
EGYPT          4499.30         947323811.48   
ETHIOPIA       4493.96         946864251.97   
FRANCE         4496.91         945061618.32   
GERMANY        4496.45         945145072.96   
INDIA          4508.75         947621736.24   
INDONESIA      4495.16         944706347.10   
IRAN           4508.78         948349182.43   
IRAQ           4505.86         945495447.51   
JAPAN          4486.76         938621285.05   
JORDAN         4498.32         942038984.41   
KENYA          4492.92         939923709.64   
MOROCCO        4496.65         945564714.81   
MOZAMBIQUE     4497.97         943426627.93   
PERU           4498.89         945959166.36   
ROMANIA        4493.86         944470531.83   
RUSSIA         4509.35         947009565.44   
SAUDI ARABIA   4508.24         946225279.07   
UNITED KINGDOM 4491.46         945824613.02   
UNITED STATES  4497.85         942713372.66   
VIETNAM        4497.42         943253101.24   
2022-07-09 15:30:05,954 - main.py[line:550] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.03            0.03           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.02            0.02           
EGYPT          0.01            0.01           
ETHIOPIA       0.01            0.01           
FRANCE         0.00            0.00           
GERMANY        0.03            0.03           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.01            0.01           
JAPAN          0.02            0.02           
JORDAN         0.00            0.00           
KENYA          0.01            0.01           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.02            0.02           
PERU           0.02            0.02           
ROMANIA        0.03            0.03           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.01            0.01           
2022-07-09 15:30:05,956 - main.py[line:551] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.01            0.01           
ARGENTINA      0.03            0.03           
BRAZIL         0.01            0.01           
CANADA         0.02            0.02           
CHINA          0.02            0.02           
EGYPT          0.01            0.01           
ETHIOPIA       0.01            0.01           
FRANCE         0.00            0.00           
GERMANY        0.03            0.03           
INDIA          0.01            0.01           
INDONESIA      0.01            0.01           
IRAN           0.00            0.00           
IRAQ           0.01            0.01           
JAPAN          0.02            0.02           
JORDAN         0.00            0.00           
KENYA          0.01            0.01           
MOROCCO        0.00            0.00           
MOZAMBIQUE     0.02            0.02           
PERU           0.02            0.02           
ROMANIA        0.03            0.03           
RUSSIA         0.02            0.02           
SAUDI ARABIA   0.01            0.01           
UNITED KINGDOM 0.00            0.00           
UNITED STATES  0.02            0.02           
VIETNAM        0.01            0.01           
2022-07-09 15:30:05,957 - main.py[line:554] - INFO: relative error average: 0.013236213916941878
2022-07-09 15:30:05,957 - main.py[line:555] - INFO: relative error normalized average: 0.013112099406871112
2022-07-09 15:30:05,958 - main.py[line:601] - INFO: total_time:3.033854864537716
categorical_columns: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
