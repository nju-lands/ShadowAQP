main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-05-21 06:41:10,104 - main.py[line:601] - INFO: load query config config/query/customer_inc_join_nation.json successfully
2023-05-21 06:41:10,104 - main.py[line:608] - INFO: load train config ./config/train/tpch_customer_torch_cvae_inc.json successfully
2023-05-21 06:41:10,104 - main.py[line:608] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2023-05-21 06:41:10,104 - dataset_utils.py[line:565] - INFO: load existing dataset:tpch-20g-customer-inc_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2023-05-21 06:41:13,566 - dataset_utils.py[line:200] - INFO: encode incremental data categorical columns time elapsed:0.10769403004087508
2023-05-21 06:41:31,905 - dataset_utils.py[line:217] - INFO: encode incremental data numeric columnstime elapsed:18.338567633996718
2023-05-21 06:41:32,767 - dataset_utils.py[line:275] - INFO: load incremental data time elapsed:19.4694366089534
2023-05-21 06:41:32,773 - dataset_utils.py[line:577] - INFO: load dataset time elapsed:22.66893610509578
2023-05-21 06:41:32,773 - pytorch_cvae.py[line:300] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2023-05-21 06:41:32,775 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-20g-customer-inc_c_nationkey_ld50_id100_bs1024_ep150_0_binary_gaussian5
2023-05-21 06:41:32,777 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0019310590578243136
2023-05-21 06:41:32,777 - pytorch_cvae.py[line:311] - INFO: load model time elapsed:22.672286657965742
2023-05-21 06:41:41,975 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-05-21 06:41:41,975 - pytorch_cvae.py[line:177] - INFO: loss:406.9041913598776, numeric_loss:42.47353421803564, categorical_loss:287.79853546619415, kld_loss:14216.51874768734, epoch_train_time:9.198123853071593
2023-05-21 06:41:50,590 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.2 epoch----------------------------
2023-05-21 06:41:50,590 - pytorch_cvae.py[line:177] - INFO: loss:73.64699270576239, numeric_loss:5.337917412165552, categorical_loss:9.984384120907634, kld_loss:9795.409138679504, epoch_train_time:8.614486019941978
2023-05-21 06:41:59,056 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.3 epoch----------------------------
2023-05-21 06:41:59,056 - pytorch_cvae.py[line:177] - INFO: loss:62.224859945476055, numeric_loss:3.6713046266231686, categorical_loss:5.416119598550722, kld_loss:8087.0979347229, epoch_train_time:8.466192319989204
2023-05-21 06:42:07,656 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.4 epoch----------------------------
2023-05-21 06:42:07,656 - pytorch_cvae.py[line:177] - INFO: loss:62.09345819056034, numeric_loss:3.6902155289426446, categorical_loss:4.561647937865928, kld_loss:7433.03740978241, epoch_train_time:8.599824097938836
2023-05-21 06:42:16,233 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.5 epoch----------------------------
2023-05-21 06:42:16,233 - pytorch_cvae.py[line:177] - INFO: loss:64.65710765868425, numeric_loss:3.88619387941435, categorical_loss:4.2938190922141075, kld_loss:7079.642654418945, epoch_train_time:8.576319001964293
2023-05-21 06:42:24,713 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.6 epoch----------------------------
2023-05-21 06:42:24,713 - pytorch_cvae.py[line:177] - INFO: loss:68.39975698292255, numeric_loss:4.145488642156124, categorical_loss:4.385721383383498, kld_loss:6821.2280921936035, epoch_train_time:8.47955061297398
2023-05-21 06:42:33,196 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.7 epoch----------------------------
2023-05-21 06:42:33,196 - pytorch_cvae.py[line:177] - INFO: loss:72.97200330346823, numeric_loss:4.496548805385828, categorical_loss:4.704742692876607, kld_loss:6610.652136802673, epoch_train_time:8.483160409959964
2023-05-21 06:42:41,657 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.8 epoch----------------------------
2023-05-21 06:42:41,657 - pytorch_cvae.py[line:177] - INFO: loss:77.93299414217472, numeric_loss:4.893539673183113, categorical_loss:5.025610813871026, kld_loss:6421.164928436279, epoch_train_time:8.460488979006186
2023-05-21 06:42:50,074 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.9 epoch----------------------------
2023-05-21 06:42:50,074 - pytorch_cvae.py[line:177] - INFO: loss:83.59311264008284, numeric_loss:5.240691540762782, categorical_loss:5.469223589869216, kld_loss:6272.94809627533, epoch_train_time:8.416844176012091
2023-05-21 06:42:58,593 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.10 epoch----------------------------
2023-05-21 06:42:58,593 - pytorch_cvae.py[line:177] - INFO: loss:89.62084361165762, numeric_loss:5.695289232302457, categorical_loss:5.959506316576153, kld_loss:6123.670892238617, epoch_train_time:8.51908680901397
2023-05-21 06:43:07,095 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.11 epoch----------------------------
2023-05-21 06:43:07,095 - pytorch_cvae.py[line:177] - INFO: loss:95.97793778777122, numeric_loss:6.105654458515346, categorical_loss:6.547285196837038, kld_loss:5978.303701877594, epoch_train_time:8.502085665008053
2023-05-21 06:43:15,507 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.12 epoch----------------------------
2023-05-21 06:43:15,507 - pytorch_cvae.py[line:177] - INFO: loss:102.84198789298534, numeric_loss:6.63393858121708, categorical_loss:7.167684951331466, kld_loss:5841.444256782532, epoch_train_time:8.411818147054873
2023-05-21 06:43:23,974 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.13 epoch----------------------------
2023-05-21 06:43:23,974 - pytorch_cvae.py[line:177] - INFO: loss:110.36983759701252, numeric_loss:7.149866387248039, categorical_loss:7.884462284389883, kld_loss:5724.702791213989, epoch_train_time:8.466338996076956
2023-05-21 06:43:32,468 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.14 epoch----------------------------
2023-05-21 06:43:32,468 - pytorch_cvae.py[line:177] - INFO: loss:118.56321068108082, numeric_loss:7.631713897921145, categorical_loss:8.76523300493136, kld_loss:5620.8888964653015, epoch_train_time:8.494298579986207
2023-05-21 06:43:40,859 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.15 epoch----------------------------
2023-05-21 06:43:40,859 - pytorch_cvae.py[line:177] - INFO: loss:127.12263812124729, numeric_loss:8.125169762410223, categorical_loss:9.66502773296088, kld_loss:5516.708868980408, epoch_train_time:8.391102588037029
2023-05-21 06:43:49,305 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.16 epoch----------------------------
2023-05-21 06:43:49,305 - pytorch_cvae.py[line:177] - INFO: loss:135.99106223881245, numeric_loss:8.675170499831438, categorical_loss:10.591602565720677, kld_loss:5407.046176433563, epoch_train_time:8.445774277905002
2023-05-21 06:43:57,741 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.17 epoch----------------------------
2023-05-21 06:43:57,741 - pytorch_cvae.py[line:177] - INFO: loss:145.63203997910023, numeric_loss:9.144014618359506, categorical_loss:11.754593940917403, kld_loss:5309.86928319931, epoch_train_time:8.435779180959798
2023-05-21 06:44:06,102 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.18 epoch----------------------------
2023-05-21 06:44:06,102 - pytorch_cvae.py[line:177] - INFO: loss:155.64459544420242, numeric_loss:9.801715416833758, categorical_loss:12.87577421311289, kld_loss:5206.928061962128, epoch_train_time:8.360893782926723
2023-05-21 06:44:14,574 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.19 epoch----------------------------
2023-05-21 06:44:14,574 - pytorch_cvae.py[line:177] - INFO: loss:166.0984744131565, numeric_loss:10.333834418095648, categorical_loss:14.221200655214489, kld_loss:5103.848721504211, epoch_train_time:8.47165607206989
2023-05-21 06:44:23,082 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.20 epoch----------------------------
2023-05-21 06:44:23,082 - pytorch_cvae.py[line:177] - INFO: loss:177.4885010868311, numeric_loss:10.889168346300721, categorical_loss:15.616217534057796, kld_loss:5018.124520778656, epoch_train_time:8.507666200981475
2023-05-21 06:44:23,082 - pytorch_cvae.py[line:186] - INFO: training time elapsed:170.30539600993507
2023-05-21 06:44:23,083 - model_utils.py[line:67] - INFO: save model successfully
2023-05-21 06:44:34,439 - dataset_utils.py[line:584] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2023-05-21 06:44:34,441 - dataset_utils.py[line:593] - INFO: load dataset(light) time elapsed:0.0020575140370056033
2023-05-21 06:44:34,441 - pytorch_cvae.py[line:280] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2023-05-21 06:44:34,442 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2023-05-21 06:44:34,444 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.002098285942338407
2023-05-21 06:44:34,444 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.005209577968344092
2023-05-21 06:44:34,444 - main.py[line:541] - INFO: multi_sampling No.0 epoch
2023-05-21 06:44:34,499 - pytorch_cvae.py[line:407] - INFO: sampling time:0.053949470981024206
2023-05-21 06:44:34,499 - dataset_utils.py[line:565] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2023-05-21 06:44:34,506 - dataset_utils.py[line:577] - INFO: load dataset time elapsed:0.006457555922679603
2023-05-21 06:44:34,538 - main.py[line:525] - INFO: sample and aggregation time elapsed:0.09294855897314847
2023-05-21 06:44:34,541 - main.py[line:558] - INFO: sample time: 0.09650691004935652
2023-05-21 06:44:34,550 - main.py[line:101] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4285.38         622031309.04   
ARGENTINA      4718.14         753507435.32   
BRAZIL         4847.64         774432500.84   
CANADA         4531.87         800155930.95   
CHINA          4903.21         599164916.86   
EGYPT          4671.51         655526242.95   
ETHIOPIA       4885.09         828877563.54   
FRANCE         4835.64         807296616.46   
GERMANY        5283.15         777577030.33   
INDIA          4683.04         967962193.81   
INDONESIA      4183.60         627567870.07   
IRAN           4630.80         773479227.46   
IRAQ           4634.67         833123593.29   
JAPAN          4483.17         818346546.78   
JORDAN         4507.53         612086880.97   
KENYA          4457.98         534835589.07   
MOROCCO        5426.08         908663828.13   
MOZAMBIQUE     4496.72         909891270.31   
PERU           4635.86         711031423.50   
ROMANIA        5008.54         767954792.74   
RUSSIA         4891.19         730825460.86   
SAUDI ARABIA   4388.75         667692629.82   
UNITED KINGDOM 4764.61         778506796.11   
UNITED STATES  5146.66         364800957.92   
VIETNAM        4769.66         631470278.11   
2023-05-21 06:44:34,553 - main.py[line:102] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4497.45         699444173.29   
ARGENTINA      4486.94         699106008.33   
BRAZIL         4502.65         701773384.16   
CANADA         4499.32         700256734.44   
CHINA          4491.27         700629814.31   
EGYPT          4496.39         701059444.40   
ETHIOPIA       4499.89         704785653.13   
FRANCE         4493.15         703235862.49   
GERMANY        4489.33         701673966.77   
INDIA          4507.72         706211190.60   
INDONESIA      4498.74         704439111.14   
IRAN           4507.57         705840896.67   
IRAQ           4509.27         704081769.17   
JAPAN          4493.66         698094511.41   
JORDAN         4504.65         699080891.27   
KENYA          4499.24         698201348.30   
MOROCCO        4499.58         700940690.68   
MOZAMBIQUE     4507.23         700194448.01   
PERU           4490.77         700452753.83   
ROMANIA        4487.90         699789990.15   
RUSSIA         4518.25         704711627.29   
SAUDI ARABIA   4508.93         703718011.11   
UNITED KINGDOM 4491.37         704507986.21   
UNITED STATES  4505.47         703758434.40   
VIETNAM        4497.59         701569658.84   
2023-05-21 06:44:34,559 - main.py[line:570] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.05            0.11           
ARGENTINA      0.05            0.08           
BRAZIL         0.08            0.10           
CANADA         0.01            0.14           
CHINA          0.09            0.14           
EGYPT          0.04            0.06           
ETHIOPIA       0.09            0.18           
FRANCE         0.08            0.15           
GERMANY        0.18            0.11           
INDIA          0.04            0.37           
INDONESIA      0.07            0.11           
IRAN           0.03            0.10           
IRAQ           0.03            0.18           
JAPAN          0.00            0.17           
JORDAN         0.00            0.12           
KENYA          0.01            0.23           
MOROCCO        0.21            0.30           
MOZAMBIQUE     0.00            0.30           
PERU           0.03            0.02           
ROMANIA        0.12            0.10           
RUSSIA         0.08            0.04           
SAUDI ARABIA   0.03            0.05           
UNITED KINGDOM 0.06            0.11           
UNITED STATES  0.14            0.48           
VIETNAM        0.06            0.10           
2023-05-21 06:44:34,561 - main.py[line:571] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.05            0.10           
ARGENTINA      0.05            0.07           
BRAZIL         0.07            0.10           
CANADA         0.01            0.13           
CHINA          0.09            0.13           
EGYPT          0.04            0.06           
ETHIOPIA       0.08            0.16           
FRANCE         0.07            0.14           
GERMANY        0.16            0.10           
INDIA          0.04            0.31           
INDONESIA      0.07            0.10           
IRAN           0.03            0.09           
IRAQ           0.03            0.17           
JAPAN          0.00            0.16           
JORDAN         0.00            0.12           
KENYA          0.01            0.21           
MOROCCO        0.19            0.26           
MOZAMBIQUE     0.00            0.26           
PERU           0.03            0.01           
ROMANIA        0.11            0.09           
RUSSIA         0.08            0.04           
SAUDI ARABIA   0.03            0.05           
UNITED KINGDOM 0.06            0.10           
UNITED STATES  0.13            0.38           
VIETNAM        0.06            0.10           
2023-05-21 06:44:34,561 - main.py[line:574] - INFO: relative error average: 0.10813782555528936
2023-05-21 06:44:34,561 - main.py[line:575] - INFO: relative error normalized average: 0.09861763523043272
2023-05-21 06:44:34,566 - main.py[line:621] - INFO: total_time:204.4621498809429
feature_names: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
feature_names: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
