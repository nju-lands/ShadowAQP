main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-05-20 13:19:52,683 - main.py[line:600] - INFO: load query config config/query/census2_inc.json successfully
2023-05-20 13:19:52,683 - main.py[line:607] - INFO: load train config ./config/train/census2_a_inc_torch_cvae.json successfully
2023-05-20 13:19:52,683 - main.py[line:607] - INFO: load train config ./config/train/census2_b_torch_cvae.json successfully
2023-05-20 13:19:52,683 - dataset_utils.py[line:555] - INFO: load existing dataset:census2-adult-a-inc_a_education_num#a_relationship_a_fnlwgt#a_age#a_hours_per_week_a_education_num#a_relationship_binary_gaussian5_0
2023-05-20 13:19:56,480 - dataset_utils.py[line:200] - INFO: encode incremental data categorical columns time elapsed:0.020296924049034715
2023-05-20 13:19:59,307 - dataset_utils.py[line:217] - INFO: encode incremental data numeric columnstime elapsed:2.8267616929952055
2023-05-20 13:19:59,356 - dataset_utils.py[line:265] - INFO: load incremental data time elapsed:4.481402624049224
2023-05-20 13:19:59,357 - dataset_utils.py[line:567] - INFO: load dataset time elapsed:6.673995880992152
2023-05-20 13:19:59,357 - pytorch_cvae.py[line:300] - INFO: feature info:[('a_fnlwgt', 'numerical', 6), ('a_age', 'numerical', 6), ('a_hours_per_week', 'numerical', 6), ('a_education_num', 'categorical', 5), ('a_relationship', 'categorical', 4)]
2023-05-20 13:19:59,358 - model_utils.py[line:75] - INFO: load model name:torch_cvae_census2-adult-a-inc_a_education_num_a_relationship_ld50_id100_bs512_ep150_0_binary_gaussian5
2023-05-20 13:19:59,360 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.001939144916832447
2023-05-20 13:19:59,360 - pytorch_cvae.py[line:311] - INFO: load model time elapsed:6.677354743005708
2023-05-20 13:20:00,644 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-05-20 13:20:00,644 - pytorch_cvae.py[line:177] - INFO: loss:43.20446130633354, numeric_loss:16.727058306336403, categorical_loss:22.278660129755735, kld_loss:778.9357857704163, epoch_train_time:1.282921093981713
2023-05-20 13:20:01,526 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.2 epoch----------------------------
2023-05-20 13:20:01,526 - pytorch_cvae.py[line:177] - INFO: loss:24.63908550143242, numeric_loss:16.556225016713142, categorical_loss:2.1233580335974693, kld_loss:1000.8756666183472, epoch_train_time:0.8819935159990564
2023-05-20 13:20:02,347 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.3 epoch----------------------------
2023-05-20 13:20:02,348 - pytorch_cvae.py[line:177] - INFO: loss:24.236802577972412, numeric_loss:16.39941382408142, categorical_loss:1.798458592966199, kld_loss:919.0774745941162, epoch_train_time:0.82110082404688
2023-05-20 13:20:03,151 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.4 epoch----------------------------
2023-05-20 13:20:03,151 - pytorch_cvae.py[line:177] - INFO: loss:22.873353719711304, numeric_loss:14.392582386732101, categorical_loss:1.7223529610782862, kld_loss:933.0253953933716, epoch_train_time:0.803278558072634
2023-05-20 13:20:04,000 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.5 epoch----------------------------
2023-05-20 13:20:04,000 - pytorch_cvae.py[line:177] - INFO: loss:19.16479028761387, numeric_loss:8.44990785419941, categorical_loss:1.8990975739434361, kld_loss:1105.0959043502808, epoch_train_time:0.8485702939797193
2023-05-20 13:20:04,879 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.6 epoch----------------------------
2023-05-20 13:20:04,879 - pytorch_cvae.py[line:177] - INFO: loss:17.26540568470955, numeric_loss:5.029579170048237, categorical_loss:1.7851117486134171, kld_loss:1190.7205390930176, epoch_train_time:0.8790753419743851
2023-05-20 13:20:05,680 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.7 epoch----------------------------
2023-05-20 13:20:05,680 - pytorch_cvae.py[line:177] - INFO: loss:16.8868038803339, numeric_loss:3.903719138354063, categorical_loss:1.626117111183703, kld_loss:1177.2953519821167, epoch_train_time:0.8009858819423243
2023-05-20 13:20:06,486 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.8 epoch----------------------------
2023-05-20 13:20:06,486 - pytorch_cvae.py[line:177] - INFO: loss:17.156285271048546, numeric_loss:3.4481295719742775, categorical_loss:1.6024308120831847, kld_loss:1142.897554397583, epoch_train_time:0.805734934983775
2023-05-20 13:20:07,406 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.9 epoch----------------------------
2023-05-20 13:20:07,406 - pytorch_cvae.py[line:177] - INFO: loss:17.751748234033585, numeric_loss:3.287274818867445, categorical_loss:1.6138331294059753, kld_loss:1106.0354490280151, epoch_train_time:0.9197495459811762
2023-05-20 13:20:08,210 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.10 epoch----------------------------
2023-05-20 13:20:08,210 - pytorch_cvae.py[line:177] - INFO: loss:18.479468196630478, numeric_loss:3.1749796867370605, categorical_loss:1.639057183638215, kld_loss:1073.3210973739624, epoch_train_time:0.8038046900182962
2023-05-20 13:20:09,014 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.11 epoch----------------------------
2023-05-20 13:20:09,014 - pytorch_cvae.py[line:177] - INFO: loss:19.391334176063538, numeric_loss:3.1966780237853527, categorical_loss:1.7085203994065523, kld_loss:1039.3341903686523, epoch_train_time:0.8033745860448107
2023-05-20 13:20:09,890 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.12 epoch----------------------------
2023-05-20 13:20:09,890 - pytorch_cvae.py[line:177] - INFO: loss:20.531047269701958, numeric_loss:3.20663633197546, categorical_loss:1.7429684791713953, kld_loss:1022.2119884490967, epoch_train_time:0.8763349469518289
2023-05-20 13:20:10,714 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.13 epoch----------------------------
2023-05-20 13:20:10,714 - pytorch_cvae.py[line:177] - INFO: loss:21.72810235619545, numeric_loss:3.362225640565157, categorical_loss:1.8272672779858112, kld_loss:993.1097440719604, epoch_train_time:0.8233370990492404
2023-05-20 13:20:11,517 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.14 epoch----------------------------
2023-05-20 13:20:11,517 - pytorch_cvae.py[line:177] - INFO: loss:22.998688459396362, numeric_loss:3.4897078201174736, categorical_loss:1.8967183930799365, kld_loss:968.975133895874, epoch_train_time:0.8030651999870315
2023-05-20 13:20:12,426 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.15 epoch----------------------------
2023-05-20 13:20:12,426 - pytorch_cvae.py[line:177] - INFO: loss:24.444887787103653, numeric_loss:3.662799272686243, categorical_loss:1.9479411104694009, kld_loss:950.3355760574341, epoch_train_time:0.9084423269378021
2023-05-20 13:20:13,363 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.16 epoch----------------------------
2023-05-20 13:20:13,363 - pytorch_cvae.py[line:177] - INFO: loss:26.03926756978035, numeric_loss:3.899432558566332, categorical_loss:2.1149450093507767, kld_loss:927.617600440979, epoch_train_time:0.9369551489362493
2023-05-20 13:20:14,217 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.17 epoch----------------------------
2023-05-20 13:20:14,218 - pytorch_cvae.py[line:177] - INFO: loss:27.591756403446198, numeric_loss:4.148297943174839, categorical_loss:2.1848419159650803, kld_loss:904.973708152771, epoch_train_time:0.8544390780152753
2023-05-20 13:20:15,052 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.18 epoch----------------------------
2023-05-20 13:20:15,052 - pytorch_cvae.py[line:177] - INFO: loss:29.299880117177963, numeric_loss:4.383018564432859, categorical_loss:2.28291798196733, kld_loss:886.3343753814697, epoch_train_time:0.8340818900614977
2023-05-20 13:20:15,946 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.19 epoch----------------------------
2023-05-20 13:20:15,946 - pytorch_cvae.py[line:177] - INFO: loss:31.163105458021164, numeric_loss:4.6720860823988914, categorical_loss:2.4425360998138785, kld_loss:867.153018951416, epoch_train_time:0.89398260100279
2023-05-20 13:20:16,794 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.20 epoch----------------------------
2023-05-20 13:20:16,794 - pytorch_cvae.py[line:177] - INFO: loss:33.15137737989426, numeric_loss:5.014718968421221, categorical_loss:2.5390609689056873, kld_loss:850.7701749801636, epoch_train_time:0.8476107800379395
2023-05-20 13:20:16,794 - pytorch_cvae.py[line:186] - INFO: training time elapsed:17.433390061953105
2023-05-20 13:20:16,795 - model_utils.py[line:67] - INFO: save model successfully
2023-05-20 13:20:18,781 - dataset_utils.py[line:574] - INFO: load existing dataset(light):census2-adult-b_b_education_num__b_education_num_binary_gaussian5_0
2023-05-20 13:20:18,805 - dataset_utils.py[line:583] - INFO: load dataset(light) time elapsed:0.024111241102218628
2023-05-20 13:20:18,805 - pytorch_cvae.py[line:280] - INFO: feature info:[('b_education_num', 'categorical', 5)]
2023-05-20 13:20:18,806 - model_utils.py[line:75] - INFO: load model name:torch_cvae_census2-adult-b_b_education_num_ld50_id100_bs512_ep150_0_binary_gaussian5
2023-05-20 13:20:18,809 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.003100681002251804
2023-05-20 13:20:18,810 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.028885363950394094
2023-05-20 13:20:18,810 - main.py[line:540] - INFO: multi_sampling No.0 epoch
2023-05-20 13:20:18,810 - pytorch_cvae.py[line:427] - INFO: house sampling rate:0.002
2023-05-20 13:20:18,912 - pytorch_cvae.py[line:407] - INFO: sampling time:0.10149596794508398
2023-05-20 13:20:18,912 - pytorch_cvae.py[line:427] - INFO: house sampling rate:0.5
2023-05-20 13:20:19,067 - pytorch_cvae.py[line:407] - INFO: sampling time:0.15457451692782342
2023-05-20 13:20:20,041 - main.py[line:524] - INFO: sample and aggregation time elapsed:1.230758143006824
2023-05-20 13:20:20,042 - main.py[line:557] - INFO: sample time: 1.2326750759966671
2023-05-20 13:20:20,053 - main.py[line:101] - INFO: aqp result:
                 avg(a_age)  avg(a_hours_per_week)  avg(a_fnlwgt)  \
a_relationship                                                      
 Husband        38.50       40.73                  190997.92        
 Not-in-family  36.39       41.54                  200020.74        
 Other-relative 36.66       38.14                  192509.42        
 Own-child      38.77       42.10                  194751.17        
 Unmarried      36.71       39.46                  195503.61        
 Wife           39.48       38.16                  212063.92        

                    sum(a_age)  sum(a_hours_per_week)      sum(a_fnlwgt)  
a_relationship                                                            
 Husband        87219737172.81 92284940393.73         432691237681402.62  
 Not-in-family  51497195254.40 58751712615.33         282845985195061.62  
 Other-relative 6075999205.50  6319176718.68          31528956755478.12   
 Own-child      33746564791.23 36666680747.41         169501231630809.31  
 Unmarried      21426238866.97 23050030932.30         113901424368860.73  
 Wife           10460362126.68 10181946860.71         56413475803690.72   
2023-05-20 13:20:20,055 - main.py[line:102] - INFO: ground truth:
                  sum(a_age)  avg(a_age)  sum(a_hours_per_week)  \
a_relationship                                                    
 Husband         87370070065 38.57       89423750935.98           
 Not-in-family   54595659351 38.59       55930158869.30           
 Other-relative  6625596621  38.75       6787215589.82            
 Own-child       33582483407 38.59       34394168467.46           
 Unmarried       22589581214 38.54       23165964367.03           
 Wife            10373880746 38.64       10656937777.96           

                 avg(a_hours_per_week)      sum(a_fnlwgt)  avg(a_fnlwgt)  
a_relationship                                                            
 Husband        39.48                  403039889506702.38 177941.66       
 Not-in-family  39.53                  250236539500460.41 176869.15       
 Other-relative 39.69                  30053448855758.80  175765.67       
 Own-child      39.52                  154254839485714.00 177241.88       
 Unmarried      39.52                  103401686055605.38 176404.23       
 Wife           39.69                  47409213397508.31  176586.67       
2023-05-20 13:20:20,064 - main.py[line:569] - INFO: relative error:
                 avg(a_age)  avg(a_fnlwgt)  avg(a_hours_per_week)  sum(a_age)  \
a_relationship                                                                  
 Husband        0.00        0.07           0.03                   0.00          
 Not-in-family  0.06        0.13           0.05                   0.06          
 Other-relative 0.05        0.10           0.04                   0.08          
 Own-child      0.00        0.10           0.07                   0.00          
 Unmarried      0.05        0.11           0.00                   0.05          
 Wife           0.02        0.20           0.04                   0.01          

                 sum(a_fnlwgt)  sum(a_hours_per_week)  
a_relationship                                         
 Husband        0.07           0.03                    
 Not-in-family  0.13           0.05                    
 Other-relative 0.05           0.07                    
 Own-child      0.10           0.07                    
 Unmarried      0.10           0.01                    
 Wife           0.19           0.04                    
2023-05-20 13:20:20,065 - main.py[line:570] - INFO: relative error normalized:
                 avg(a_age)  avg(a_fnlwgt)  avg(a_hours_per_week)  sum(a_age)  \
a_relationship                                                                  
 Husband        0.00        0.07           0.03                   0.00          
 Not-in-family  0.06        0.12           0.05                   0.06          
 Other-relative 0.05        0.09           0.04                   0.08          
 Own-child      0.00        0.09           0.06                   0.00          
 Unmarried      0.05        0.10           0.00                   0.05          
 Wife           0.02        0.18           0.04                   0.01          

                 sum(a_fnlwgt)  sum(a_hours_per_week)  
a_relationship                                         
 Husband        0.07           0.03                    
 Not-in-family  0.12           0.05                    
 Other-relative 0.05           0.07                    
 Own-child      0.09           0.06                    
 Unmarried      0.10           0.00                    
 Wife           0.17           0.04                    
2023-05-20 13:20:20,065 - main.py[line:573] - INFO: relative error average: 0.062153447809088935
2023-05-20 13:20:20,065 - main.py[line:574] - INFO: relative error normalized average: 0.05920008566128613
2023-05-20 13:20:20,068 - main.py[line:620] - INFO: total_time:27.385176341049373
feature_names: ['a_education_num_0', 'a_education_num_1', 'a_education_num_2', 'a_education_num_3', 'a_education_num_4', 'a_relationship_0', 'a_relationship_1', 'a_relationship_2', 'a_relationship_3']
feature_names: ['a_education_num-a_relationship_0', 'a_education_num-a_relationship_1', 'a_education_num-a_relationship_2', 'a_education_num-a_relationship_3', 'a_education_num-a_relationship_4', 'a_education_num-a_relationship_5', 'a_education_num-a_relationship_6', 'a_education_num-a_relationship_7']
