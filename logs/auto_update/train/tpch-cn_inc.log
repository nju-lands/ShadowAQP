main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-05-21 06:14:05,056 - main.py[line:601] - INFO: load query config config/query/customer_inc_join_nation.json successfully
2023-05-21 06:14:05,056 - main.py[line:608] - INFO: load train config ./config/train/tpch_customer_torch_cvae_inc.json successfully
2023-05-21 06:14:05,056 - main.py[line:608] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2023-05-21 06:14:05,056 - dataset_utils.py[line:565] - INFO: load existing dataset:tpch-20g-customer-inc_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2023-05-21 06:14:08,495 - dataset_utils.py[line:200] - INFO: encode incremental data categorical columns time elapsed:0.1070085980463773
2023-05-21 06:14:27,027 - dataset_utils.py[line:217] - INFO: encode incremental data numeric columnstime elapsed:18.531657323939726
2023-05-21 06:14:27,892 - dataset_utils.py[line:275] - INFO: load incremental data time elapsed:19.66552128701005
2023-05-21 06:14:27,899 - dataset_utils.py[line:577] - INFO: load dataset time elapsed:22.84250417095609
2023-05-21 06:14:27,899 - pytorch_cvae.py[line:300] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2023-05-21 06:14:27,900 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-20g-customer-inc_c_nationkey_ld50_id100_bs1024_ep150_0_binary_gaussian5
2023-05-21 06:14:27,902 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0018949790392071009
2023-05-21 06:14:27,902 - pytorch_cvae.py[line:311] - INFO: load model time elapsed:22.84580576699227
2023-05-21 06:14:38,269 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-05-21 06:14:38,269 - pytorch_cvae.py[line:177] - INFO: loss:59.09150621294975, numeric_loss:18.005485019646585, categorical_loss:18.33781452558469, kld_loss:4220.166437268257, epoch_train_time:10.366152238915674
2023-05-21 06:14:48,111 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.2 epoch----------------------------
2023-05-21 06:14:48,111 - pytorch_cvae.py[line:177] - INFO: loss:28.46380054578185, numeric_loss:3.665167450439185, categorical_loss:1.0599374550802168, kld_loss:3986.823268890381, epoch_train_time:9.842244783998467
2023-05-21 06:14:57,858 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.3 epoch----------------------------
2023-05-21 06:14:57,858 - pytorch_cvae.py[line:177] - INFO: loss:29.290778022259474, numeric_loss:3.6037755897268653, categorical_loss:0.9626860838616267, kld_loss:3762.8456387519836, epoch_train_time:9.74662867106963
2023-05-21 06:15:07,645 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.4 epoch----------------------------
2023-05-21 06:15:07,645 - pytorch_cvae.py[line:177] - INFO: loss:30.983245864510536, numeric_loss:3.8129474367015064, categorical_loss:0.9912849612737773, kld_loss:3614.1126070022583, epoch_train_time:9.787104276940227
2023-05-21 06:15:17,232 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.5 epoch----------------------------
2023-05-21 06:15:17,233 - pytorch_cvae.py[line:177] - INFO: loss:33.00641421973705, numeric_loss:3.989522325107828, categorical_loss:1.0406047402066179, kld_loss:3506.94588470459, epoch_train_time:9.587180067086592
2023-05-21 06:15:27,018 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.6 epoch----------------------------
2023-05-21 06:15:27,019 - pytorch_cvae.py[line:177] - INFO: loss:35.498578280210495, numeric_loss:4.25405597826466, categorical_loss:1.1380062648822786, kld_loss:3430.2388155460358, epoch_train_time:9.785884207929485
2023-05-21 06:15:36,959 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.7 epoch----------------------------
2023-05-21 06:15:36,959 - pytorch_cvae.py[line:177] - INFO: loss:38.07419411838055, numeric_loss:4.6076940931379795, categorical_loss:1.192718265883741, kld_loss:3345.5914011001587, epoch_train_time:9.940637211082503
2023-05-21 06:15:46,549 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.8 epoch----------------------------
2023-05-21 06:15:46,549 - pytorch_cvae.py[line:177] - INFO: loss:41.10038188099861, numeric_loss:5.020851910114288, categorical_loss:1.3142942715930985, kld_loss:3282.174642562866, epoch_train_time:9.589186288998462
2023-05-21 06:15:56,370 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.9 epoch----------------------------
2023-05-21 06:15:56,370 - pytorch_cvae.py[line:177] - INFO: loss:44.265443082898855, numeric_loss:5.481654429342598, categorical_loss:1.3767144118319266, kld_loss:3219.5710780620575, epoch_train_time:9.82133944099769
2023-05-21 06:16:06,135 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.10 epoch----------------------------
2023-05-21 06:16:06,135 - pytorch_cvae.py[line:177] - INFO: loss:47.769659243524075, numeric_loss:5.9684659242630005, categorical_loss:1.5775586122472305, kld_loss:3159.276464700699, epoch_train_time:9.764276320929639
2023-05-21 06:16:15,818 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.11 epoch----------------------------
2023-05-21 06:16:15,818 - pytorch_cvae.py[line:177] - INFO: loss:51.31546652317047, numeric_loss:6.502760775852948, categorical_loss:1.648219984723255, kld_loss:3096.914618730545, epoch_train_time:9.68347750895191
2023-05-21 06:16:25,766 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.12 epoch----------------------------
2023-05-21 06:16:25,766 - pytorch_cvae.py[line:177] - INFO: loss:55.261825401335955, numeric_loss:7.075951439328492, categorical_loss:1.7929156902246177, kld_loss:3043.5845770835876, epoch_train_time:9.94781173800584
2023-05-21 06:16:35,393 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.13 epoch----------------------------
2023-05-21 06:16:35,393 - pytorch_cvae.py[line:177] - INFO: loss:59.40021248906851, numeric_loss:7.658245376776904, categorical_loss:2.0233389983332017, kld_loss:2985.5021634101868, epoch_train_time:9.626157449907623
2023-05-21 06:16:45,243 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.14 epoch----------------------------
2023-05-21 06:16:45,244 - pytorch_cvae.py[line:177] - INFO: loss:63.79689808934927, numeric_loss:8.254088499583304, categorical_loss:2.233860636682948, kld_loss:2932.90238904953, epoch_train_time:9.850806334987283
2023-05-21 06:16:55,051 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.15 epoch----------------------------
2023-05-21 06:16:55,051 - pytorch_cvae.py[line:177] - INFO: loss:68.35389421880245, numeric_loss:8.891360185109079, categorical_loss:2.3898620652616955, kld_loss:2879.7794494628906, epoch_train_time:9.807534610969014
2023-05-21 06:17:04,979 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.16 epoch----------------------------
2023-05-21 06:17:04,979 - pytorch_cvae.py[line:177] - INFO: loss:73.49562687426805, numeric_loss:9.48498451989144, categorical_loss:2.604852362332167, kld_loss:2844.5145823955536, epoch_train_time:9.927960250061005
2023-05-21 06:17:14,653 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.17 epoch----------------------------
2023-05-21 06:17:14,653 - pytorch_cvae.py[line:177] - INFO: loss:78.73163510113955, numeric_loss:9.987159308046103, categorical_loss:2.8911181252624374, kld_loss:2803.3600766658783, epoch_train_time:9.673029871075414
2023-05-21 06:17:24,525 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.18 epoch----------------------------
2023-05-21 06:17:24,525 - pytorch_cvae.py[line:177] - INFO: loss:84.53859648108482, numeric_loss:10.597159938886762, categorical_loss:3.2807636513607576, kld_loss:2767.0380420684814, epoch_train_time:9.87210962199606
2023-05-21 06:17:34,321 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.19 epoch----------------------------
2023-05-21 06:17:34,322 - pytorch_cvae.py[line:177] - INFO: loss:90.40914617478848, numeric_loss:11.171752715483308, categorical_loss:3.5743696859572083, kld_loss:2728.2976019382477, epoch_train_time:9.796471316018142
2023-05-21 06:17:44,034 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.20 epoch----------------------------
2023-05-21 06:17:44,034 - pytorch_cvae.py[line:177] - INFO: loss:96.64836636185646, numeric_loss:11.83526015188545, categorical_loss:3.8788312218966894, kld_loss:2689.958197593689, epoch_train_time:9.712461231974885
2023-05-21 06:17:44,034 - pytorch_cvae.py[line:186] - INFO: training time elapsed:196.13234270806424
2023-05-21 06:17:44,035 - model_utils.py[line:67] - INFO: save model successfully
2023-05-21 06:17:55,492 - dataset_utils.py[line:584] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2023-05-21 06:17:55,494 - dataset_utils.py[line:593] - INFO: load dataset(light) time elapsed:0.0020191959338262677
2023-05-21 06:17:55,494 - pytorch_cvae.py[line:280] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2023-05-21 06:17:55,495 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2023-05-21 06:17:55,497 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.00201292906422168
2023-05-21 06:17:55,497 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.005067973048426211
2023-05-21 06:17:55,497 - main.py[line:541] - INFO: multi_sampling No.0 epoch
2023-05-21 06:17:55,544 - pytorch_cvae.py[line:407] - INFO: sampling time:0.04658077494241297
2023-05-21 06:17:55,544 - dataset_utils.py[line:565] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2023-05-21 06:17:55,546 - dataset_utils.py[line:577] - INFO: load dataset time elapsed:0.0018820289988070726
2023-05-21 06:17:55,560 - main.py[line:525] - INFO: sample and aggregation time elapsed:0.06282192002981901
2023-05-21 06:17:55,562 - main.py[line:558] - INFO: sample time: 0.06490824709180743
2023-05-21 06:25:07,326 - main.py[line:101] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4287.25         666753195.08   
ARGENTINA      4597.07         716264266.03   
BRAZIL         4325.73         674199260.16   
CANADA         4593.57         714924107.37   
CHINA          4602.54         717986551.78   
EGYPT          4841.64         754889180.78   
ETHIOPIA       4328.94         678011894.91   
FRANCE         4482.77         701611756.58   
GERMANY        4058.01         634259403.89   
INDIA          4697.81         735992191.08   
INDONESIA      4985.76         780699856.57   
IRAN           4048.73         633990236.61   
IRAQ           4705.91         734785021.51   
JAPAN          4655.79         723282100.29   
JORDAN         4174.58         647857647.14   
KENYA          4563.91         708235913.32   
MOROCCO        4341.36         676292989.54   
MOZAMBIQUE     5005.75         777638076.79   
PERU           4800.38         748744180.99   
ROMANIA        4376.71         682451194.62   
RUSSIA         4761.21         742605501.97   
SAUDI ARABIA   4210.76         657182085.02   
UNITED KINGDOM 4541.10         712307708.27   
UNITED STATES  4458.73         696458808.98   
VIETNAM        4088.39         637740134.78   
2023-05-21 06:25:07,329 - main.py[line:102] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4497.45         699444173.29   
ARGENTINA      4486.94         699106008.33   
BRAZIL         4502.65         701773384.16   
CANADA         4499.32         700256734.44   
CHINA          4491.27         700629814.31   
EGYPT          4496.39         701059444.40   
ETHIOPIA       4499.89         704785653.13   
FRANCE         4493.15         703235862.49   
GERMANY        4489.33         701673966.77   
INDIA          4507.72         706211190.60   
INDONESIA      4498.74         704439111.14   
IRAN           4507.57         705840896.67   
IRAQ           4509.27         704081769.17   
JAPAN          4493.66         698094511.41   
JORDAN         4504.65         699080891.27   
KENYA          4499.24         698201348.30   
MOROCCO        4499.58         700940690.68   
MOZAMBIQUE     4507.23         700194448.01   
PERU           4490.77         700452753.83   
ROMANIA        4487.90         699789990.15   
RUSSIA         4518.25         704711627.29   
SAUDI ARABIA   4508.93         703718011.11   
UNITED KINGDOM 4491.37         704507986.21   
UNITED STATES  4505.47         703758434.40   
VIETNAM        4497.59         701569658.84   
2023-05-21 06:25:07,335 - main.py[line:570] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.05            0.05           
ARGENTINA      0.02            0.02           
BRAZIL         0.04            0.04           
CANADA         0.02            0.02           
CHINA          0.02            0.02           
EGYPT          0.08            0.08           
ETHIOPIA       0.04            0.04           
FRANCE         0.00            0.00           
GERMANY        0.10            0.10           
INDIA          0.04            0.04           
INDONESIA      0.11            0.11           
IRAN           0.10            0.10           
IRAQ           0.04            0.04           
JAPAN          0.04            0.04           
JORDAN         0.07            0.07           
KENYA          0.01            0.01           
MOROCCO        0.04            0.04           
MOZAMBIQUE     0.11            0.11           
PERU           0.07            0.07           
ROMANIA        0.02            0.02           
RUSSIA         0.05            0.05           
SAUDI ARABIA   0.07            0.07           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.01            0.01           
VIETNAM        0.09            0.09           
2023-05-21 06:25:07,337 - main.py[line:571] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.05            0.05           
ARGENTINA      0.02            0.02           
BRAZIL         0.04            0.04           
CANADA         0.02            0.02           
CHINA          0.02            0.02           
EGYPT          0.07            0.07           
ETHIOPIA       0.04            0.04           
FRANCE         0.00            0.00           
GERMANY        0.09            0.09           
INDIA          0.04            0.04           
INDONESIA      0.10            0.10           
IRAN           0.10            0.10           
IRAQ           0.04            0.04           
JAPAN          0.04            0.04           
JORDAN         0.07            0.07           
KENYA          0.01            0.01           
MOROCCO        0.03            0.03           
MOZAMBIQUE     0.10            0.10           
PERU           0.07            0.07           
ROMANIA        0.02            0.02           
RUSSIA         0.05            0.05           
SAUDI ARABIA   0.06            0.06           
UNITED KINGDOM 0.01            0.01           
UNITED STATES  0.01            0.01           
VIETNAM        0.09            0.09           
2023-05-21 06:25:07,337 - main.py[line:574] - INFO: relative error average: 0.05043269103182715
2023-05-21 06:25:07,337 - main.py[line:575] - INFO: relative error normalized average: 0.0486972003430744
2023-05-21 06:25:07,342 - main.py[line:621] - INFO: total_time:4.9103705800371245

