main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-05-20 10:24:16,016 - main.py[line:600] - INFO: load query config config/query/census_inc.json successfully
2023-05-20 10:24:16,016 - main.py[line:607] - INFO: load train config ./config/train/census_a_inc_torch_cvae.json successfully
2023-05-20 10:24:16,017 - main.py[line:607] - INFO: load train config ./config/train/census_b_torch_cvae.json successfully
2023-05-20 10:24:16,017 - dataset_utils.py[line:552] - INFO: load existing dataset:census-adult-a-inc_a_education_num_a_fnlwgt#a_age#a_hours_per_week_a_education_num_binary_gaussian5_0
2023-05-20 10:24:18,243 - dataset_utils.py[line:197] - INFO: encode incremental data categorical columns time elapsed:0.0036568770883604884
2023-05-20 10:24:21,153 - dataset_utils.py[line:214] - INFO: encode incremental data numeric columnstime elapsed:2.91021456499584
2023-05-20 10:24:21,201 - dataset_utils.py[line:262] - INFO: load incremental data time elapsed:3.0178988920524716
2023-05-20 10:24:21,202 - dataset_utils.py[line:564] - INFO: load dataset time elapsed:5.18539432506077
2023-05-20 10:24:21,202 - pytorch_cvae.py[line:300] - INFO: feature info:[('a_fnlwgt', 'numerical', 6), ('a_age', 'numerical', 6), ('a_hours_per_week', 'numerical', 6), ('a_education_num', 'categorical', 5)]
2023-05-20 10:24:21,203 - model_utils.py[line:75] - INFO: load model name:torch_cvae_census-adult-a-inc_a_education_num_ld100_id100_bs512_ep150_0_binary_gaussian5
2023-05-20 10:24:21,205 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0016373649705201387
2023-05-20 10:24:21,205 - pytorch_cvae.py[line:311] - INFO: load model time elapsed:5.188446667045355
2023-05-20 10:24:22,424 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-05-20 10:24:22,424 - pytorch_cvae.py[line:177] - INFO: loss:44.449600011110306, numeric_loss:16.557654693722725, categorical_loss:23.736016174778342, kld_loss:770.9931929111481, epoch_train_time:1.2181094400584698
2023-05-20 10:24:23,192 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.2 epoch----------------------------
2023-05-20 10:24:23,192 - pytorch_cvae.py[line:177] - INFO: loss:24.020231872797012, numeric_loss:16.446174189448357, categorical_loss:1.619441306218505, kld_loss:1000.0551137924194, epoch_train_time:0.7679667250486091
2023-05-20 10:24:24,057 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.3 epoch----------------------------
2023-05-20 10:24:24,057 - pytorch_cvae.py[line:177] - INFO: loss:22.739415794610977, numeric_loss:15.294044077396393, categorical_loss:1.2363496590405703, kld_loss:944.9640922546387, epoch_train_time:0.8646895309211686
2023-05-20 10:24:24,864 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.4 epoch----------------------------
2023-05-20 10:24:24,864 - pytorch_cvae.py[line:177] - INFO: loss:17.879897117614746, numeric_loss:8.26159467920661, categorical_loss:1.214920955710113, kld_loss:1160.1188297271729, epoch_train_time:0.8071671710349619
2023-05-20 10:24:25,644 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.5 epoch----------------------------
2023-05-20 10:24:25,644 - pytorch_cvae.py[line:177] - INFO: loss:15.451926201581955, numeric_loss:4.172467403113842, categorical_loss:0.9809141787700355, kld_loss:1290.966121673584, epoch_train_time:0.7795714410021901
2023-05-20 10:24:26,487 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.6 epoch----------------------------
2023-05-20 10:24:26,487 - pytorch_cvae.py[line:177] - INFO: loss:15.235785990953445, numeric_loss:3.42351957783103, categorical_loss:0.9121488444507122, kld_loss:1241.9240407943726, epoch_train_time:0.8431897020200267
2023-05-20 10:24:27,292 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.7 epoch----------------------------
2023-05-20 10:24:27,292 - pytorch_cvae.py[line:177] - INFO: loss:15.64162340760231, numeric_loss:3.195403940975666, categorical_loss:0.9594501154497266, kld_loss:1190.7509603500366, epoch_train_time:0.8043703029397875
2023-05-20 10:24:28,057 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.8 epoch----------------------------
2023-05-20 10:24:28,057 - pytorch_cvae.py[line:177] - INFO: loss:16.243490636348724, numeric_loss:3.0683780293911695, categorical_loss:0.9944903664290905, kld_loss:1149.9685907363892, epoch_train_time:0.7651541349478066
2023-05-20 10:24:28,896 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.9 epoch----------------------------
2023-05-20 10:24:28,897 - pytorch_cvae.py[line:177] - INFO: loss:16.960004970431328, numeric_loss:2.99470448307693, categorical_loss:1.0435531423427165, kld_loss:1112.155514717102, epoch_train_time:0.8391064939787611
2023-05-20 10:24:29,695 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.10 epoch----------------------------
2023-05-20 10:24:29,695 - pytorch_cvae.py[line:177] - INFO: loss:17.86293824017048, numeric_loss:3.007262509316206, categorical_loss:1.0781323304399848, kld_loss:1082.1266889572144, epoch_train_time:0.7986239589517936
2023-05-20 10:24:30,490 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.11 epoch----------------------------
2023-05-20 10:24:30,490 - pytorch_cvae.py[line:177] - INFO: loss:18.79553285241127, numeric_loss:3.0589215643703938, categorical_loss:1.1814217460341752, kld_loss:1044.2885732650757, epoch_train_time:0.79414687899407
2023-05-20 10:24:31,391 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.12 epoch----------------------------
2023-05-20 10:24:31,391 - pytorch_cvae.py[line:177] - INFO: loss:19.99010907113552, numeric_loss:3.2120284251868725, categorical_loss:1.2331387191079557, kld_loss:1019.8173866271973, epoch_train_time:0.901212353957817
2023-05-20 10:24:32,240 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.13 epoch----------------------------
2023-05-20 10:24:32,240 - pytorch_cvae.py[line:177] - INFO: loss:21.233191668987274, numeric_loss:3.277831833809614, categorical_loss:1.3314662845805287, kld_loss:998.2308835983276, epoch_train_time:0.848298470955342
2023-05-20 10:24:33,060 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.14 epoch----------------------------
2023-05-20 10:24:33,060 - pytorch_cvae.py[line:177] - INFO: loss:22.588036224246025, numeric_loss:3.4878338873386383, categorical_loss:1.4209744385443628, kld_loss:972.659384727478, epoch_train_time:0.8200494589982554
2023-05-20 10:24:33,826 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.15 epoch----------------------------
2023-05-20 10:24:33,826 - pytorch_cvae.py[line:177] - INFO: loss:23.862699419260025, numeric_loss:3.6598618067801, categorical_loss:1.4303298639133573, kld_loss:947.225359916687, epoch_train_time:0.7658756689634174
2023-05-20 10:24:34,746 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.16 epoch----------------------------
2023-05-20 10:24:34,747 - pytorch_cvae.py[line:177] - INFO: loss:25.41813811659813, numeric_loss:3.8153625540435314, categorical_loss:1.6013496750965714, kld_loss:926.5306692123413, epoch_train_time:0.9203926309710369
2023-05-20 10:24:35,514 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.17 epoch----------------------------
2023-05-20 10:24:35,514 - pytorch_cvae.py[line:177] - INFO: loss:26.9404336810112, numeric_loss:4.015818364918232, categorical_loss:1.6472966391593218, kld_loss:905.7698488235474, epoch_train_time:0.7673936150968075
2023-05-20 10:24:36,308 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.18 epoch----------------------------
2023-05-20 10:24:36,308 - pytorch_cvae.py[line:177] - INFO: loss:28.597996711730957, numeric_loss:4.2953717187047005, categorical_loss:1.7330468920990825, kld_loss:883.8138513565063, epoch_train_time:0.7938645869726315
2023-05-20 10:24:37,148 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.19 epoch----------------------------
2023-05-20 10:24:37,148 - pytorch_cvae.py[line:177] - INFO: loss:30.444480150938034, numeric_loss:4.506368465721607, categorical_loss:1.9163451259955764, kld_loss:866.1896543502808, epoch_train_time:0.8395343709271401
2023-05-20 10:24:37,915 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.20 epoch----------------------------
2023-05-20 10:24:37,915 - pytorch_cvae.py[line:177] - INFO: loss:32.38187736272812, numeric_loss:4.767083238810301, categorical_loss:1.9717463376000524, kld_loss:852.2807722091675, epoch_train_time:0.7672712740022689
2023-05-20 10:24:37,915 - pytorch_cvae.py[line:186] - INFO: training time elapsed:16.710358762997203
2023-05-20 10:24:37,917 - model_utils.py[line:67] - INFO: save model successfully
2023-05-20 10:24:39,483 - dataset_utils.py[line:571] - INFO: load existing dataset(light):census-adult-b_b_education_num__b_education_num_binary_gaussian5_0
2023-05-20 10:24:39,502 - dataset_utils.py[line:580] - INFO: load dataset(light) time elapsed:0.019372617010958493
2023-05-20 10:24:39,502 - pytorch_cvae.py[line:280] - INFO: feature info:[('b_education_num', 'categorical', 5)]
2023-05-20 10:24:39,503 - model_utils.py[line:75] - INFO: load model name:torch_cvae_census-adult-b_b_education_num_ld50_id100_bs512_ep100_0_binary_gaussian5
2023-05-20 10:24:39,506 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0024901730939745903
2023-05-20 10:24:39,506 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.02318811707664281
2023-05-20 10:24:39,506 - main.py[line:540] - INFO: multi_sampling No.0 epoch
2023-05-20 10:24:39,550 - pytorch_cvae.py[line:407] - INFO: sampling time:0.0432437410345301
2023-05-20 10:24:39,550 - pytorch_cvae.py[line:427] - INFO: house sampling rate:0.5
2023-05-20 10:24:39,716 - pytorch_cvae.py[line:407] - INFO: sampling time:0.16636858496349305
2023-05-20 10:24:39,858 - main.py[line:524] - INFO: sample and aggregation time elapsed:0.352031446993351
2023-05-20 10:24:39,861 - main.py[line:557] - INFO: sample time: 0.35545913805253804
2023-05-20 10:24:39,882 - main.py[line:101] - INFO: aqp result:
                 avg(a_age)  avg(a_hours_per_week)  avg(a_fnlwgt)  \
a_education_num                                                     
1               40.37       44.50                  166657.59        
2               40.83       44.86                  241684.79        
3               41.21       37.82                  173045.43        
4               32.63       41.09                  174680.44        
5               40.35       43.11                  202370.55        
6               33.10       37.84                  172239.82        
7               40.17       40.87                  153949.38        
8               35.74       43.57                  185921.35        
9               36.74       40.16                  182021.15        
10              35.00       41.29                  172636.45        
11              39.87       40.21                  114844.11        
12              40.02       41.74                  184606.74        
13              42.18       38.20                  203625.69        
14              37.03       41.51                  180121.32        
15              39.56       39.98                  181116.66        
16              40.00       35.02                  131014.60        

                     sum(a_age)  sum(a_hours_per_week)      sum(a_fnlwgt)  
a_education_num                                                            
1               2686831.31      2962013.54             11092294168.74      
2               30929696.76     33981522.28            183083743054.82     
3               127776666.34    117254503.83           536564680303.24     
4               378441237.50    476532650.35           2025887995413.20    
5               278339671.06    297406635.68           1395992855150.83    
6               758739732.83    867470925.71           3948320385766.34    
7               1536593390.25   1563115812.69          5888600679304.35    
8               172385363.18    210122756.02           896633427595.69     
9               108829297870.09 118953350555.60        539109405413438.12  
10              51205719866.12  60409522217.00         252584582842738.06  
11              2020719135.67   2037771977.67          5820209916285.31    
12              1229862964.54   1282889748.94          5673856181768.89    
13              32696638386.45  29607873205.23         157845092700300.53  
14              2906787530.74   3258741667.86          14139143706289.65   
15              351366348.03    355125791.16           1608713320830.65    
16              187345873.52    164003641.54           613599465928.94     
2023-05-20 10:24:39,885 - main.py[line:102] - INFO: ground truth:
                   sum(a_age)  avg(a_age)  sum(a_hours_per_week)  \
a_education_num                                                    
1                2637504      38.82       2727495.59               
10               57556415008  38.54       59053867922.31           
11               1982357756   38.32       2057072739.81            
12               1218116991   38.82       1248073150.28            
13               30598343793  38.67       31299501361.05           
14               3098929305   38.67       3166962332.76            
15               350571872    38.66       358838457.12             
16               184024404    38.49       189778350.61             
2                30010404     38.81       30592894.47              
3                123470856    39.01       126133749.28             
4                456110580    38.53       468609967.31             
5                271986385    38.62       277378764.07             
6                896142720    38.30       919618444.44             
7                1510187840   38.68       1552999177.59            
8                189147511    38.42       193514720.43             
9                116668818475 38.59       119412526440.60          

                 avg(a_hours_per_week)      sum(a_fnlwgt)  avg(a_fnlwgt)  
a_education_num                                                           
1               40.14                  11999595953.25     176610.09       
10              39.54                  266042087650776.84 178123.47       
11              39.76                  9138980956520.30   176649.75       
12              39.78                  5573245311048.09   177632.55       
13              39.55                  139873708508646.88 176759.49       
14              39.52                  14179641688885.13  176950.76       
15              39.58                  1612149254804.62   177799.34       
16              39.69                  848622391194.36    177498.37       
2               39.56                  135500878151.77    175221.26       
3               39.85                  556650681468.56    175859.55       
4               39.58                  2108798458595.26   178118.52       
5               39.39                  1248910096007.05   177353.78       
6               39.30                  4099485262823.16   175184.49       
7               39.77                  6826577479733.92   174829.22       
8               39.31                  865017206651.94    175705.05       
9               39.49                  535274241465035.69 177037.98       
2023-05-20 10:24:39,896 - main.py[line:569] - INFO: relative error:
                 avg(a_age)  avg(a_fnlwgt)  avg(a_hours_per_week)  sum(a_age)  \
a_education_num                                                                 
1               0.04        0.06           0.11                   0.02          
2               0.05        0.38           0.13                   0.03          
3               0.06        0.02           0.05                   0.03          
4               0.15        0.02           0.04                   0.17          
5               0.04        0.14           0.09                   0.02          
6               0.14        0.02           0.04                   0.15          
7               0.04        0.12           0.03                   0.02          
8               0.07        0.06           0.11                   0.09          
9               0.05        0.03           0.02                   0.07          
10              0.09        0.03           0.04                   0.11          
11              0.04        0.35           0.01                   0.02          
12              0.03        0.04           0.05                   0.01          
13              0.09        0.15           0.03                   0.07          
14              0.04        0.02           0.05                   0.06          
15              0.02        0.02           0.01                   0.00          
16              0.04        0.26           0.12                   0.02          

                 sum(a_fnlwgt)  sum(a_hours_per_week)  
a_education_num                                        
1               0.08           0.09                    
2               0.35           0.11                    
3               0.04           0.07                    
4               0.04           0.02                    
5               0.12           0.07                    
6               0.04           0.06                    
7               0.14           0.01                    
8               0.04           0.09                    
9               0.01           0.00                    
10              0.05           0.02                    
11              0.36           0.01                    
12              0.02           0.03                    
13              0.13           0.05                    
14              0.00           0.03                    
15              0.00           0.01                    
16              0.28           0.14                    
2023-05-20 10:24:39,897 - main.py[line:570] - INFO: relative error normalized:
                 avg(a_age)  avg(a_fnlwgt)  avg(a_hours_per_week)  sum(a_age)  \
a_education_num                                                                 
1               0.04        0.05           0.10                   0.02          
2               0.05        0.32           0.13                   0.03          
3               0.05        0.02           0.05                   0.03          
4               0.14        0.02           0.04                   0.16          
5               0.04        0.13           0.09                   0.02          
6               0.13        0.02           0.04                   0.14          
7               0.04        0.11           0.03                   0.02          
8               0.07        0.06           0.10                   0.08          
9               0.05        0.03           0.02                   0.06          
10              0.09        0.03           0.04                   0.10          
11              0.04        0.30           0.01                   0.02          
12              0.03        0.04           0.05                   0.01          
13              0.09        0.14           0.03                   0.07          
14              0.04        0.02           0.05                   0.06          
15              0.02        0.02           0.01                   0.00          
16              0.04        0.23           0.11                   0.02          

                 sum(a_fnlwgt)  sum(a_hours_per_week)  
a_education_num                                        
1               0.07           0.08                    
2               0.30           0.10                    
3               0.04           0.07                    
4               0.04           0.02                    
5               0.11           0.07                    
6               0.04           0.06                    
7               0.13           0.01                    
8               0.04           0.08                    
9               0.01           0.00                    
10              0.05           0.02                    
11              0.30           0.01                    
12              0.02           0.03                    
13              0.12           0.05                    
14              0.00           0.03                    
15              0.00           0.01                    
16              0.24           0.13                    
2023-05-20 10:24:39,897 - main.py[line:573] - INFO: relative error average: 0.07300799855895662
2023-05-20 10:24:39,898 - main.py[line:574] - INFO: relative error normalized average: 0.0676473253328389
2023-05-20 10:24:39,898 - main.py[line:620] - INFO: total_time:23.88170472404454
label group counts before:{9: 48161, 10: 33952, 13: 24681, 14: 7867, 11: 6313, 7: 5488, 12: 4927, 6: 4224, 4: 3021, 15: 2632, 5: 2321, 8: 1939, 16: 1901, 3: 1574, 2: 771, 1: 228}
label group counts after:{9: 62779, 10: 43991, 13: 32062, 14: 10186, 11: 8195, 7: 7115, 12: 6368, 6: 5540, 4: 3919, 15: 3445, 5: 3034, 8: 2539, 16: 2515, 3: 2011, 2: 1003, 1: 298}
feature_names: ['a_education_num_0', 'a_education_num_1', 'a_education_num_2', 'a_education_num_3', 'a_education_num_4']
