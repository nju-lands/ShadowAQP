main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-05-20 10:26:28,150 - main.py[line:600] - INFO: load query config config/query/census_inc.json successfully
2023-05-20 10:26:28,150 - main.py[line:607] - INFO: load train config ./config/train/census_a_inc_torch_cvae.json successfully
2023-05-20 10:26:28,150 - main.py[line:607] - INFO: load train config ./config/train/census_b_torch_cvae.json successfully
2023-05-20 10:26:28,150 - dataset_utils.py[line:552] - INFO: load existing dataset:census-adult-a-inc_a_education_num_a_fnlwgt#a_age#a_hours_per_week_a_education_num_binary_gaussian5_0
2023-05-20 10:26:30,370 - dataset_utils.py[line:197] - INFO: encode incremental data categorical columns time elapsed:0.0037081189220771194
2023-05-20 10:26:33,168 - dataset_utils.py[line:214] - INFO: encode incremental data numeric columnstime elapsed:2.7981969319516793
2023-05-20 10:26:33,217 - dataset_utils.py[line:262] - INFO: load incremental data time elapsed:2.906638965010643
2023-05-20 10:26:33,218 - dataset_utils.py[line:564] - INFO: load dataset time elapsed:5.067198123084381
2023-05-20 10:26:33,218 - pytorch_cvae.py[line:300] - INFO: feature info:[('a_fnlwgt', 'numerical', 6), ('a_age', 'numerical', 6), ('a_hours_per_week', 'numerical', 6), ('a_education_num', 'categorical', 5)]
2023-05-20 10:26:33,219 - model_utils.py[line:75] - INFO: load model name:torch_cvae_census-adult-a-inc_a_education_num_ld100_id100_bs512_ep150_0_binary_gaussian5
2023-05-20 10:26:33,221 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.001665972056798637
2023-05-20 10:26:33,221 - pytorch_cvae.py[line:311] - INFO: load model time elapsed:5.070282469969243
2023-05-20 10:26:34,422 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-05-20 10:26:34,422 - pytorch_cvae.py[line:177] - INFO: loss:40.948708802461624, numeric_loss:14.619805589318275, categorical_loss:22.874462289735675, kld_loss:640.8555812835693, epoch_train_time:1.2003921460127458
2023-05-20 10:26:35,126 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.2 epoch----------------------------
2023-05-20 10:26:35,126 - pytorch_cvae.py[line:177] - INFO: loss:21.342094659805298, numeric_loss:14.54186399281025, categorical_loss:1.5625944063067436, kld_loss:879.6410303115845, epoch_train_time:0.7036751960404217
2023-05-20 10:26:35,910 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.3 epoch----------------------------
2023-05-20 10:26:35,910 - pytorch_cvae.py[line:177] - INFO: loss:20.667844355106354, numeric_loss:14.160923421382904, categorical_loss:1.1428317949175835, kld_loss:816.3720035552979, epoch_train_time:0.7841252859216183
2023-05-20 10:26:36,612 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.4 epoch----------------------------
2023-05-20 10:26:36,612 - pytorch_cvae.py[line:177] - INFO: loss:18.347351625561714, numeric_loss:10.853317514061928, categorical_loss:1.1003649504855275, kld_loss:882.6704149246216, epoch_train_time:0.7018116019899026
2023-05-20 10:26:37,289 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.5 epoch----------------------------
2023-05-20 10:26:37,289 - pytorch_cvae.py[line:177] - INFO: loss:14.71818183362484, numeric_loss:5.039250615984201, categorical_loss:0.9799231477081776, kld_loss:1090.457444190979, epoch_train_time:0.6766287190839648
2023-05-20 10:26:37,964 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.6 epoch----------------------------
2023-05-20 10:26:37,964 - pytorch_cvae.py[line:177] - INFO: loss:14.002336502075195, numeric_loss:3.5906982347369194, categorical_loss:0.8633384509012103, kld_loss:1087.9023141860962, epoch_train_time:0.6752586489310488
2023-05-20 10:26:38,637 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.7 epoch----------------------------
2023-05-20 10:26:38,637 - pytorch_cvae.py[line:177] - INFO: loss:14.216614723205566, numeric_loss:3.253648206591606, categorical_loss:0.8260345533490181, kld_loss:1050.8230085372925, epoch_train_time:0.6725572330178693
2023-05-20 10:26:39,383 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.8 epoch----------------------------
2023-05-20 10:26:39,383 - pytorch_cvae.py[line:177] - INFO: loss:14.666904240846634, numeric_loss:3.0917582884430885, categorical_loss:0.8836501589976251, kld_loss:1009.3806447982788, epoch_train_time:0.746033082017675
2023-05-20 10:26:40,060 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.9 epoch----------------------------
2023-05-20 10:26:40,061 - pytorch_cvae.py[line:177] - INFO: loss:15.391861766576767, numeric_loss:3.0236244313418865, categorical_loss:0.9431291832588613, kld_loss:983.3420171737671, epoch_train_time:0.6770507280016318
2023-05-20 10:26:40,756 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.10 epoch----------------------------
2023-05-20 10:26:40,756 - pytorch_cvae.py[line:177] - INFO: loss:16.13292947411537, numeric_loss:2.990479975938797, categorical_loss:0.9969009277410805, kld_loss:953.9452686309814, epoch_train_time:0.6949920910410583
2023-05-20 10:26:41,506 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.11 epoch----------------------------
2023-05-20 10:26:41,506 - pytorch_cvae.py[line:177] - INFO: loss:17.056855514645576, numeric_loss:3.0074823275208473, categorical_loss:1.0823511313647032, kld_loss:930.342604637146, epoch_train_time:0.7501657230313867
2023-05-20 10:26:42,206 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.12 epoch----------------------------
2023-05-20 10:26:42,206 - pytorch_cvae.py[line:177] - INFO: loss:18.091341987252235, numeric_loss:3.1017619520425797, categorical_loss:1.1244205627590418, kld_loss:909.6161813735962, epoch_train_time:0.6993543499847874
2023-05-20 10:26:42,904 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.13 epoch----------------------------
2023-05-20 10:26:42,904 - pytorch_cvae.py[line:177] - INFO: loss:19.154889151453972, numeric_loss:3.2083700001239777, categorical_loss:1.2169905356131494, kld_loss:884.4781360626221, epoch_train_time:0.6978146900655702
2023-05-20 10:26:43,584 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.14 epoch----------------------------
2023-05-20 10:26:43,584 - pytorch_cvae.py[line:177] - INFO: loss:20.35550120472908, numeric_loss:3.340673800557852, categorical_loss:1.277604004368186, kld_loss:865.8159856796265, epoch_train_time:0.6802796990377828
2023-05-20 10:26:44,258 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.15 epoch----------------------------
2023-05-20 10:26:44,258 - pytorch_cvae.py[line:177] - INFO: loss:21.696516573429108, numeric_loss:3.5110249146819115, categorical_loss:1.3972734634298831, kld_loss:847.101842880249, epoch_train_time:0.6739470079774037
2023-05-20 10:26:45,006 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.16 epoch----------------------------
2023-05-20 10:26:45,006 - pytorch_cvae.py[line:177] - INFO: loss:23.076923102140427, numeric_loss:3.7453968450427055, categorical_loss:1.4917399501428008, kld_loss:826.3965444564819, epoch_train_time:0.7478733320022002
2023-05-20 10:26:45,724 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.17 epoch----------------------------
2023-05-20 10:26:45,724 - pytorch_cvae.py[line:177] - INFO: loss:24.504897445440292, numeric_loss:3.964706066995859, categorical_loss:1.5740186562761664, kld_loss:807.3849754333496, epoch_train_time:0.7177670510718599
2023-05-20 10:26:46,406 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.18 epoch----------------------------
2023-05-20 10:26:46,406 - pytorch_cvae.py[line:177] - INFO: loss:25.955418676137924, numeric_loss:4.280994024127722, categorical_loss:1.6802529292181134, kld_loss:782.9621725082397, epoch_train_time:0.6815671100048348
2023-05-20 10:26:47,166 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.19 epoch----------------------------
2023-05-20 10:26:47,166 - pytorch_cvae.py[line:177] - INFO: loss:27.62760117650032, numeric_loss:4.5090937949717045, categorical_loss:1.8303995742462575, kld_loss:767.6179256439209, epoch_train_time:0.7596555500058457
2023-05-20 10:26:47,843 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.20 epoch----------------------------
2023-05-20 10:26:47,843 - pytorch_cvae.py[line:177] - INFO: loss:29.329506427049637, numeric_loss:4.709073409438133, categorical_loss:1.9189580953679979, kld_loss:754.5136890411377, epoch_train_time:0.6767022419953719
2023-05-20 10:26:47,843 - pytorch_cvae.py[line:186] - INFO: training time elapsed:14.621967753977515
2023-05-20 10:26:47,844 - model_utils.py[line:67] - INFO: save model successfully
2023-05-20 10:26:49,432 - dataset_utils.py[line:571] - INFO: load existing dataset(light):census-adult-b_b_education_num__b_education_num_binary_gaussian5_0
2023-05-20 10:26:49,778 - dataset_utils.py[line:580] - INFO: load dataset(light) time elapsed:0.34570476796943694
2023-05-20 10:26:49,778 - pytorch_cvae.py[line:280] - INFO: feature info:[('b_education_num', 'categorical', 5)]
2023-05-20 10:26:49,780 - model_utils.py[line:75] - INFO: load model name:torch_cvae_census-adult-b_b_education_num_ld50_id100_bs512_ep100_0_binary_gaussian5
2023-05-20 10:26:49,783 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0029932669131085277
2023-05-20 10:26:49,783 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.3507399120135233
2023-05-20 10:26:49,783 - main.py[line:540] - INFO: multi_sampling No.0 epoch
2023-05-20 10:26:49,827 - pytorch_cvae.py[line:407] - INFO: sampling time:0.04299701692070812
2023-05-20 10:26:49,827 - pytorch_cvae.py[line:427] - INFO: house sampling rate:0.5
2023-05-20 10:26:49,992 - pytorch_cvae.py[line:407] - INFO: sampling time:0.1650402930099517
2023-05-20 10:26:50,136 - main.py[line:524] - INFO: sample and aggregation time elapsed:0.35243201593402773
2023-05-20 10:26:50,139 - main.py[line:557] - INFO: sample time: 0.35620446293614805
2023-05-20 10:26:50,160 - main.py[line:101] - INFO: aqp result:
                 avg(a_age)  avg(a_hours_per_week)  avg(a_fnlwgt)  \
a_education_num                                                     
1               41.66       40.13                  151585.20        
2               38.84       37.46                  200332.68        
3               43.15       34.54                  179267.20        
4               37.69       41.69                  221430.10        
5               38.23       40.81                  144116.56        
6               38.68       42.22                  181647.92        
7               38.23       39.78                  152789.75        
8               35.94       36.55                  208009.32        
9               44.28       38.85                  198383.15        
10              35.64       42.34                  134164.19        
11              41.10       39.09                  146855.20        
12              38.47       41.90                  172317.94        
13              37.07       38.86                  142310.14        
14              45.80       40.34                  172517.37        
15              40.57       38.64                  212607.69        
16              43.56       40.97                  178580.64        

                     sum(a_age)  sum(a_hours_per_week)      sum(a_fnlwgt)  
a_education_num                                                            
1               2773087.78      2671046.39             10089114703.53      
2               29420255.36     28380072.94            151758237928.40     
3               133804902.96    107111857.08           555856643932.78     
4               437157719.79    483485481.37           2568075531723.05    
5               263726581.70    281484654.32           994145058872.27     
6               886704878.13    967895673.67           4163986046441.03    
7               1462462216.42   1521547378.36          5844244589629.61    
8               173345798.85    176261991.98           1003155990848.66    
9               131135115165.99 115076487602.46        587570295455921.62  
10              52147116078.38  61951366799.38         196295777978557.34  
11              2083031094.41   1981174264.85          7442506499070.56    
12              1182230609.12   1287703757.86          5296162093499.12    
13              28731876534.64  30119385354.54         110314951633880.86  
14              3594943372.37   3166748546.64          13542249595492.86   
15              360325809.54    343190460.37           1888422773950.92    
16              204001511.91    191895164.65           836372298233.56     
2023-05-20 10:26:50,162 - main.py[line:102] - INFO: ground truth:
                   sum(a_age)  avg(a_age)  sum(a_hours_per_week)  \
a_education_num                                                    
1                2637504      38.82       2727495.59               
10               57556415008  38.54       59053867922.31           
11               1982357756   38.32       2057072739.81            
12               1218116991   38.82       1248073150.28            
13               30598343793  38.67       31299501361.05           
14               3098929305   38.67       3166962332.76            
15               350571872    38.66       358838457.12             
16               184024404    38.49       189778350.61             
2                30010404     38.81       30592894.47              
3                123470856    39.01       126133749.28             
4                456110580    38.53       468609967.31             
5                271986385    38.62       277378764.07             
6                896142720    38.30       919618444.44             
7                1510187840   38.68       1552999177.59            
8                189147511    38.42       193514720.43             
9                116668818475 38.59       119412526440.60          

                 avg(a_hours_per_week)      sum(a_fnlwgt)  avg(a_fnlwgt)  
a_education_num                                                           
1               40.14                  11999595953.25     176610.09       
10              39.54                  266042087650776.84 178123.47       
11              39.76                  9138980956520.30   176649.75       
12              39.78                  5573245311048.09   177632.55       
13              39.55                  139873708508646.88 176759.49       
14              39.52                  14179641688885.13  176950.76       
15              39.58                  1612149254804.62   177799.34       
16              39.69                  848622391194.36    177498.37       
2               39.56                  135500878151.77    175221.26       
3               39.85                  556650681468.56    175859.55       
4               39.58                  2108798458595.26   178118.52       
5               39.39                  1248910096007.05   177353.78       
6               39.30                  4099485262823.16   175184.49       
7               39.77                  6826577479733.92   174829.22       
8               39.31                  865017206651.94    175705.05       
9               39.49                  535274241465035.69 177037.98       
2023-05-20 10:26:50,173 - main.py[line:569] - INFO: relative error:
                 avg(a_age)  avg(a_fnlwgt)  avg(a_hours_per_week)  sum(a_age)  \
a_education_num                                                                 
1               0.07        0.14           0.00                   0.05          
2               0.00        0.14           0.05                   0.02          
3               0.11        0.02           0.13                   0.08          
4               0.02        0.24           0.05                   0.04          
5               0.01        0.19           0.04                   0.03          
6               0.01        0.04           0.07                   0.01          
7               0.01        0.13           0.00                   0.03          
8               0.06        0.18           0.07                   0.08          
9               0.15        0.12           0.02                   0.12          
10              0.08        0.25           0.07                   0.09          
11              0.07        0.17           0.02                   0.05          
12              0.01        0.03           0.05                   0.03          
13              0.04        0.19           0.02                   0.06          
14              0.18        0.03           0.02                   0.16          
15              0.05        0.20           0.02                   0.03          
16              0.13        0.01           0.03                   0.11          

                 sum(a_fnlwgt)  sum(a_hours_per_week)  
a_education_num                                        
1               0.16           0.02                    
2               0.12           0.07                    
3               0.00           0.15                    
4               0.22           0.03                    
5               0.20           0.01                    
6               0.02           0.05                    
7               0.14           0.02                    
8               0.16           0.09                    
9               0.10           0.04                    
10              0.26           0.05                    
11              0.19           0.04                    
12              0.05           0.03                    
13              0.21           0.04                    
14              0.04           0.00                    
15              0.17           0.04                    
16              0.01           0.01                    
2023-05-20 10:26:50,174 - main.py[line:570] - INFO: relative error normalized:
                 avg(a_age)  avg(a_fnlwgt)  avg(a_hours_per_week)  sum(a_age)  \
a_education_num                                                                 
1               0.07        0.13           0.00                   0.05          
2               0.00        0.13           0.05                   0.02          
3               0.10        0.02           0.12                   0.08          
4               0.02        0.22           0.05                   0.04          
5               0.01        0.17           0.04                   0.03          
6               0.01        0.04           0.07                   0.01          
7               0.01        0.12           0.00                   0.03          
8               0.06        0.17           0.07                   0.08          
9               0.14        0.11           0.02                   0.12          
10              0.07        0.22           0.07                   0.09          
11              0.07        0.16           0.02                   0.05          
12              0.01        0.03           0.05                   0.03          
13              0.04        0.18           0.02                   0.06          
14              0.17        0.02           0.02                   0.15          
15              0.05        0.18           0.02                   0.03          
16              0.12        0.01           0.03                   0.10          

                 sum(a_fnlwgt)  sum(a_hours_per_week)  
a_education_num                                        
1               0.15           0.02                    
2               0.11           0.07                    
3               0.00           0.14                    
4               0.20           0.03                    
5               0.18           0.01                    
6               0.02           0.05                    
7               0.13           0.02                    
8               0.15           0.09                    
9               0.09           0.04                    
10              0.23           0.05                    
11              0.17           0.04                    
12              0.05           0.03                    
13              0.19           0.04                    
14              0.04           0.00                    
15              0.16           0.04                    
16              0.01           0.01                    
2023-05-20 10:26:50,174 - main.py[line:573] - INFO: relative error average: 0.07829556420008223
2023-05-20 10:26:50,174 - main.py[line:574] - INFO: relative error normalized average: 0.07321872709992683
2023-05-20 10:26:50,175 - main.py[line:620] - INFO: total_time:22.024714600061998
label group counts before:{9: 48161, 10: 33952, 13: 24681, 14: 7867, 11: 6313, 7: 5488, 12: 4927, 6: 4224, 4: 3021, 15: 2632, 5: 2321, 8: 1939, 16: 1901, 3: 1574, 2: 771, 1: 228}
label group counts after:{9: 62779, 10: 43991, 13: 32062, 14: 10186, 11: 8195, 7: 7115, 12: 6368, 6: 5540, 4: 3919, 15: 3445, 5: 3034, 8: 2539, 16: 2515, 3: 2011, 2: 1003, 1: 298}
feature_names: ['a_education_num_0', 'a_education_num_1', 'a_education_num_2', 'a_education_num_3', 'a_education_num_4']
