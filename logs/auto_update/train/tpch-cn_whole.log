main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-05-21 07:06:28,858 - main.py[line:601] - INFO: load query config config/query/customer_inc_join_nation.json successfully
2023-05-21 07:06:28,858 - main.py[line:608] - INFO: load train config ./config/train/tpch_customer_torch_cvae_inc.json successfully
2023-05-21 07:06:28,858 - main.py[line:608] - INFO: load train config ./config/train/tpch_nation_torch_cvae.json successfully
2023-05-21 07:06:28,858 - dataset_utils.py[line:565] - INFO: load existing dataset:tpch-20g-customer-inc_c_nationkey_c_acctbal_c_nationkey_binary_gaussian5_0
2023-05-21 07:06:32,322 - dataset_utils.py[line:200] - INFO: encode incremental data categorical columns time elapsed:0.10769252304453403
2023-05-21 07:06:50,344 - dataset_utils.py[line:217] - INFO: encode incremental data numeric columnstime elapsed:18.021898329956457
2023-05-21 07:06:51,207 - dataset_utils.py[line:275] - INFO: load incremental data time elapsed:19.15513260709122
2023-05-21 07:06:51,214 - dataset_utils.py[line:577] - INFO: load dataset time elapsed:22.356158084003255
2023-05-21 07:06:51,214 - pytorch_cvae.py[line:300] - INFO: feature info:[('c_acctbal', 'numerical', 6), ('c_nationkey', 'categorical', 6)]
2023-05-21 07:06:51,215 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-20g-customer-inc_c_nationkey_ld50_id100_bs1024_ep150_0_binary_gaussian5
2023-05-21 07:06:51,217 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0019244600553065538
2023-05-21 07:06:51,217 - pytorch_cvae.py[line:311] - INFO: load model time elapsed:22.359490906004794
2023-05-21 07:07:25,495 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-05-21 07:07:25,496 - pytorch_cvae.py[line:177] - INFO: loss:121.55158356390893, numeric_loss:26.1996694218833, categorical_loss:20.719850128516555, kld_loss:13845.475246429443, epoch_train_time:34.27760848402977
2023-05-21 07:07:59,229 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.2 epoch----------------------------
2023-05-21 07:07:59,229 - pytorch_cvae.py[line:177] - INFO: loss:91.20792337320745, numeric_loss:9.073675309307873, categorical_loss:3.659225948402309, kld_loss:13179.580276966095, epoch_train_time:33.73327763797715
2023-05-21 07:08:32,792 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.3 epoch----------------------------
2023-05-21 07:08:32,792 - pytorch_cvae.py[line:177] - INFO: loss:98.75863574817777, numeric_loss:9.983140209224075, categorical_loss:3.863863417878747, kld_loss:12922.879611492157, epoch_train_time:33.5624944861047
2023-05-21 07:09:06,468 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.4 epoch----------------------------
2023-05-21 07:09:06,469 - pytorch_cvae.py[line:177] - INFO: loss:107.31724685803056, numeric_loss:10.975285789230838, categorical_loss:4.339247818337753, kld_loss:12701.325303554535, epoch_train_time:33.6767309140414
2023-05-21 07:09:39,942 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.5 epoch----------------------------
2023-05-21 07:09:39,942 - pytorch_cvae.py[line:177] - INFO: loss:116.15194123983383, numeric_loss:12.049856518860906, categorical_loss:4.661906090463162, kld_loss:12465.246840953827, epoch_train_time:33.472961777006276
2023-05-21 07:10:13,508 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.6 epoch----------------------------
2023-05-21 07:10:13,508 - pytorch_cvae.py[line:177] - INFO: loss:125.80242715403438, numeric_loss:13.213365439325571, categorical_loss:5.069114136043936, kld_loss:12250.47418498993, epoch_train_time:33.5665231939638
2023-05-21 07:10:46,776 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.7 epoch----------------------------
2023-05-21 07:10:46,776 - pytorch_cvae.py[line:177] - INFO: loss:136.36913902312517, numeric_loss:14.477529808878899, categorical_loss:5.600216091130278, kld_loss:12055.094340801239, epoch_train_time:33.26786048896611
2023-05-21 07:11:20,411 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.8 epoch----------------------------
2023-05-21 07:11:20,411 - pytorch_cvae.py[line:177] - INFO: loss:147.38890041783452, numeric_loss:15.87020528037101, categorical_loss:6.02969469987147, kld_loss:11847.375851154327, epoch_train_time:33.633993039955385
2023-05-21 07:11:53,861 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.9 epoch----------------------------
2023-05-21 07:11:53,862 - pytorch_cvae.py[line:177] - INFO: loss:159.33976340293884, numeric_loss:17.374847256578505, categorical_loss:6.741586387259304, kld_loss:11638.470298051834, epoch_train_time:33.450653107021935
2023-05-21 07:12:27,180 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.10 epoch----------------------------
2023-05-21 07:12:27,180 - pytorch_cvae.py[line:177] - INFO: loss:172.35748395696282, numeric_loss:18.999970723409206, categorical_loss:7.4633799230796285, kld_loss:11458.93219780922, epoch_train_time:33.31834007508587
2023-05-21 07:13:00,683 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.11 epoch----------------------------
2023-05-21 07:13:00,683 - pytorch_cvae.py[line:177] - INFO: loss:185.78580628335476, numeric_loss:20.772158368024975, categorical_loss:8.074734777706908, kld_loss:11259.868059396744, epoch_train_time:33.502772153005935
2023-05-21 07:13:34,099 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.12 epoch----------------------------
2023-05-21 07:13:34,099 - pytorch_cvae.py[line:177] - INFO: loss:200.06434728205204, numeric_loss:22.69449686817825, categorical_loss:8.730563364923, kld_loss:11063.487902402878, epoch_train_time:33.41569192602765
2023-05-21 07:14:07,672 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.13 epoch----------------------------
2023-05-21 07:14:07,672 - pytorch_cvae.py[line:177] - INFO: loss:215.67584876716137, numeric_loss:24.779880905058235, categorical_loss:9.678656904317904, kld_loss:10881.72974729538, epoch_train_time:33.57277573295869
2023-05-21 07:14:41,126 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.14 epoch----------------------------
2023-05-21 07:14:41,126 - pytorch_cvae.py[line:177] - INFO: loss:232.01041986048222, numeric_loss:27.000043405685574, categorical_loss:10.64039108104771, kld_loss:10693.667850732803, epoch_train_time:33.45414280402474
2023-05-21 07:15:14,626 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.15 epoch----------------------------
2023-05-21 07:15:14,626 - pytorch_cvae.py[line:177] - INFO: loss:249.1519909799099, numeric_loss:29.44551624916494, categorical_loss:11.580714073061245, kld_loss:10501.633564710617, epoch_train_time:33.50019777810667
2023-05-21 07:15:48,183 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.16 epoch----------------------------
2023-05-21 07:15:48,184 - pytorch_cvae.py[line:177] - INFO: loss:267.80758010596037, numeric_loss:32.01439937856048, categorical_loss:12.83528713742271, kld_loss:10328.12996673584, epoch_train_time:33.55685762607027
2023-05-21 07:16:21,588 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.17 epoch----------------------------
2023-05-21 07:16:21,588 - pytorch_cvae.py[line:177] - INFO: loss:286.94549030810595, numeric_loss:34.785912045277655, categorical_loss:13.89036893643788, kld_loss:10143.057431459427, epoch_train_time:33.40475078905001
2023-05-21 07:16:55,135 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.18 epoch----------------------------
2023-05-21 07:16:55,135 - pytorch_cvae.py[line:177] - INFO: loss:307.79133927822113, numeric_loss:37.80785087309778, categorical_loss:15.495052194281016, kld_loss:9965.645034313202, epoch_train_time:33.5464329989627
2023-05-21 07:17:28,489 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.19 epoch----------------------------
2023-05-21 07:17:28,490 - pytorch_cvae.py[line:177] - INFO: loss:329.27701875567436, numeric_loss:41.02346425130963, categorical_loss:16.789560608915053, kld_loss:9788.5932700634, epoch_train_time:33.35433094098698
2023-05-21 07:18:02,218 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.20 epoch----------------------------
2023-05-21 07:18:02,218 - pytorch_cvae.py[line:177] - INFO: loss:352.1925914436579, numeric_loss:44.45682631060481, categorical_loss:18.560798510967288, kld_loss:9611.11438536644, epoch_train_time:33.727931531961076
2023-05-21 07:18:35,904 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.21 epoch----------------------------
2023-05-21 07:18:35,904 - pytorch_cvae.py[line:177] - INFO: loss:375.8372930586338, numeric_loss:48.12661462742835, categorical_loss:20.367664302815683, kld_loss:9424.876823425293, epoch_train_time:33.68605554604437
2023-05-21 07:19:09,534 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.22 epoch----------------------------
2023-05-21 07:19:09,535 - pytorch_cvae.py[line:177] - INFO: loss:400.9856095612049, numeric_loss:52.080562775954604, categorical_loss:21.973728587734513, kld_loss:9259.391531467438, epoch_train_time:33.630377650028095
2023-05-21 07:19:43,034 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.23 epoch----------------------------
2023-05-21 07:19:43,034 - pytorch_cvae.py[line:177] - INFO: loss:427.5006600469351, numeric_loss:56.27223184891045, categorical_loss:24.1791919011157, kld_loss:9087.091799020767, epoch_train_time:33.49896669201553
2023-05-21 07:20:16,688 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.24 epoch----------------------------
2023-05-21 07:20:16,688 - pytorch_cvae.py[line:177] - INFO: loss:455.4660287052393, numeric_loss:60.81378176994622, categorical_loss:26.458293801755644, kld_loss:8921.803632736206, epoch_train_time:33.65439735900145
2023-05-21 07:20:50,203 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.25 epoch----------------------------
2023-05-21 07:20:50,203 - pytorch_cvae.py[line:177] - INFO: loss:483.85768626630306, numeric_loss:65.51561729609966, categorical_loss:28.553881943924353, kld_loss:8749.458324670792, epoch_train_time:33.51420356798917
2023-05-21 07:21:23,724 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.26 epoch----------------------------
2023-05-21 07:21:23,725 - pytorch_cvae.py[line:177] - INFO: loss:513.875194683671, numeric_loss:70.65181929804385, categorical_loss:31.170006439089775, kld_loss:8576.63057589531, epoch_train_time:33.52174826501869
2023-05-21 07:21:57,363 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.27 epoch----------------------------
2023-05-21 07:21:57,363 - pytorch_cvae.py[line:177] - INFO: loss:545.16700540483, numeric_loss:76.12845947779715, categorical_loss:33.911826051189564, kld_loss:8406.671061038971, epoch_train_time:33.63870021305047
2023-05-21 07:22:30,770 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.28 epoch----------------------------
2023-05-21 07:22:30,771 - pytorch_cvae.py[line:177] - INFO: loss:578.5015501379967, numeric_loss:81.81449043378234, categorical_loss:37.14921906217933, kld_loss:8249.145250558853, epoch_train_time:33.40687678498216
2023-05-21 07:23:04,300 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.29 epoch----------------------------
2023-05-21 07:23:04,301 - pytorch_cvae.py[line:177] - INFO: loss:612.1737125068903, numeric_loss:87.99136322550476, categorical_loss:40.33340869215317, kld_loss:8078.135103940964, epoch_train_time:33.529906345997006
2023-05-21 07:23:37,990 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.30 epoch----------------------------
2023-05-21 07:23:37,990 - pytorch_cvae.py[line:177] - INFO: loss:647.6528838574886, numeric_loss:94.46279228106141, categorical_loss:44.04083701316267, kld_loss:7913.9693393707275, epoch_train_time:33.689634453039616
2023-05-21 07:23:37,990 - pytorch_cvae.py[line:186] - INFO: training time elapsed:1006.7731064340333
2023-05-21 07:23:37,992 - model_utils.py[line:67] - INFO: save model successfully
2023-05-21 07:24:05,459 - dataset_utils.py[line:584] - INFO: load existing dataset(light):tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2023-05-21 07:24:05,464 - dataset_utils.py[line:593] - INFO: load dataset(light) time elapsed:0.005104336072690785
2023-05-21 07:24:05,464 - pytorch_cvae.py[line:280] - INFO: feature info:[('n_nationkey', 'categorical', 6), ('n_name', 'categorical', 6)]
2023-05-21 07:24:05,466 - model_utils.py[line:75] - INFO: load model name:torch_cvae_tpch-35g-nation_n_nationkey_ld100_id150_bs128_ep100_0_binary_mm
2023-05-21 07:24:05,469 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0036486159078776836
2023-05-21 07:24:05,469 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.010819449089467525
2023-05-21 07:24:05,470 - main.py[line:541] - INFO: multi_sampling No.0 epoch
2023-05-21 07:24:05,522 - pytorch_cvae.py[line:407] - INFO: sampling time:0.05141516402363777
2023-05-21 07:24:05,522 - dataset_utils.py[line:565] - INFO: load existing dataset:tpch-35g-nation_n_nationkey#n_name__n_nationkey_binary_mm_0
2023-05-21 07:24:05,524 - dataset_utils.py[line:577] - INFO: load dataset time elapsed:0.001964643015526235
2023-05-21 07:24:05,539 - main.py[line:525] - INFO: sample and aggregation time elapsed:0.06884495599661022
2023-05-21 07:24:05,541 - main.py[line:558] - INFO: sample time: 0.07160001597367227
2023-05-21 07:24:05,550 - main.py[line:101] - INFO: aqp result:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4372.22         679968309.71   
ARGENTINA      4169.53         649649749.30   
BRAZIL         4509.37         702821370.13   
CANADA         4318.75         672153470.67   
CHINA          4933.37         769596361.63   
EGYPT          4129.12         643796242.97   
ETHIOPIA       4398.95         688977021.24   
FRANCE         5353.55         837900170.23   
GERMANY        4585.19         716656232.49   
INDIA          4895.35         766939583.10   
INDONESIA      4592.27         719084562.55   
IRAN           4720.12         739124299.27   
IRAQ           4423.68         690718561.65   
JAPAN          4384.26         681099225.23   
JORDAN         4591.11         712499126.93   
KENYA          4283.84         664774263.81   
MOROCCO        4386.49         683322915.19   
MOZAMBIQUE     4241.95         658983143.46   
PERU           4864.83         758796786.07   
ROMANIA        4747.38         740250021.01   
RUSSIA         4821.12         751949909.14   
SAUDI ARABIA   4349.69         678864137.41   
UNITED KINGDOM 4585.11         719211371.30   
UNITED STATES  4655.05         727123305.53   
VIETNAM        4463.27         696216297.26   
2023-05-21 07:24:05,553 - main.py[line:102] - INFO: ground truth:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        4497.45         699444173.29   
ARGENTINA      4486.94         699106008.33   
BRAZIL         4502.65         701773384.16   
CANADA         4499.32         700256734.44   
CHINA          4491.27         700629814.31   
EGYPT          4496.39         701059444.40   
ETHIOPIA       4499.89         704785653.13   
FRANCE         4493.15         703235862.49   
GERMANY        4489.33         701673966.77   
INDIA          4507.72         706211190.60   
INDONESIA      4498.74         704439111.14   
IRAN           4507.57         705840896.67   
IRAQ           4509.27         704081769.17   
JAPAN          4493.66         698094511.41   
JORDAN         4504.65         699080891.27   
KENYA          4499.24         698201348.30   
MOROCCO        4499.58         700940690.68   
MOZAMBIQUE     4507.23         700194448.01   
PERU           4490.77         700452753.83   
ROMANIA        4487.90         699789990.15   
RUSSIA         4518.25         704711627.29   
SAUDI ARABIA   4508.93         703718011.11   
UNITED KINGDOM 4491.37         704507986.21   
UNITED STATES  4505.47         703758434.40   
VIETNAM        4497.59         701569658.84   
2023-05-21 07:24:05,559 - main.py[line:570] - INFO: relative error:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.03            0.03           
ARGENTINA      0.07            0.07           
BRAZIL         0.00            0.00           
CANADA         0.04            0.04           
CHINA          0.10            0.10           
EGYPT          0.08            0.08           
ETHIOPIA       0.02            0.02           
FRANCE         0.19            0.19           
GERMANY        0.02            0.02           
INDIA          0.09            0.09           
INDONESIA      0.02            0.02           
IRAN           0.05            0.05           
IRAQ           0.02            0.02           
JAPAN          0.02            0.02           
JORDAN         0.02            0.02           
KENYA          0.05            0.05           
MOROCCO        0.03            0.03           
MOZAMBIQUE     0.06            0.06           
PERU           0.08            0.08           
ROMANIA        0.06            0.06           
RUSSIA         0.07            0.07           
SAUDI ARABIA   0.04            0.04           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.03            0.03           
VIETNAM        0.01            0.01           
2023-05-21 07:24:05,562 - main.py[line:571] - INFO: relative error normalized:
                avg(c_acctbal)  sum(c_acctbal)
n_name                                        
ALGERIA        0.03            0.03           
ARGENTINA      0.07            0.07           
BRAZIL         0.00            0.00           
CANADA         0.04            0.04           
CHINA          0.09            0.09           
EGYPT          0.08            0.08           
ETHIOPIA       0.02            0.02           
FRANCE         0.17            0.17           
GERMANY        0.02            0.02           
INDIA          0.08            0.08           
INDONESIA      0.02            0.02           
IRAN           0.05            0.05           
IRAQ           0.02            0.02           
JAPAN          0.02            0.02           
JORDAN         0.02            0.02           
KENYA          0.05            0.05           
MOROCCO        0.02            0.02           
MOZAMBIQUE     0.06            0.06           
PERU           0.08            0.08           
ROMANIA        0.06            0.06           
RUSSIA         0.06            0.06           
SAUDI ARABIA   0.03            0.03           
UNITED KINGDOM 0.02            0.02           
UNITED STATES  0.03            0.03           
VIETNAM        0.01            0.01           
2023-05-21 07:24:05,562 - main.py[line:574] - INFO: relative error average: 0.048363600840359934
2023-05-21 07:24:05,562 - main.py[line:575] - INFO: relative error normalized average: 0.046500728925618434
2023-05-21 07:24:05,567 - main.py[line:621] - INFO: total_time:1056.7093717720127
feature_names: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
feature_names: ['c_nationkey_0', 'c_nationkey_1', 'c_nationkey_2', 'c_nationkey_3', 'c_nationkey_4', 'c_nationkey_5']
