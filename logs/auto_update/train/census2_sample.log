main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-05-20 14:18:45,268 - main.py[line:601] - INFO: load query config config/query/census2_inc.json successfully
2023-05-20 14:18:45,268 - main.py[line:608] - INFO: load train config ./config/train/census2_a_inc_torch_cvae.json successfully
2023-05-20 14:18:45,268 - main.py[line:608] - INFO: load train config ./config/train/census2_b_torch_cvae.json successfully
2023-05-20 14:18:45,268 - dataset_utils.py[line:565] - INFO: load existing dataset:census2-adult-a-inc_a_education_num#a_relationship_a_fnlwgt#a_age#a_hours_per_week_a_education_num#a_relationship_binary_gaussian5_0
2023-05-20 14:18:49,062 - dataset_utils.py[line:200] - INFO: encode incremental data categorical columns time elapsed:0.020375446998514235
2023-05-20 14:18:51,903 - dataset_utils.py[line:217] - INFO: encode incremental data numeric columnstime elapsed:2.841697501949966
2023-05-20 14:18:51,971 - dataset_utils.py[line:275] - INFO: load incremental data time elapsed:4.515822447021492
2023-05-20 14:18:51,972 - dataset_utils.py[line:577] - INFO: load dataset time elapsed:6.70361289405264
2023-05-20 14:18:51,972 - pytorch_cvae.py[line:300] - INFO: feature info:[('a_fnlwgt', 'numerical', 6), ('a_age', 'numerical', 6), ('a_hours_per_week', 'numerical', 6), ('a_education_num', 'categorical', 5), ('a_relationship', 'categorical', 4)]
2023-05-20 14:18:51,973 - model_utils.py[line:75] - INFO: load model name:torch_cvae_census2-adult-a-inc_a_education_num_a_relationship_ld50_id100_bs512_ep150_0_binary_gaussian5
2023-05-20 14:18:51,975 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0018684440292418003
2023-05-20 14:18:51,975 - pytorch_cvae.py[line:311] - INFO: load model time elapsed:6.706841613049619
2023-05-20 14:18:53,151 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-05-20 14:18:53,151 - pytorch_cvae.py[line:177] - INFO: loss:329.03359174728394, numeric_loss:14.593500643968582, categorical_loss:307.7937891483307, kld_loss:1232.9984102249146, epoch_train_time:1.174764983006753
2023-05-20 14:18:53,944 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.2 epoch----------------------------
2023-05-20 14:18:53,944 - pytorch_cvae.py[line:177] - INFO: loss:193.38217568397522, numeric_loss:14.479018867015839, categorical_loss:165.19039070606232, kld_loss:2303.006694793701, epoch_train_time:0.7930720780277625
2023-05-20 14:18:54,646 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.3 epoch----------------------------
2023-05-20 14:18:54,646 - pytorch_cvae.py[line:177] - INFO: loss:112.22517198324203, numeric_loss:14.458909556269646, categorical_loss:82.03252351284027, kld_loss:2394.550802230835, epoch_train_time:0.7018575799884275
2023-05-20 14:18:55,412 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.4 epoch----------------------------
2023-05-20 14:18:55,412 - pytorch_cvae.py[line:177] - INFO: loss:65.00096827745438, numeric_loss:14.36491310596466, categorical_loss:33.65320557355881, kld_loss:2344.547092437744, epoch_train_time:0.7658284469507635
2023-05-20 14:18:56,130 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.5 epoch----------------------------
2023-05-20 14:18:56,130 - pytorch_cvae.py[line:177] - INFO: loss:48.44597214460373, numeric_loss:14.099878758192062, categorical_loss:16.834653444588184, kld_loss:2195.133008956909, epoch_train_time:0.717476184014231
2023-05-20 14:18:56,879 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.6 epoch----------------------------
2023-05-20 14:18:56,879 - pytorch_cvae.py[line:177] - INFO: loss:41.23740518093109, numeric_loss:13.329254195094109, categorical_loss:9.783928833901882, kld_loss:2065.0151042938232, epoch_train_time:0.7491479779127985
2023-05-20 14:18:57,610 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.7 epoch----------------------------
2023-05-20 14:18:57,610 - pytorch_cvae.py[line:177] - INFO: loss:37.868608236312866, numeric_loss:11.449005156755447, categorical_loss:7.204446475952864, kld_loss:1991.89741897583, epoch_train_time:0.7304232340538874
2023-05-20 14:18:58,392 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.8 epoch----------------------------
2023-05-20 14:18:58,393 - pytorch_cvae.py[line:177] - INFO: loss:36.05058091878891, numeric_loss:9.541536010801792, categorical_loss:6.083680368959904, kld_loss:1928.352035522461, epoch_train_time:0.7825643569231033
2023-05-20 14:18:59,151 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.9 epoch----------------------------
2023-05-20 14:18:59,151 - pytorch_cvae.py[line:177] - INFO: loss:35.70478039979935, numeric_loss:8.168928399682045, categorical_loss:5.7355531342327595, kld_loss:1876.3192157745361, epoch_train_time:0.7580624440452084
2023-05-20 14:18:59,875 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.10 epoch----------------------------
2023-05-20 14:18:59,875 - pytorch_cvae.py[line:177] - INFO: loss:35.84335312247276, numeric_loss:7.234389290213585, categorical_loss:5.352413430809975, kld_loss:1826.634355545044, epoch_train_time:0.7235983789432794
2023-05-20 14:19:00,654 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.11 epoch----------------------------
2023-05-20 14:19:00,654 - pytorch_cvae.py[line:177] - INFO: loss:36.177000761032104, numeric_loss:6.525960974395275, categorical_loss:5.20947639644146, kld_loss:1753.604471206665, epoch_train_time:0.7795277930563316
2023-05-20 14:19:01,358 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.12 epoch----------------------------
2023-05-20 14:19:01,358 - pytorch_cvae.py[line:177] - INFO: loss:37.43771559000015, numeric_loss:6.200315836817026, categorical_loss:5.228873040527105, kld_loss:1706.2751235961914, epoch_train_time:0.7037412989884615
2023-05-20 14:19:02,082 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.13 epoch----------------------------
2023-05-20 14:19:02,082 - pytorch_cvae.py[line:177] - INFO: loss:38.731915920972824, numeric_loss:6.0946222096681595, categorical_loss:5.198147486895323, kld_loss:1647.6647415161133, epoch_train_time:0.7237454199930653
2023-05-20 14:19:02,820 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.14 epoch----------------------------
2023-05-20 14:19:02,820 - pytorch_cvae.py[line:177] - INFO: loss:40.26267412304878, numeric_loss:6.006675571203232, categorical_loss:5.283978417515755, kld_loss:1593.9557800292969, epoch_train_time:0.7377871959470212
2023-05-20 14:19:03,599 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.15 epoch----------------------------
2023-05-20 14:19:03,599 - pytorch_cvae.py[line:177] - INFO: loss:42.11101853847504, numeric_loss:6.018607158213854, categorical_loss:5.434754893183708, kld_loss:1546.9275608062744, epoch_train_time:0.7785231620073318
2023-05-20 14:19:04,392 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.16 epoch----------------------------
2023-05-20 14:19:04,392 - pytorch_cvae.py[line:177] - INFO: loss:43.76303720474243, numeric_loss:5.955409899353981, categorical_loss:5.402162685990334, kld_loss:1501.1258220672607, epoch_train_time:0.7928617880679667
2023-05-20 14:19:05,123 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.17 epoch----------------------------
2023-05-20 14:19:05,123 - pytorch_cvae.py[line:177] - INFO: loss:45.91649967432022, numeric_loss:6.039974354207516, categorical_loss:5.732249852269888, kld_loss:1453.5127983093262, epoch_train_time:0.7307208410929888
2023-05-20 14:19:05,828 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.18 epoch----------------------------
2023-05-20 14:19:05,828 - pytorch_cvae.py[line:177] - INFO: loss:48.067051351070404, numeric_loss:6.133372075855732, categorical_loss:5.962132889777422, kld_loss:1408.6284885406494, epoch_train_time:0.7051123549463227
2023-05-20 14:19:06,612 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.19 epoch----------------------------
2023-05-20 14:19:06,612 - pytorch_cvae.py[line:177] - INFO: loss:50.09222614765167, numeric_loss:6.181252308189869, categorical_loss:6.0434755980968475, kld_loss:1365.446418762207, epoch_train_time:0.7837371779605746
2023-05-20 14:19:07,317 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.20 epoch----------------------------
2023-05-20 14:19:07,318 - pytorch_cvae.py[line:177] - INFO: loss:52.53335976600647, numeric_loss:6.274838738143444, categorical_loss:6.465861540287733, kld_loss:1322.5619297027588, epoch_train_time:0.7053037419682369
2023-05-20 14:19:07,318 - pytorch_cvae.py[line:186] - INFO: training time elapsed:15.342343944939785
2023-05-20 14:19:07,319 - model_utils.py[line:67] - INFO: save model successfully
2023-05-20 14:19:09,878 - dataset_utils.py[line:584] - INFO: load existing dataset(light):census2-adult-b_b_education_num__b_education_num_binary_gaussian5_0
2023-05-20 14:19:09,902 - dataset_utils.py[line:593] - INFO: load dataset(light) time elapsed:0.023841970949433744
2023-05-20 14:19:09,902 - pytorch_cvae.py[line:280] - INFO: feature info:[('b_education_num', 'categorical', 5)]
2023-05-20 14:19:09,903 - model_utils.py[line:75] - INFO: load model name:torch_cvae_census2-adult-b_b_education_num_ld50_id100_bs512_ep150_0_binary_gaussian5
2023-05-20 14:19:09,905 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.002586369984783232
2023-05-20 14:19:09,905 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.027697680983692408
2023-05-20 14:19:09,905 - main.py[line:541] - INFO: multi_sampling No.0 epoch
2023-05-20 14:19:09,906 - pytorch_cvae.py[line:427] - INFO: house sampling rate:0.002
2023-05-20 14:19:10,005 - pytorch_cvae.py[line:407] - INFO: sampling time:0.0985858200583607
2023-05-20 14:19:10,005 - pytorch_cvae.py[line:427] - INFO: house sampling rate:0.5
2023-05-20 14:19:10,161 - pytorch_cvae.py[line:407] - INFO: sampling time:0.15604993095621467
2023-05-20 14:19:11,230 - main.py[line:525] - INFO: sample and aggregation time elapsed:1.3245498290052637
2023-05-20 14:19:11,232 - main.py[line:558] - INFO: sample time: 1.3267875789897516
2023-05-20 14:19:11,246 - main.py[line:101] - INFO: aqp result:
                 avg(a_age)  avg(a_hours_per_week)  avg(a_fnlwgt)  \
a_relationship                                                      
 Husband        37.67       42.38                  179832.30        
 Not-in-family  37.51       40.11                  183095.12        
 Other-relative 37.38       40.17                  220685.43        
 Own-child      33.70       41.59                  209281.97        
 Unmarried      38.74       40.12                  190689.52        
 Wife           40.83       42.41                  222394.21        

                    sum(a_age)  sum(a_hours_per_week)      sum(a_fnlwgt)  
a_relationship                                                            
 Husband        inf            inf                    inf                 
 Not-in-family  75804224557.21 81085949520.17         369998742582712.88  
 Other-relative inf            inf                    inf                 
 Own-child      inf            nan                    inf                 
 Unmarried      19171380185.68 19846537175.99         94203613885553.73   
 Wife           7838748662.93  8144066551.08          42754359213724.69   
2023-05-20 14:19:11,248 - main.py[line:102] - INFO: ground truth:
                  sum(a_age)  avg(a_age)  sum(a_hours_per_week)  \
a_relationship                                                    
 Husband         87370070065 38.57       89423750935.98           
 Not-in-family   54595659351 38.59       55930158869.30           
 Other-relative  6625596621  38.75       6787215589.82            
 Own-child       33582483407 38.59       34394168467.46           
 Unmarried       22589581214 38.54       23165964367.03           
 Wife            10373880746 38.64       10656937777.96           

                 avg(a_hours_per_week)      sum(a_fnlwgt)  avg(a_fnlwgt)  
a_relationship                                                            
 Husband        39.48                  403039889506702.38 177941.66       
 Not-in-family  39.53                  250236539500460.41 176869.15       
 Other-relative 39.69                  30053448855758.80  175765.67       
 Own-child      39.52                  154254839485714.00 177241.88       
 Unmarried      39.52                  103401686055605.38 176404.23       
 Wife           39.69                  47409213397508.31  176586.67       
2023-05-20 14:19:11,254 - main.py[line:570] - INFO: relative error:
                 avg(a_age)  avg(a_fnlwgt)  avg(a_hours_per_week)  sum(a_age)  \
a_relationship                                                                  
 Husband        0.02        0.01           0.07                   inf           
 Not-in-family  0.03        0.04           0.01                   0.39          
 Other-relative 0.04        0.26           0.01                   inf           
 Own-child      0.13        0.18           0.05                   inf           
 Unmarried      0.01        0.08           0.02                   0.15          
 Wife           0.06        0.26           0.07                   0.24          

                 sum(a_fnlwgt)  sum(a_hours_per_week)  
a_relationship                                         
 Husband        inf            inf                     
 Not-in-family  0.48           0.45                    
 Other-relative inf            inf                     
 Own-child      inf            1.00                    
 Unmarried      0.09           0.14                    
 Wife           0.10           0.24                    
2023-05-20 14:19:11,256 - main.py[line:571] - INFO: relative error normalized:
                 avg(a_age)  avg(a_hours_per_week)  avg(a_fnlwgt)
a_relationship                                                   
 Husband        0.02        0.07                   0.01          
 Not-in-family  0.03        0.01                   0.03          
 Other-relative 0.03        0.01                   0.23          
 Own-child      0.12        0.05                   0.17          
 Unmarried      0.01        0.02                   0.08          
 Wife           0.06        0.07                   0.23          
2023-05-20 14:19:11,256 - main.py[line:574] - INFO: relative error average: inf
2023-05-20 14:19:11,256 - main.py[line:575] - INFO: relative error normalized average: 0.06870527881550043
2023-05-20 14:19:11,259 - main.py[line:621] - INFO: total_time:25.991107497015037
feature_names: ['a_education_num_0', 'a_education_num_1', 'a_education_num_2', 'a_education_num_3', 'a_education_num_4', 'a_relationship_0', 'a_relationship_1', 'a_relationship_2', 'a_relationship_3']
feature_names: ['a_education_num-a_relationship_0', 'a_education_num-a_relationship_1', 'a_education_num-a_relationship_2', 'a_education_num-a_relationship_3', 'a_education_num-a_relationship_4', 'a_education_num-a_relationship_5', 'a_education_num-a_relationship_6', 'a_education_num-a_relationship_7']
