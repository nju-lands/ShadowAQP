main.py:19: FutureWarning: Passing a negative integer is deprecated in version 1.0 and will not be supported in future version. Instead, use None to not limit the column width.
  pd.set_option('max_colwidth', -1)
2023-05-20 10:20:50,605 - main.py[line:600] - INFO: load query config config/query/census_inc.json successfully
2023-05-20 10:20:50,605 - main.py[line:607] - INFO: load train config ./config/train/census_a_inc_torch_cvae.json successfully
2023-05-20 10:20:50,605 - main.py[line:607] - INFO: load train config ./config/train/census_b_torch_cvae.json successfully
2023-05-20 10:20:50,605 - dataset_utils.py[line:552] - INFO: load existing dataset:census-adult-a-inc_a_education_num_a_fnlwgt#a_age#a_hours_per_week_a_education_num_binary_gaussian5_0
2023-05-20 10:20:52,818 - dataset_utils.py[line:197] - INFO: encode incremental data categorical columns time elapsed:0.003680836991406977
2023-05-20 10:20:55,830 - dataset_utils.py[line:214] - INFO: encode incremental data numeric columnstime elapsed:3.0122274889145046
2023-05-20 10:20:55,880 - dataset_utils.py[line:262] - INFO: load incremental data time elapsed:3.12029482901562
2023-05-20 10:20:55,880 - dataset_utils.py[line:564] - INFO: load dataset time elapsed:5.2748398629482836
2023-05-20 10:20:55,880 - pytorch_cvae.py[line:300] - INFO: feature info:[('a_fnlwgt', 'numerical', 6), ('a_age', 'numerical', 6), ('a_hours_per_week', 'numerical', 6), ('a_education_num', 'categorical', 5)]
2023-05-20 10:20:55,881 - model_utils.py[line:75] - INFO: load model name:torch_cvae_census-adult-a-inc_a_education_num_ld100_id100_bs512_ep150_0_binary_gaussian5
2023-05-20 10:20:55,883 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0016358379507437348
2023-05-20 10:20:55,883 - pytorch_cvae.py[line:311] - INFO: load model time elapsed:5.277875703992322
2023-05-20 10:20:59,828 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.1 epoch----------------------------
2023-05-20 10:20:59,828 - pytorch_cvae.py[line:177] - INFO: loss:109.06366400420666, numeric_loss:56.81856634840369, categorical_loss:27.68848939379677, kld_loss:4555.654683589935, epoch_train_time:3.9437912160065025
2023-05-20 10:21:03,328 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.2 epoch----------------------------
2023-05-20 10:21:03,328 - pytorch_cvae.py[line:177] - INFO: loss:48.7220398709178, numeric_loss:10.597279749810696, categorical_loss:2.794915763195604, kld_loss:5933.512441635132, epoch_train_time:3.4998541639652103
2023-05-20 10:21:06,815 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.3 epoch----------------------------
2023-05-20 10:21:06,815 - pytorch_cvae.py[line:177] - INFO: loss:46.96087908744812, numeric_loss:7.849799018353224, categorical_loss:2.665933890035376, kld_loss:5546.6633558273315, epoch_train_time:3.487053647986613
2023-05-20 10:21:10,262 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.4 epoch----------------------------
2023-05-20 10:21:10,262 - pytorch_cvae.py[line:177] - INFO: loss:48.63778556138277, numeric_loss:7.39176126755774, categorical_loss:2.714532694546506, kld_loss:5319.419308662415, epoch_train_time:3.4472636679420248
2023-05-20 10:21:13,737 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.5 epoch----------------------------
2023-05-20 10:21:13,737 - pytorch_cvae.py[line:177] - INFO: loss:51.142550729215145, numeric_loss:7.435188617557287, categorical_loss:2.7213408946990967, kld_loss:5137.771053314209, epoch_train_time:3.4743921470362693
2023-05-20 10:21:17,129 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.6 epoch----------------------------
2023-05-20 10:21:17,129 - pytorch_cvae.py[line:177] - INFO: loss:54.28699830174446, numeric_loss:7.778684129938483, categorical_loss:2.818528090021573, kld_loss:4977.872552871704, epoch_train_time:3.3922311429632828
2023-05-20 10:21:20,561 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.7 epoch----------------------------
2023-05-20 10:21:20,562 - pytorch_cvae.py[line:177] - INFO: loss:57.75063772499561, numeric_loss:8.233224995434284, categorical_loss:2.878215584321879, kld_loss:4834.750925064087, epoch_train_time:3.4319984590401873
2023-05-20 10:21:24,063 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.8 epoch----------------------------
2023-05-20 10:21:24,063 - pytorch_cvae.py[line:177] - INFO: loss:61.35857918858528, numeric_loss:8.672711618244648, categorical_loss:3.004762469092384, kld_loss:4690.377031326294, epoch_train_time:3.5010714280651882
2023-05-20 10:21:27,519 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.9 epoch----------------------------
2023-05-20 10:21:27,519 - pytorch_cvae.py[line:177] - INFO: loss:65.32155033946037, numeric_loss:9.07800672762096, categorical_loss:3.126352856401354, kld_loss:4571.71736907959, epoch_train_time:3.456355464993976
2023-05-20 10:21:31,060 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.10 epoch----------------------------
2023-05-20 10:21:31,061 - pytorch_cvae.py[line:177] - INFO: loss:69.24204345047474, numeric_loss:9.524173606187105, categorical_loss:3.265687725855969, kld_loss:4433.911856651306, epoch_train_time:3.540950548951514
2023-05-20 10:21:34,547 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.11 epoch----------------------------
2023-05-20 10:21:34,547 - pytorch_cvae.py[line:177] - INFO: loss:73.70925690233707, numeric_loss:10.056201295927167, categorical_loss:3.433095619897358, kld_loss:4320.590661048889, epoch_train_time:3.4863911400316283
2023-05-20 10:21:38,046 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.12 epoch----------------------------
2023-05-20 10:21:38,046 - pytorch_cvae.py[line:177] - INFO: loss:78.50422362983227, numeric_loss:10.610664416104555, categorical_loss:3.622042347327806, kld_loss:4216.49760055542, epoch_train_time:3.4988523069769144
2023-05-20 10:21:41,499 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.13 epoch----------------------------
2023-05-20 10:21:41,499 - pytorch_cvae.py[line:177] - INFO: loss:83.98096430301666, numeric_loss:11.335829650983214, categorical_loss:3.8922155356267467, kld_loss:4128.472512245178, epoch_train_time:3.4523847189266235
2023-05-20 10:21:44,934 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.14 epoch----------------------------
2023-05-20 10:21:44,934 - pytorch_cvae.py[line:177] - INFO: loss:89.9573068022728, numeric_loss:12.027427226305008, categorical_loss:4.278655388392508, kld_loss:4052.0748586654663, epoch_train_time:3.4348797659622505
2023-05-20 10:21:48,367 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.15 epoch----------------------------
2023-05-20 10:21:48,367 - pytorch_cvae.py[line:177] - INFO: loss:96.25128583610058, numeric_loss:13.003981422632933, categorical_loss:4.571454022079706, kld_loss:3969.835099220276, epoch_train_time:3.432844706927426
2023-05-20 10:21:51,813 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.16 epoch----------------------------
2023-05-20 10:21:51,813 - pytorch_cvae.py[line:177] - INFO: loss:102.63692525029182, numeric_loss:13.917381517589092, categorical_loss:4.967098596971482, kld_loss:3879.683846473694, epoch_train_time:3.446044012904167
2023-05-20 10:21:55,295 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.17 epoch----------------------------
2023-05-20 10:21:55,295 - pytorch_cvae.py[line:177] - INFO: loss:109.67064866423607, numeric_loss:14.879343252629042, categorical_loss:5.384579523932189, kld_loss:3806.0207414627075, epoch_train_time:3.48140734503977
2023-05-20 10:21:58,701 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.18 epoch----------------------------
2023-05-20 10:21:58,701 - pytorch_cvae.py[line:177] - INFO: loss:117.17978644371033, numeric_loss:15.950478870421648, categorical_loss:5.791084055090323, kld_loss:3737.3150339126587, epoch_train_time:3.4061762900091708
2023-05-20 10:22:02,140 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.19 epoch----------------------------
2023-05-20 10:22:02,140 - pytorch_cvae.py[line:177] - INFO: loss:124.62274488806725, numeric_loss:17.191041126847267, categorical_loss:6.207099988823757, kld_loss:3650.0106744766235, epoch_train_time:3.438545219018124
2023-05-20 10:22:05,652 - pytorch_cvae.py[line:170] - INFO: ----------------------------No.20 epoch----------------------------
2023-05-20 10:22:05,653 - pytorch_cvae.py[line:177] - INFO: loss:132.8630709052086, numeric_loss:18.469456788152456, categorical_loss:7.0198576676193625, kld_loss:3568.709506034851, epoch_train_time:3.5122521860757843
2023-05-20 10:22:05,653 - pytorch_cvae.py[line:186] - INFO: training time elapsed:69.76935463002883
2023-05-20 10:22:05,654 - model_utils.py[line:67] - INFO: save model successfully
2023-05-20 10:22:07,182 - dataset_utils.py[line:571] - INFO: load existing dataset(light):census-adult-b_b_education_num__b_education_num_binary_gaussian5_0
2023-05-20 10:22:07,200 - dataset_utils.py[line:580] - INFO: load dataset(light) time elapsed:0.018409091979265213
2023-05-20 10:22:07,200 - pytorch_cvae.py[line:280] - INFO: feature info:[('b_education_num', 'categorical', 5)]
2023-05-20 10:22:07,202 - model_utils.py[line:75] - INFO: load model name:torch_cvae_census-adult-b_b_education_num_ld50_id100_bs512_ep100_0_binary_gaussian5
2023-05-20 10:22:07,204 - model_utils.py[line:86] - INFO: load torch model time elapsed:0.0025072749704122543
2023-05-20 10:22:07,204 - pytorch_cvae.py[line:290] - INFO: load model time elapsed:0.022693973034620285
2023-05-20 10:22:07,204 - main.py[line:540] - INFO: multi_sampling No.0 epoch
2023-05-20 10:22:07,249 - pytorch_cvae.py[line:407] - INFO: sampling time:0.044233054970391095
2023-05-20 10:22:07,249 - pytorch_cvae.py[line:427] - INFO: house sampling rate:0.5
2023-05-20 10:22:07,418 - pytorch_cvae.py[line:407] - INFO: sampling time:0.16845726501196623
2023-05-20 10:22:07,584 - main.py[line:524] - INFO: sample and aggregation time elapsed:0.3796031200326979
2023-05-20 10:22:07,587 - main.py[line:557] - INFO: sample time: 0.38300318201072514
2023-05-20 10:22:07,608 - main.py[line:101] - INFO: aqp result:
                 avg(a_age)  avg(a_hours_per_week)  avg(a_fnlwgt)  \
a_education_num                                                     
1               37.49       38.63                  175617.53        
2               37.30       43.70                  173006.23        
3               34.16       44.34                  169892.68        
4               40.78       40.20                  187665.91        
5               42.32       42.83                  201745.15        
6               38.97       40.04                  180857.44        
7               33.39       43.46                  187736.08        
8               36.29       40.18                  183061.63        
9               33.34       39.78                  159615.94        
10              36.71       39.68                  166672.15        
11              42.58       40.49                  200781.41        
12              39.60       43.77                  165989.11        
13              33.87       41.78                  133718.92        
14              38.03       36.69                  185310.50        
15              38.38       42.69                  181771.46        
16              36.99       42.52                  156863.62        

                    sum(a_age)  sum(a_hours_per_week)      sum(a_fnlwgt)  
a_education_num                                                           
1               2495028.19     2571420.95             11688644342.14      
2               28259649.19    33106519.68            131057599371.12     
3               105907499.09   137499291.84           526788895913.02     
4               472980590.16   466209509.16           2176489280651.15    
5               291925769.93   295454424.64           1391678715148.86    
6               893364417.30   917941417.55           4145865420677.12    
7               1276986683.81  1662245989.47          7180949953589.02    
8               175015045.37   193784942.59           882842009903.79     
9               98746568776.13 117811604762.39        472749758385358.75  
10              53712606521.24 58060101491.71         243858210538869.50  
11              2157687584.90  2052237686.76          10175444813459.66   
12              1216990910.29  1345360337.34          5101646546758.68    
13              26254235809.00 32383190516.80         103655271431862.62  
14              2984928681.19  2879779116.40          14546482909474.71   
15              340871427.25   379165070.70           1614529399852.27    
16              173217278.66   199146246.62           734661851550.01     
2023-05-20 10:22:07,611 - main.py[line:102] - INFO: ground truth:
                   sum(a_age)  avg(a_age)  sum(a_hours_per_week)  \
a_education_num                                                    
1                2637504      38.82       2727495.59               
10               57556415008  38.54       59053867922.31           
11               1982357756   38.32       2057072739.81            
12               1218116991   38.82       1248073150.28            
13               30598343793  38.67       31299501361.05           
14               3098929305   38.67       3166962332.76            
15               350571872    38.66       358838457.12             
16               184024404    38.49       189778350.61             
2                30010404     38.81       30592894.47              
3                123470856    39.01       126133749.28             
4                456110580    38.53       468609967.31             
5                271986385    38.62       277378764.07             
6                896142720    38.30       919618444.44             
7                1510187840   38.68       1552999177.59            
8                189147511    38.42       193514720.43             
9                116668818475 38.59       119412526440.60          

                 avg(a_hours_per_week)      sum(a_fnlwgt)  avg(a_fnlwgt)  
a_education_num                                                           
1               40.14                  11999595953.25     176610.09       
10              39.54                  266042087650776.84 178123.47       
11              39.76                  9138980956520.30   176649.75       
12              39.78                  5573245311048.09   177632.55       
13              39.55                  139873708508646.88 176759.49       
14              39.52                  14179641688885.13  176950.76       
15              39.58                  1612149254804.62   177799.34       
16              39.69                  848622391194.36    177498.37       
2               39.56                  135500878151.77    175221.26       
3               39.85                  556650681468.56    175859.55       
4               39.58                  2108798458595.26   178118.52       
5               39.39                  1248910096007.05   177353.78       
6               39.30                  4099485262823.16   175184.49       
7               39.77                  6826577479733.92   174829.22       
8               39.31                  865017206651.94    175705.05       
9               39.49                  535274241465035.69 177037.98       
2023-05-20 10:22:07,622 - main.py[line:569] - INFO: relative error:
                 avg(a_age)  avg(a_fnlwgt)  avg(a_hours_per_week)  sum(a_age)  \
a_education_num                                                                 
1               0.03        0.01           0.04                   0.05          
2               0.04        0.01           0.10                   0.06          
3               0.12        0.03           0.11                   0.14          
4               0.06        0.05           0.02                   0.04          
5               0.10        0.14           0.09                   0.07          
6               0.02        0.03           0.02                   0.00          
7               0.14        0.07           0.09                   0.15          
8               0.06        0.04           0.02                   0.07          
9               0.14        0.10           0.01                   0.15          
10              0.05        0.06           0.00                   0.07          
11              0.11        0.14           0.02                   0.09          
12              0.02        0.07           0.10                   0.00          
13              0.12        0.24           0.06                   0.14          
14              0.02        0.05           0.07                   0.04          
15              0.01        0.02           0.08                   0.03          
16              0.04        0.12           0.07                   0.06          

                 sum(a_fnlwgt)  sum(a_hours_per_week)  
a_education_num                                        
1               0.03           0.06                    
2               0.03           0.08                    
3               0.05           0.09                    
4               0.03           0.01                    
5               0.11           0.07                    
6               0.01           0.00                    
7               0.05           0.07                    
8               0.02           0.00                    
9               0.12           0.01                    
10              0.08           0.02                    
11              0.11           0.00                    
12              0.08           0.08                    
13              0.26           0.03                    
14              0.03           0.09                    
15              0.00           0.06                    
16              0.13           0.05                    
2023-05-20 10:22:07,624 - main.py[line:570] - INFO: relative error normalized:
                 avg(a_age)  avg(a_fnlwgt)  avg(a_hours_per_week)  sum(a_age)  \
a_education_num                                                                 
1               0.03        0.01           0.04                   0.05          
2               0.04        0.01           0.10                   0.06          
3               0.12        0.03           0.11                   0.13          
4               0.06        0.05           0.02                   0.04          
5               0.09        0.13           0.08                   0.07          
6               0.02        0.03           0.02                   0.00          
7               0.13        0.07           0.09                   0.14          
8               0.05        0.04           0.02                   0.07          
9               0.13        0.09           0.01                   0.14          
10              0.05        0.06           0.00                   0.06          
11              0.11        0.13           0.02                   0.08          
12              0.02        0.06           0.10                   0.00          
13              0.12        0.22           0.05                   0.13          
14              0.02        0.05           0.07                   0.04          
15              0.01        0.02           0.08                   0.03          
16              0.04        0.11           0.07                   0.06          

                 sum(a_fnlwgt)  sum(a_hours_per_week)  
a_education_num                                        
1               0.03           0.06                    
2               0.03           0.08                    
3               0.05           0.09                    
4               0.03           0.01                    
5               0.11           0.06                    
6               0.01           0.00                    
7               0.05           0.07                    
8               0.02           0.00                    
9               0.11           0.01                    
10              0.08           0.02                    
11              0.11           0.00                    
12              0.08           0.07                    
13              0.23           0.03                    
14              0.03           0.09                    
15              0.00           0.06                    
16              0.13           0.05                    
2023-05-20 10:22:07,624 - main.py[line:573] - INFO: relative error average: 0.06455085494525305
2023-05-20 10:22:07,624 - main.py[line:574] - INFO: relative error normalized average: 0.06135512193602504
2023-05-20 10:22:07,625 - main.py[line:620] - INFO: total_time:77.01959036500193
label group counts before:{9: 48161, 10: 33952, 13: 24681, 14: 7867, 11: 6313, 7: 5488, 12: 4927, 6: 4224, 4: 3021, 15: 2632, 5: 2321, 8: 1939, 16: 1901, 3: 1574, 2: 771, 1: 228}
label group counts after:{9: 62779, 10: 43991, 13: 32062, 14: 10186, 11: 8195, 7: 7115, 12: 6368, 6: 5540, 4: 3919, 15: 3445, 5: 3034, 8: 2539, 16: 2515, 3: 2011, 2: 1003, 1: 298}
feature_names: ['a_education_num_0', 'a_education_num_1', 'a_education_num_2', 'a_education_num_3', 'a_education_num_4']
